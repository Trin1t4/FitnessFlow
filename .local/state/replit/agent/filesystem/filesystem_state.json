{"file_contents":{"client/src/pages/Home.tsx":{"content":"import { useAuth } from \"@/hooks/useAuth\";\nimport Dashboard from \"@/components/Dashboard\";\nimport { Button } from \"@/components/ui/button\";\nimport { LogOut, User, Zap } from \"lucide-react\";\n\nexport default function Home() {\n  const { user } = useAuth();\n\n  return (\n    <div>\n      <header className=\"sticky top-0 z-50 w-full border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n        <div className=\"max-w-7xl mx-auto px-4 h-16 flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-10 h-10 rounded-lg bg-primary flex items-center justify-center\">\n              <Zap className=\"w-6 h-6 text-white\" />\n            </div>\n            <span className=\"font-display text-xl text-foreground\">TrainSmart</span>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            {user?.profileImageUrl ? (\n              <img \n                src={user.profileImageUrl} \n                alt=\"Profile\" \n                className=\"w-8 h-8 rounded-full object-cover\"\n              />\n            ) : (\n              <div className=\"w-8 h-8 rounded-full bg-primary/20 flex items-center justify-center\">\n                <User className=\"w-5 h-5 text-primary\" />\n              </div>\n            )}\n            <span className=\"text-sm text-muted-foreground hidden md:inline\">\n              {user?.firstName || user?.email}\n            </span>\n            <Button \n              variant=\"ghost\" \n              size=\"sm\"\n              onClick={() => window.location.href = '/api/logout'}\n              data-testid=\"button-logout\"\n            >\n              <LogOut className=\"w-4 h-4 mr-2\" />\n              Logout\n            </Button>\n          </div>\n        </div>\n      </header>\n\n      <Dashboard />\n    </div>\n  );\n}\n","size_bytes":1837},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/ProgressCharts.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport {\n  LineChart,\n  Line,\n  BarChart,\n  Bar,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Tooltip,\n  ResponsiveContainer,\n  Legend,\n} from \"recharts\";\nimport { TrendingUp, Award, Flame, Dumbbell, Calendar } from \"lucide-react\";\n\nexport default function ProgressCharts() {\n  const [stats, setStats] = useState(null);\n  const [weeklyData, setWeeklyData] = useState([]);\n  const [prs, setPrs] = useState([]);\n  const [timeframe, setTimeframe] = useState(12); // weeks\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadData();\n  }, [timeframe]);\n\n  const loadData = async () => {\n    setLoading(true);\n    try {\n      // Stats generali\n      const statsRes = await fetch(\"/api/stats\");\n      const statsData = await statsRes.json();\n      setStats(statsData);\n\n      // Progressi settimanali\n      const weeklyRes = await fetch(`/api/stats/weekly?weeks=${timeframe}`);\n      const weeklyData = await weeklyRes.json();\n\n      // Formatta dati per grafici\n      const formattedWeekly = weeklyData.map((w) => ({\n        week: new Date(w.weekStart).toLocaleDateString(\"it-IT\", {\n          day: \"2-digit\",\n          month: \"short\",\n        }),\n        workouts: w.totalWorkouts,\n        volume: Math.round(parseFloat(w.totalVolume)),\n        sets: w.totalSets,\n        reps: w.totalReps,\n      }));\n      setWeeklyData(formattedWeekly);\n\n      // Personal Records\n      const prsRes = await fetch(\"/api/prs\");\n      const prsData = await prsRes.json();\n      setPrs(prsData.slice(0, 10)); // Ultimi 10 PRs\n    } catch (error) {\n      console.error(\"Error loading progress data:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-20\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-slate-950 text-white p-6\">\n      <div className=\"max-w-7xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">I Tuoi Progressi</h1>\n          <p className=\"text-slate-400\">Analisi delle tue performance</p>\n        </div>\n\n        {/* Stats Cards */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n          <StatCard\n            icon={<Dumbbell className=\"w-6 h-6\" />}\n            label=\"Workout Totali\"\n            value={stats?.totalWorkouts || 0}\n            color=\"emerald\"\n          />\n          <StatCard\n            icon={<TrendingUp className=\"w-6 h-6\" />}\n            label=\"Volume Totale\"\n            value={`${(stats?.totalVolume || 0).toLocaleString()} kg`}\n            color=\"blue\"\n          />\n          <StatCard\n            icon={<Award className=\"w-6 h-6\" />}\n            label=\"Personal Records\"\n            value={stats?.totalPRs || 0}\n            color=\"amber\"\n          />\n          <StatCard\n            icon={<Flame className=\"w-6 h-6\" />}\n            label=\"Streak Giorni\"\n            value={stats?.currentStreak || 0}\n            color=\"orange\"\n          />\n        </div>\n\n        {/* Timeframe Selector */}\n        <div className=\"flex gap-2 mb-6\">\n          {[4, 8, 12, 26].map((weeks) => (\n            <button\n              key={weeks}\n              onClick={() => setTimeframe(weeks)}\n              className={`px-4 py-2 rounded-lg transition-colors ${\n                timeframe === weeks\n                  ? \"bg-emerald-600 text-white\"\n                  : \"bg-slate-800 text-slate-400 hover:bg-slate-700\"\n              }`}\n            >\n              {weeks} settimane\n            </button>\n          ))}\n        </div>\n\n        {/* Charts Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8\">\n          {/* Volume Chart */}\n          <div className=\"bg-slate-900 rounded-xl p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">\n              Volume Settimanale (kg)\n            </h3>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <LineChart data={weeklyData}>\n                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#334155\" />\n                <XAxis\n                  dataKey=\"week\"\n                  stroke=\"#94a3b8\"\n                  style={{ fontSize: 12 }}\n                />\n                <YAxis stroke=\"#94a3b8\" style={{ fontSize: 12 }} />\n                <Tooltip\n                  contentStyle={{\n                    backgroundColor: \"#1e293b\",\n                    border: \"1px solid #334155\",\n                    borderRadius: \"8px\",\n                  }}\n                />\n                <Line\n                  type=\"monotone\"\n                  dataKey=\"volume\"\n                  stroke=\"#10b981\"\n                  strokeWidth={3}\n                  dot={{ fill: \"#10b981\", r: 4 }}\n                  activeDot={{ r: 6 }}\n                />\n              </LineChart>\n            </ResponsiveContainer>\n          </div>\n\n          {/* Workouts Chart */}\n          <div className=\"bg-slate-900 rounded-xl p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">\n              Workout per Settimana\n            </h3>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <BarChart data={weeklyData}>\n                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#334155\" />\n                <XAxis\n                  dataKey=\"week\"\n                  stroke=\"#94a3b8\"\n                  style={{ fontSize: 12 }}\n                />\n                <YAxis stroke=\"#94a3b8\" style={{ fontSize: 12 }} />\n                <Tooltip\n                  contentStyle={{\n                    backgroundColor: \"#1e293b\",\n                    border: \"1px solid #334155\",\n                    borderRadius: \"8px\",\n                  }}\n                />\n                <Bar dataKey=\"workouts\" fill=\"#3b82f6\" radius={[8, 8, 0, 0]} />\n              </BarChart>\n            </ResponsiveContainer>\n          </div>\n\n          {/* Sets & Reps Chart */}\n          <div className=\"bg-slate-900 rounded-xl p-6\">\n            <h3 className=\"text-lg font-semibold mb-4\">Set e Ripetizioni</h3>\n            <ResponsiveContainer width=\"100%\" height={300}>\n              <LineChart data={weeklyData}>\n                <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#334155\" />\n                <XAxis\n                  dataKey=\"week\"\n                  stroke=\"#94a3b8\"\n                  style={{ fontSize: 12 }}\n                />\n                <YAxis stroke=\"#94a3b8\" style={{ fontSize: 12 }} />\n                <Tooltip\n                  contentStyle={{\n                    backgroundColor: \"#1e293b\",\n                    border: \"1px solid #334155\",\n                    borderRadius: \"8px\",\n                  }}\n                />\n                <Legend />\n                <Line\n                  type=\"monotone\"\n                  dataKey=\"sets\"\n                  stroke=\"#f59e0b\"\n                  strokeWidth={2}\n                  name=\"Set\"\n                />\n                <Line\n                  type=\"monotone\"\n                  dataKey=\"reps\"\n                  stroke=\"#ec4899\"\n                  strokeWidth={2}\n                  name=\"Ripetizioni\"\n                />\n              </LineChart>\n            </ResponsiveContainer>\n          </div>\n\n          {/* Personal Records */}\n          <div className=\"bg-slate-900 rounded-xl p-6\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <h3 className=\"text-lg font-semibold\">Personal Records</h3>\n              <Award className=\"w-5 h-5 text-amber-500\" />\n            </div>\n\n            {prs.length === 0 ? (\n              <div className=\"text-center py-12 text-slate-500\">\n                <Award className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                <p>Nessun PR ancora</p>\n                <p className=\"text-sm\">Completa i tuoi primi workout!</p>\n              </div>\n            ) : (\n              <div className=\"space-y-3 max-h-[260px] overflow-y-auto\">\n                {prs.map((pr) => (\n                  <div\n                    key={pr.id}\n                    className=\"bg-slate-800 rounded-lg p-4 border border-slate-700\"\n                  >\n                    <div className=\"flex items-start justify-between\">\n                      <div>\n                        <h4 className=\"font-semibold\">{pr.exerciseName}</h4>\n                        <p className=\"text-xs text-slate-400\">\n                          {new Date(pr.achievedAt).toLocaleDateString(\"it-IT\")}\n                        </p>\n                      </div>\n                      <div className=\"text-right\">\n                        <p className=\"text-2xl font-bold text-emerald-500\">\n                          {parseFloat(pr.value).toFixed(1)}\n                        </p>\n                        <p className=\"text-xs text-slate-400 uppercase\">\n                          {pr.recordType}\n                        </p>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Insights */}\n        <div className=\"bg-gradient-to-br from-emerald-600 to-blue-600 rounded-xl p-6 text-white\">\n          <h3 className=\"text-xl font-bold mb-4\">Insights</h3>\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n            <InsightCard\n              label=\"Media Workout/Settimana\"\n              value={calculateAvgWorkouts(weeklyData)}\n            />\n            <InsightCard\n              label=\"Volume Medio/Workout\"\n              value={`${calculateAvgVolume(weeklyData)} kg`}\n            />\n            <InsightCard\n              label=\"Crescita Volume\"\n              value={calculateVolumeGrowth(weeklyData)}\n            />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction StatCard({ icon, label, value, color }) {\n  const colorClasses = {\n    emerald: \"bg-emerald-600\",\n    blue: \"bg-blue-600\",\n    amber: \"bg-amber-600\",\n    orange: \"bg-orange-600\",\n  };\n\n  return (\n    <div className=\"bg-slate-900 rounded-xl p-6 border border-slate-800\">\n      <div\n        className={`w-12 h-12 ${colorClasses[color]} rounded-xl flex items-center justify-center mb-4`}\n      >\n        {icon}\n      </div>\n      <p className=\"text-slate-400 text-sm mb-1\">{label}</p>\n      <p className=\"text-2xl font-bold\">{value}</p>\n    </div>\n  );\n}\n\nfunction InsightCard({ label, value }) {\n  return (\n    <div className=\"bg-white/10 rounded-lg p-4 backdrop-blur\">\n      <p className=\"text-sm opacity-90 mb-1\">{label}</p>\n      <p className=\"text-2xl font-bold\">{value}</p>\n    </div>\n  );\n}\n\nfunction calculateAvgWorkouts(data) {\n  if (data.length === 0) return \"0\";\n  const total = data.reduce((sum, w) => sum + w.workouts, 0);\n  return (total / data.length).toFixed(1);\n}\n\nfunction calculateAvgVolume(data) {\n  if (data.length === 0) return \"0\";\n  const workoutsData = data.filter((w) => w.workouts > 0);\n  if (workoutsData.length === 0) return \"0\";\n\n  const totalVolume = workoutsData.reduce((sum, w) => sum + w.volume, 0);\n  const totalWorkouts = workoutsData.reduce((sum, w) => sum + w.workouts, 0);\n\n  return Math.round(totalVolume / totalWorkouts).toLocaleString();\n}\n\nfunction calculateVolumeGrowth(data) {\n  if (data.length < 2) return \"+0%\";\n\n  const firstHalf = data.slice(0, Math.floor(data.length / 2));\n  const secondHalf = data.slice(Math.floor(data.length / 2));\n\n  const avgFirst =\n    firstHalf.reduce((sum, w) => sum + w.volume, 0) / firstHalf.length;\n  const avgSecond =\n    secondHalf.reduce((sum, w) => sum + w.volume, 0) / secondHalf.length;\n\n  const growth = ((avgSecond - avgFirst) / avgFirst) * 100;\n  return `${growth > 0 ? \"+\" : \"\"}${growth.toFixed(0)}%`;\n}\n","size_bytes":11763},"client/src/components/QuizComponet.tsx":{"content":"import { useState } from \"react\";\nimport { Check, X, Brain, ChevronRight } from \"lucide-react\";\n\nconst QUIZ_QUESTIONS = [\n  {\n    id: 1,\n    question: \"Quale esercizio √® pi√π efficace per lo sviluppo del petto?\",\n    options: [\n      \"Push-ups\",\n      \"Panca piana con bilanciere\",\n      \"Croci con manubri\",\n      \"Pectoral machine\",\n    ],\n    correct: 1,\n    explanation: \"La panca piana permette il massimo carico progressivo\",\n  },\n  {\n    id: 2,\n    question: \"Quante ripetizioni sono ideali per l'ipertrofia?\",\n    options: [\"1-5\", \"6-12\", \"15-20\", \"30+\"],\n    correct: 1,\n    explanation: \"Il range 6-12 reps ottimizza tensione meccanica e volume\",\n  },\n  {\n    id: 3,\n    question: \"Cosa significa RPE 8?\",\n    options: [\n      \"8 ripetizioni\",\n      \"2 ripetizioni di riserva\",\n      \"80% del massimale\",\n      \"8 minuti di riposo\",\n    ],\n    correct: 1,\n    explanation: \"RPE 8 = Rate of Perceived Exertion con 2 reps in riserva\",\n  },\n  {\n    id: 4,\n    question: \"Il miglior esercizio per i quadricipiti √®:\",\n    options: [\"Leg curl\", \"Stacco rumeno\", \"Squat\", \"Calf raises\"],\n    correct: 2,\n    explanation: \"Lo squat √® il re degli esercizi per le gambe\",\n  },\n  {\n    id: 5,\n    question: \"Quale muscolo NON lavora nello stacco da terra?\",\n    options: [\"Erettori spinali\", \"Trapezio\", \"Pettorali\", \"Glutei\"],\n    correct: 2,\n    explanation: \"Lo stacco √® principalmente per catena posteriore\",\n  },\n  {\n    id: 6,\n    question: \"La progressione lineare funziona meglio per:\",\n    options: [\"Principianti\", \"Intermedi\", \"Avanzati\", \"Tutti\"],\n    correct: 0,\n    explanation: \"I principianti possono aumentare peso ogni sessione\",\n  },\n  {\n    id: 7,\n    question: \"Quanti grammi di proteine per kg di peso corporeo?\",\n    options: [\"0.5-1g\", \"1.6-2.2g\", \"3-4g\", \"5g+\"],\n    correct: 1,\n    explanation: \"1.6-2.2g/kg √® il range scientifico ottimale\",\n  },\n  {\n    id: 8,\n    question: \"Il miglior split per 3 giorni a settimana:\",\n    options: [\"PPL\", \"Full Body\", \"Upper/Lower\", \"Bro Split\"],\n    correct: 1,\n    explanation: \"Full Body 3x permette frequenza ottimale per gruppo\",\n  },\n  {\n    id: 9,\n    question: \"Quale esercizio sviluppa meglio i dorsali?\",\n    options: [\"Trazioni\", \"Curl\", \"Panca piana\", \"Leg press\"],\n    correct: 0,\n    explanation: \"Le trazioni sono fondamentali per lo sviluppo dorsale\",\n  },\n  {\n    id: 10,\n    question: \"Il tempo di recupero ideale tra serie pesanti:\",\n    options: [\"30 secondi\", \"1 minuto\", \"2-3 minuti\", \"10 minuti\"],\n    correct: 2,\n    explanation: \"2-3 minuti permettono il recupero del sistema ATP-CP\",\n  },\n];\n\nexport default function QuizComponent({ onComplete }) {\n  const [currentQuestion, setCurrentQuestion] = useState(0);\n  const [answers, setAnswers] = useState<number[]>([]);\n  const [showResult, setShowResult] = useState(false);\n  const [selectedAnswer, setSelectedAnswer] = useState<number | null>(null);\n  const [showExplanation, setShowExplanation] = useState(false);\n\n  const question = QUIZ_QUESTIONS[currentQuestion];\n  const progress = ((currentQuestion + 1) / QUIZ_QUESTIONS.length) * 100;\n\n  const handleAnswer = (answerIndex: number) => {\n    setSelectedAnswer(answerIndex);\n    setShowExplanation(true);\n\n    // Salva risposta\n    const newAnswers = [...answers];\n    newAnswers[currentQuestion] = answerIndex;\n    setAnswers(newAnswers);\n  };\n\n  const handleNext = () => {\n    if (currentQuestion < QUIZ_QUESTIONS.length - 1) {\n      setCurrentQuestion(currentQuestion + 1);\n      setSelectedAnswer(null);\n      setShowExplanation(false);\n    } else {\n      handleComplete();\n    }\n  };\n\n  const handleComplete = async () => {\n    // Calcola score\n    let correct = 0;\n    answers.forEach((answer, index) => {\n      if (answer === QUIZ_QUESTIONS[index].correct) {\n        correct++;\n      }\n    });\n\n    const score = Math.round((correct / QUIZ_QUESTIONS.length) * 100);\n\n    // Determina difficolt√†\n    let difficulty = \"beginner\";\n    if (score >= 70) difficulty = \"advanced\";\n    else if (score >= 50) difficulty = \"intermediate\";\n\n    // Salva risultato\n    try {\n      await fetch(\"/api/quiz/submit\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          score,\n          totalQuestions: QUIZ_QUESTIONS.length,\n          answers: answers.map((answer, i) => ({\n            questionId: i,\n            answer,\n            correct: answer === QUIZ_QUESTIONS[i].correct,\n          })),\n          difficulty,\n        }),\n      });\n\n      setShowResult(true);\n\n      // Callback dopo 2 secondi\n      setTimeout(() => {\n        if (onComplete) onComplete({ score, difficulty });\n      }, 2000);\n    } catch (error) {\n      console.error(\"Error saving quiz:\", error);\n      alert(\"Errore nel salvare il quiz. Riprova.\");\n    }\n  };\n\n  const calculateScore = () => {\n    let correct = 0;\n    answers.forEach((answer, index) => {\n      if (answer === QUIZ_QUESTIONS[index].correct) {\n        correct++;\n      }\n    });\n    return Math.round((correct / QUIZ_QUESTIONS.length) * 100);\n  };\n\n  if (showResult) {\n    const score = calculateScore();\n    return (\n      <div className=\"min-h-screen bg-slate-950 text-white flex items-center justify-center p-6\">\n        <div className=\"max-w-md w-full bg-slate-900 rounded-2xl p-8 text-center\">\n          <div className=\"w-20 h-20 bg-emerald-600 rounded-full flex items-center justify-center mx-auto mb-6\">\n            <Check className=\"w-10 h-10\" />\n          </div>\n          <h2 className=\"text-3xl font-bold mb-2\">Quiz Completato!</h2>\n          <p className=\"text-5xl font-bold text-emerald-500 my-6\">{score}%</p>\n          <p className=\"text-slate-400 mb-6\">\n            Hai risposto correttamente a{\" \"}\n            {answers.filter((a, i) => a === QUIZ_QUESTIONS[i].correct).length}{\" \"}\n            domande su {QUIZ_QUESTIONS.length}\n          </p>\n          <div className=\"bg-slate-800 rounded-xl p-4\">\n            <p className=\"text-sm text-slate-400\">Il tuo livello suggerito:</p>\n            <p className=\"text-xl font-bold mt-1\">\n              {score >= 70\n                ? \"Avanzato üí™\"\n                : score >= 50\n                  ? \"Intermedio üéØ\"\n                  : \"Principiante üå±\"}\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-slate-950 text-white p-6\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <div className=\"flex items-center gap-3 mb-4\">\n            <div className=\"w-12 h-12 bg-blue-600 rounded-xl flex items-center justify-center\">\n              <Brain className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <h1 className=\"text-2xl font-bold\">Quiz Tecnico</h1>\n              <p className=\"text-slate-400 text-sm\">\n                Valutiamo le tue conoscenze\n              </p>\n            </div>\n          </div>\n\n          {/* Progress */}\n          <div className=\"flex justify-between text-sm text-slate-400 mb-2\">\n            <span>\n              Domanda {currentQuestion + 1} di {QUIZ_QUESTIONS.length}\n            </span>\n            <span>{Math.round(progress)}%</span>\n          </div>\n          <div className=\"w-full bg-slate-800 rounded-full h-2\">\n            <div\n              className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n              style={{ width: `${progress}%` }}\n            />\n          </div>\n        </div>\n\n        {/* Question */}\n        <div className=\"bg-slate-900 rounded-2xl p-8 mb-6\">\n          <h2 className=\"text-xl font-semibold mb-6\">{question.question}</h2>\n\n          <div className=\"space-y-3\">\n            {question.options.map((option, index) => {\n              const isSelected = selectedAnswer === index;\n              const isCorrect = index === question.correct;\n              const showCorrect = showExplanation && isCorrect;\n              const showWrong = showExplanation && isSelected && !isCorrect;\n\n              return (\n                <button\n                  key={index}\n                  onClick={() => !showExplanation && handleAnswer(index)}\n                  disabled={showExplanation}\n                  className={`w-full p-4 rounded-xl border-2 transition-all text-left ${\n                    showCorrect\n                      ? \"border-emerald-600 bg-emerald-600/10\"\n                      : showWrong\n                        ? \"border-red-600 bg-red-600/10\"\n                        : isSelected\n                          ? \"border-blue-600 bg-blue-600/10\"\n                          : \"border-slate-700 hover:border-slate-600\"\n                  }`}\n                >\n                  <div className=\"flex items-center justify-between\">\n                    <span>{option}</span>\n                    {showCorrect && (\n                      <Check className=\"w-5 h-5 text-emerald-500\" />\n                    )}\n                    {showWrong && <X className=\"w-5 h-5 text-red-500\" />}\n                  </div>\n                </button>\n              );\n            })}\n          </div>\n\n          {/* Explanation */}\n          {showExplanation && (\n            <div className=\"mt-6 p-4 bg-blue-600/10 border border-blue-600/30 rounded-xl\">\n              <p className=\"text-sm text-blue-400 font-semibold mb-2\">\n                üí° Spiegazione\n              </p>\n              <p className=\"text-sm text-slate-300\">{question.explanation}</p>\n            </div>\n          )}\n        </div>\n\n        {/* Next Button */}\n        {showExplanation && (\n          <button\n            onClick={handleNext}\n            className=\"w-full py-4 bg-blue-600 hover:bg-blue-700 rounded-xl font-semibold flex items-center justify-center gap-2\"\n          >\n            {currentQuestion === QUIZ_QUESTIONS.length - 1\n              ? \"Completa Quiz\"\n              : \"Prossima Domanda\"}\n            <ChevronRight className=\"w-5 h-5\" />\n          </button>\n        )}\n\n        {/* Score Preview */}\n        <div className=\"mt-6 text-center text-sm text-slate-500\">\n          Risposta corretta:{\" \"}\n          {answers.filter((a, i) => a === QUIZ_QUESTIONS[i].correct).length}/\n          {currentQuestion + 1}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":10223},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/App.tsx":{"content":"import { useEffect } from \"react\";\nimport { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { LanguageProvider } from \"@/lib/i18n\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/Landing\";\nimport Home from \"@/pages/Home\";\nimport ScreeningFlow from \"@/components/ScreeningFlow\";\nimport QuizComponent from \"@/components/QuizComponent\";\nimport AssessmentFlow from \"@/components/AssessmentFlow\";\nimport WorkoutTracker from \"@/components/WorkoutTracker\";\nimport { useAuth } from \"@/hooks/useAuth\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  // ‚úÖ Gestione errori OAuth\n  useEffect(() => {\n    const params = new URLSearchParams(window.location.search);\n    if (params.get('error') === 'auth_failed') {\n      console.error('‚ùå Autenticazione fallita');\n      // Pulizia URL senza refresh\n      window.history.replaceState({}, '', window.location.pathname);\n    }\n  }, []);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Caricamento...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return <Landing />;\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/screening\">{() => <ScreeningFlow onComplete={() => {}} />}</Route>\n      <Route path=\"/quiz\" component={QuizComponent} />\n      <Route path=\"/assessment\">{() => <AssessmentFlow onComplete={() => {}} />}</Route>\n      <Route path=\"/workout/:id\" component={WorkoutTracker} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  useEffect(() => {\n    document.documentElement.classList.add('dark');\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <LanguageProvider>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </LanguageProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":2345},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"client/src/components/WorkoutTracker.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport {\n  Play,\n  Pause,\n  Check,\n  X,\n  Plus,\n  Trash2,\n  Clock,\n  Dumbbell,\n  AlertCircle,\n  Settings,\n} from \"lucide-react\";\nimport AdaptLocationDialog from \"./AdaptLocationDialog\";\n\n// Mapping esercizi per identificare tipo\nconst EXERCISE_MAPPING: Record<string, string> = {\n  \"squat\": \"squat\",\n  \"panca piana\": \"bench\",\n  \"panca\": \"bench\",\n  \"stacco\": \"deadlift\",\n  \"rematore\": \"row\",\n  \"pulley\": \"row\",\n  \"lat\": \"row\",\n  \"military press\": \"press\",\n  \"shoulder press\": \"press\",\n  \"press\": \"press\"\n};\n\nfunction getExerciseKey(exerciseName: string): string | null {\n  const name = exerciseName.toLowerCase();\n  for (const [key, value] of Object.entries(EXERCISE_MAPPING)) {\n    if (name.includes(key)) {\n      return value;\n    }\n  }\n  return null;\n}\n\nexport default function WorkoutTracker({ programDay, preWorkoutData, onComplete }: any) {\n  const [workoutId, setWorkoutId] = useState<string | null>(null);\n  const [currentExercise, setCurrentExercise] = useState(0);\n  const [sets, setSets] = useState<any>({});\n  const [timer, setTimer] = useState(0);\n  const [isResting, setIsResting] = useState(false);\n  const [restTarget, setRestTarget] = useState(0);\n  const [notes, setNotes] = useState(\"\");\n  const [isAdaptDialogOpen, setIsAdaptDialogOpen] = useState(false);\n  const [adaptedExercises, setAdaptedExercises] = useState<any[] | null>(null);\n  \n  // Usa esercizi adattati se presenti, altrimenti quelli originali\n  const currentExercises = adaptedExercises || programDay?.exercises || [];\n  \n  // Calcola riduzione carico per esercizio corrente\n  const exercise = currentExercises[currentExercise];\n  const exerciseKey = exercise ? getExerciseKey(exercise.name) : null;\n  const isAffectedByPain = preWorkoutData?.affectedExercises?.includes(exerciseKey);\n  const loadReduction = isAffectedByPain ? (preWorkoutData.loadReduction || 0) : 0;\n\n  // Inizia workout\n  useEffect(() => {\n    if (programDay) {\n      startWorkout();\n    }\n  }, [programDay]);\n\n  // Timer\n  useEffect(() => {\n    let interval: any;\n    if (isResting && timer < restTarget) {\n      interval = setInterval(() => {\n        setTimer((t) => t + 1);\n      }, 1000);\n    } else if (timer >= restTarget && isResting) {\n      setIsResting(false);\n      // Notifica (vibration se mobile)\n      if (navigator.vibrate) navigator.vibrate(200);\n    }\n    return () => clearInterval(interval);\n  }, [isResting, timer, restTarget]);\n\n  const startWorkout = async () => {\n    const res = await fetch(\"/api/workout/start\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({\n        programId: programDay.programId,\n        dayName: programDay.name,\n        ...(preWorkoutData && {\n          sleepHours: preWorkoutData.sleepHours,\n          energyLevel: preWorkoutData.energyLevel,\n          painLevel: preWorkoutData.painLevel,\n          painLocation: preWorkoutData.painLocation,\n          preWorkoutNotes: preWorkoutData.notes\n        })\n      }),\n    });\n    const workout = await res.json();\n    setWorkoutId(workout.id);\n  };\n\n  const addSet = async (exercise: any, setNumber: number) => {\n    const setData = {\n      exerciseName: exercise.name,\n      setNumber,\n      reps: sets[exercise.name]?.[setNumber]?.reps || 0,\n      weight: sets[exercise.name]?.[setNumber]?.weight || exercise.weight || 0,\n      rpe: sets[exercise.name]?.[setNumber]?.rpe || null,\n    };\n\n    const res = await fetch(`/api/workout/${workoutId}/set`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(setData),\n    });\n\n    const savedSet = await res.json();\n\n    // Aggiorna stato locale\n    setSets((prev: any) => ({\n      ...prev,\n      [exercise.name]: {\n        ...(prev[exercise.name] || {}),\n        [setNumber]: { ...setData, id: savedSet.id },\n      },\n    }));\n\n    // Avvia rest timer\n    startRest(exercise.rest);\n  };\n\n  const updateSetValue = (\n    exerciseName: string,\n    setNumber: number,\n    field: string,\n    value: any,\n  ) => {\n    setSets((prev: any) => ({\n      ...prev,\n      [exerciseName]: {\n        ...(prev[exerciseName] || {}),\n        [setNumber]: {\n          ...(prev[exerciseName]?.[setNumber] || {}),\n          [field]: value,\n        },\n      },\n    }));\n  };\n\n  const startRest = (seconds: number) => {\n    setTimer(0);\n    setRestTarget(seconds);\n    setIsResting(true);\n  };\n\n  const skipRest = () => {\n    setIsResting(false);\n    setTimer(0);\n  };\n\n  const completeWorkout = async () => {\n    await fetch(`/api/workout/${workoutId}/complete`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ notes }),\n    });\n\n    if (onComplete) onComplete();\n  };\n\n  const handleAdapt = (exercises: any[], location: string) => {\n    setAdaptedExercises(exercises);\n    // Reset esercizio corrente se oltre il numero di esercizi adattati\n    if (currentExercise >= exercises.length) {\n      setCurrentExercise(0);\n    }\n  };\n\n  const formatTime = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n  };\n\n  if (!programDay) {\n    return (\n      <div className=\"text-center py-8 text-slate-400\">\n        Carica un programma per iniziare\n      </div>\n    );\n  }\n\n  const completedSets = Object.keys(sets[exercise?.name] || {}).length;\n\n  return (\n    <div className=\"min-h-screen bg-slate-950 text-white\">\n      {/* Header */}\n      <div className=\"bg-slate-900 border-b border-slate-800 p-4\">\n        <div className=\"flex items-center justify-between mb-2\">\n          <h1 className=\"text-xl font-bold\">{programDay.name}</h1>\n          <div className=\"flex gap-2\">\n            <button\n              onClick={() => setIsAdaptDialogOpen(true)}\n              className=\"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg flex items-center gap-2\"\n              data-testid=\"button-open-adapt-dialog\"\n            >\n              <Settings className=\"w-4 h-4\" />\n              Adatta\n            </button>\n            <button\n              onClick={completeWorkout}\n              className=\"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 rounded-lg flex items-center gap-2\"\n              data-testid=\"button-complete-workout\"\n            >\n              <Check className=\"w-4 h-4\" />\n              Completa\n            </button>\n          </div>\n        </div>\n\n        {/* Progress */}\n        <div className=\"flex items-center gap-2 text-sm text-slate-400\">\n          <Dumbbell className=\"w-4 h-4\" />\n          Esercizio {currentExercise + 1}/{currentExercises.length}\n        </div>\n      </div>\n\n      {/* Rest Timer Overlay */}\n      {isResting && (\n        <div className=\"fixed inset-0 bg-black/80 z-50 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <Clock className=\"w-16 h-16 mx-auto mb-4 text-emerald-500 animate-pulse\" />\n            <h2 className=\"text-4xl font-bold mb-2\">\n              {formatTime(restTarget - timer)}\n            </h2>\n            <p className=\"text-slate-400 mb-6\">Recupero...</p>\n            <button\n              onClick={skipRest}\n              className=\"px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg\"\n            >\n              Salta Recupero\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Current Exercise */}\n      <div className=\"p-6\">\n        <div className=\"bg-slate-900 rounded-xl p-6 mb-6\">\n          {/* Giant Set Rendering */}\n          {exercise.type === 'giant_set' ? (\n            <>\n              <div className=\"bg-gradient-to-r from-orange-600/20 to-red-600/20 border-2 border-orange-600/50 rounded-xl p-6 mb-6\">\n                <h2 className=\"text-3xl font-bold mb-2 flex items-center gap-2\">\n                  {exercise.name}\n                </h2>\n                <p className=\"text-xl text-orange-400 font-semibold mb-4\">\n                  {exercise.rounds || exercise.sets} giri - ZERO pause tra esercizi\n                </p>\n                \n                {/* Lista esercizi del Giant Set */}\n                <div className=\"space-y-3 mb-4\">\n                  {exercise.exercises?.map((ex: any, i: number) => (\n                    <div key={i} className=\"bg-slate-800/50 rounded-lg p-4 border border-slate-700\">\n                      <div className=\"flex items-center justify-between mb-2\">\n                        <span className=\"text-lg font-semibold\">\n                          {i + 1}. {ex.name}\n                        </span>\n                        <span className=\"text-emerald-400 font-bold\">\n                          {ex.reps} reps\n                        </span>\n                      </div>\n                      {ex.notes && (\n                        <p className=\"text-sm text-slate-400\">\n                          {ex.notes}\n                        </p>\n                      )}\n                    </div>\n                  ))}\n                </div>\n\n                {exercise.totalNotes && (\n                  <div className=\"bg-red-500/10 border border-red-500/30 rounded-lg p-4\">\n                    <p className=\"text-sm text-red-400 font-semibold\">\n                      {exercise.totalNotes}\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              {/* Tracking per Giant Set - tratta come un unico \"blocco\" */}\n              <div className=\"space-y-3\">\n                {Array.from({ length: exercise.rounds || exercise.sets }).map((_, idx) => {\n                  const setNumber = idx + 1;\n                  const setData = sets[exercise.name]?.[setNumber] || {};\n                  const isCompleted = !!setData.id;\n\n                  return (\n                    <div\n                      key={setNumber}\n                      className={`border rounded-lg p-4 ${\n                        isCompleted\n                          ? \"border-emerald-600 bg-emerald-600/10\"\n                          : \"border-orange-700 bg-orange-900/20\"\n                      }`}\n                    >\n                      <div className=\"flex items-center gap-4\">\n                        <div className=\"w-10 h-10 rounded-full bg-orange-600 flex items-center justify-center font-bold\">\n                          Giro {setNumber}\n                        </div>\n                        \n                        <div className=\"flex-1\">\n                          <p className=\"text-sm text-slate-400\">\n                            Completa tutti gli esercizi del giro senza pausa\n                          </p>\n                        </div>\n\n                        {!isCompleted ? (\n                          <button\n                            onClick={() => addSet(exercise, setNumber)}\n                            className=\"px-6 py-3 bg-orange-600 hover:bg-orange-700 rounded-lg font-semibold\"\n                          >\n                            ‚úì Giro Completato\n                          </button>\n                        ) : (\n                          <div className=\"px-6 py-3 bg-emerald-600 rounded-lg opacity-50 font-semibold\">\n                            ‚úì Completato\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </>\n          ) : (\n            <>\n              {/* Rendering normale per esercizio singolo */}\n              <h2 className=\"text-2xl font-bold mb-2\">{exercise.name}</h2>\n              <div className=\"flex gap-4 text-sm text-slate-400 mb-4\">\n                <span>{exercise.sets} serie</span>\n                <span>‚Ä¢</span>\n                <span>{exercise.reps} reps</span>\n                <span>‚Ä¢</span>\n                <span>{exercise.rest}s recupero</span>\n              </div>\n\n              {exercise.note && (\n                <div className=\"text-sm text-amber-500 bg-amber-500/10 p-3 rounded-lg mb-4\">\n                  ‚ö†Ô∏è {exercise.note}\n                </div>\n              )}\n\n              {loadReduction > 0 && (\n                <div className=\"text-sm text-red-500 bg-red-500/10 p-3 rounded-lg mb-4 border border-red-500/20\">\n                  <div className=\"flex items-center gap-2 font-semibold mb-1\">\n                    <AlertCircle className=\"w-4 h-4\" />\n                    Carico ridotto per protezione\n                  </div>\n                  <p className=\"text-xs text-red-400\">\n                    Abbiamo ridotto automaticamente il carico del <strong>{loadReduction}%</strong> per questo esercizio a causa del dolore segnalato. Il peso suggerito √® gi√† adattato.\n                  </p>\n                </div>\n              )}\n\n              {/* Sets Table */}\n              <div className=\"space-y-3\">\n                {Array.from({ length: exercise.sets }).map((_, idx) => {\n                  const setNumber = idx + 1;\n                  const setData = sets[exercise.name]?.[setNumber] || {};\n                  const isCompleted = !!setData.id;\n\n                  return (\n                    <div\n                      key={setNumber}\n                      className={`border rounded-lg p-4 ${\n                        isCompleted\n                          ? \"border-emerald-600 bg-emerald-600/10\"\n                          : \"border-slate-700 bg-slate-800\"\n                  }`}\n                >\n                  <div className=\"flex items-center gap-4\">\n                    {/* Set Number */}\n                    <div className=\"w-8 h-8 rounded-full bg-slate-700 flex items-center justify-center font-bold\">\n                      {setNumber}\n                    </div>\n\n                    {/* Weight Input */}\n                    <div className=\"flex-1\">\n                      <label className=\"text-xs text-slate-400 block mb-1\">\n                        Peso (kg)\n                      </label>\n                      <input\n                        type=\"number\"\n                        step=\"2.5\"\n                        value={setData.weight || (exercise.weight ? Math.round((exercise.weight * (1 - loadReduction / 100)) * 4) / 4 : \"\") || \"\"}\n                        onChange={(e) =>\n                          updateSetValue(\n                            exercise.name,\n                            setNumber,\n                            \"weight\",\n                            e.target.value,\n                          )\n                        }\n                        className=\"w-full bg-slate-900 border border-slate-700 rounded px-3 py-2\"\n                        disabled={isCompleted}\n                      />\n                    </div>\n\n                    {/* Reps Input */}\n                    <div className=\"flex-1\">\n                      <label className=\"text-xs text-slate-400 block mb-1\">\n                        Reps\n                      </label>\n                      <input\n                        type=\"number\"\n                        value={setData.reps || \"\"}\n                        onChange={(e) =>\n                          updateSetValue(\n                            exercise.name,\n                            setNumber,\n                            \"reps\",\n                            e.target.value,\n                          )\n                        }\n                        className=\"w-full bg-slate-900 border border-slate-700 rounded px-3 py-2\"\n                        disabled={isCompleted}\n                      />\n                    </div>\n\n                    {/* RPE Input */}\n                    <div className=\"flex-1\">\n                      <label className=\"text-xs text-slate-400 block mb-1\">\n                        RPE (1-10)\n                      </label>\n                      <input\n                        type=\"number\"\n                        min=\"1\"\n                        max=\"10\"\n                        value={setData.rpe || \"\"}\n                        onChange={(e) =>\n                          updateSetValue(\n                            exercise.name,\n                            setNumber,\n                            \"rpe\",\n                            e.target.value,\n                          )\n                        }\n                        className=\"w-full bg-slate-900 border border-slate-700 rounded px-3 py-2\"\n                        disabled={isCompleted}\n                      />\n                    </div>\n\n                    {/* Check Button */}\n                    {!isCompleted ? (\n                      <button\n                        onClick={() => addSet(exercise, setNumber)}\n                        className=\"px-4 py-2 bg-emerald-600 hover:bg-emerald-700 rounded-lg\"\n                        disabled={!setData.weight || !setData.reps}\n                      >\n                        <Check className=\"w-5 h-5\" />\n                      </button>\n                    ) : (\n                      <div className=\"px-4 py-2 bg-emerald-600 rounded-lg opacity-50\">\n                        <Check className=\"w-5 h-5\" />\n                      </div>\n                    )}\n                  </div>\n                </div>\n                  );\n                })}\n              </div>\n            </>\n          )}\n\n          {/* Exercise Navigation */}\n          <div className=\"flex gap-3 mt-6\">\n            <button\n              onClick={() =>\n                setCurrentExercise(Math.max(0, currentExercise - 1))\n              }\n              disabled={currentExercise === 0}\n              className=\"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg\"\n            >\n              ‚Üê Precedente\n            </button>\n            <button\n              onClick={() =>\n                setCurrentExercise(\n                  Math.min(\n                    currentExercises.length - 1,\n                    currentExercise + 1,\n                  ),\n                )\n              }\n              disabled={currentExercise === currentExercises.length - 1}\n              className=\"flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg\"\n            >\n              Successivo ‚Üí\n            </button>\n          </div>\n        </div>\n\n        {/* Notes */}\n        <div className=\"bg-slate-900 rounded-xl p-6\">\n          <label className=\"block text-sm font-semibold mb-2\">\n            Note Workout\n          </label>\n          <textarea\n            value={notes}\n            onChange={(e) => setNotes(e.target.value)}\n            placeholder=\"Come ti sei sentito? Difficolt√†? Note tecniche...\"\n            className=\"w-full bg-slate-800 border border-slate-700 rounded-lg p-3 min-h-[100px]\"\n          />\n        </div>\n      </div>\n\n      {/* Adapt Location Dialog */}\n      <AdaptLocationDialog\n        isOpen={isAdaptDialogOpen}\n        onClose={() => setIsAdaptDialogOpen(false)}\n        programId={programDay.programId}\n        dayName={programDay.name}\n        currentLocation={programDay.location || \"gym\"}\n        onAdapt={handleAdapt}\n      />\n    </div>\n  );\n}\n","size_bytes":19050},"client/src/components/AssessmentFlow.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { ChevronRight, Check, Info, Dumbbell } from \"lucide-react\";\n\nconst MAIN_EXERCISES = [\n  { \n    name: \"Squat\", \n    description: \"Squat con bilanciere sulla schiena\",\n    instructions: \"Trova il carico massimo con cui riesci a fare ESATTAMENTE 10 ripetizioni con buona tecnica. L'ultima rep deve essere dura ma non cedimento.\"\n  },\n  { \n    name: \"Panca Piana\", \n    description: \"Panca piana con bilanciere\",\n    instructions: \"Trova il carico massimo con cui riesci a fare ESATTAMENTE 10 ripetizioni controllate. L'ultima rep deve essere impegnativa.\"\n  },\n  { \n    name: \"Stacco\", \n    description: \"Stacco da terra (conventional o sumo)\",\n    instructions: \"Trova il carico massimo con cui riesci a fare ESATTAMENTE 10 ripetizioni mantenendo la schiena neutra. Ultima rep difficile.\"\n  },\n  { \n    name: \"Military Press\", \n    description: \"Shoulder press in piedi con bilanciere\",\n    instructions: \"Trova il carico massimo con cui riesci a fare ESATTAMENTE 10 ripetizioni senza compensi. Ultima rep dura.\"\n  },\n  { \n    name: \"Pulley\", \n    description: \"Lat pulldown / Pulley (o trazioni assistite)\",\n    instructions: \"Trova il carico massimo con cui riesci a fare ESATTAMENTE 10 ripetizioni controllate. Usa presa prona larga.\"\n  }\n];\n\nexport default function AssessmentFlow({ onComplete }: { onComplete?: () => void }) {\n  const [currentExercise, setCurrentExercise] = useState(0);\n  const [assessments, setAssessments] = useState<Record<string, any>>({});\n  const [weight, setWeight] = useState(\"\");\n  const [notes, setNotes] = useState(\"\");\n  const [showInfo, setShowInfo] = useState(true);\n  const [calculatedRM, setCalculatedRM] = useState<number | null>(null);\n  const [bodyWeight, setBodyWeight] = useState<number | null>(null);\n\n  const exercise = MAIN_EXERCISES[currentExercise];\n  const progress = ((currentExercise + 1) / MAIN_EXERCISES.length) * 100;\n  \n  // Test 10RM - ripetizioni fisse a 10\n  const REPS_10RM = 10;\n\n  // Recupera il peso corporeo dallo screening\n  useEffect(() => {\n    fetch(\"/api/screening\")\n      .then(res => {\n        if (!res.ok) throw new Error(\"Screening not found\");\n        return res.json();\n      })\n      .then(data => {\n        if (data && data.bodyWeight) {\n          setBodyWeight(parseFloat(data.bodyWeight));\n        }\n      })\n      .catch(err => {\n        console.error(\"Error fetching bodyWeight:\", err);\n        // Se non c'√® screening, l'utente potrebbe aver saltato il flusso\n        // In questo caso non mostriamo suggerimenti peso\n      });\n  }, []);\n\n  // Calcola carico suggerito basato sul peso corporeo (per 10RM)\n  // 10RM ‚âà 75% del 1RM, quindi usiamo moltiplicatori realistici\n  const getSuggestedWeight = (exerciseName: string, bw: number) => {\n    const multipliers: Record<string, number> = {\n      \"Squat\": 0.75,         // 0.75x peso per 10RM (1RM ‚âà 1.0x BW per principianti)\n      \"Panca Piana\": 0.65,   // 0.65x peso per 10RM (1RM ‚âà 0.85x BW per principianti)\n      \"Stacco\": 1.0,         // 1.0x peso per 10RM (1RM ‚âà 1.3x BW per principianti)\n      \"Military Press\": 0.4, // 0.4x peso per 10RM (1RM ‚âà 0.5x BW per principianti)\n      \"Pulley\": 0.65,        // 0.65x peso per 10RM (1RM ‚âà 0.85x BW per principianti)\n    };\n    \n    const multiplier = multipliers[exerciseName] || 0.6;\n    return Math.round(bw * multiplier / 2.5) * 2.5; // Arrotonda a 2.5kg\n  };\n\n  const suggestedWeight = bodyWeight ? getSuggestedWeight(exercise.name, bodyWeight) : null;\n\n  const calculateBrzycki = (w: number, r: number) => {\n    if (r === 1) return w;\n    // Formula Brzycki corretta: 1RM = weight / (1.0278 - 0.0278 * reps)\n    return w / (1.0278 - 0.0278 * r);\n  };\n\n  const handleCalculate = () => {\n    const w = parseFloat(weight);\n\n    if (w > 0) {\n      const oneRM = calculateBrzycki(w, REPS_10RM);\n      setCalculatedRM(oneRM);\n    }\n  };\n\n  const handleSave = async () => {\n    if (!calculatedRM) return;\n\n    try {\n      await fetch(\"/api/assessment\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          exerciseName: exercise.name,\n          weight: parseFloat(weight),\n          reps: REPS_10RM, // Test 10RM standardizzato\n          notes\n        })\n      });\n\n      // Salva localmente\n      setAssessments(prev => ({\n        ...prev,\n        [exercise.name]: {\n          weight: parseFloat(weight),\n          reps: REPS_10RM,\n          oneRepMax: calculatedRM\n        }\n      }));\n\n      // Prossimo esercizio o completa\n      if (currentExercise < MAIN_EXERCISES.length - 1) {\n        setCurrentExercise(currentExercise + 1);\n        setWeight(\"\");\n        setNotes(\"\");\n        setCalculatedRM(null);\n        setShowInfo(true);\n      } else {\n        // Tutti gli esercizi completati - genera programma\n        await generateProgram();\n      }\n    } catch (error) {\n      console.error(\"Error saving assessment:\", error);\n      alert(\"Errore nel salvare l'assessment\");\n    }\n  };\n\n  const skipExercise = async () => {\n    if (currentExercise < MAIN_EXERCISES.length - 1) {\n      setCurrentExercise(currentExercise + 1);\n      setWeight(\"\");\n      setNotes(\"\");\n      setCalculatedRM(null);\n      setShowInfo(true);\n    } else {\n      // Tutti gli esercizi completati - genera programma\n      await generateProgram();\n    }\n  };\n\n  const generateProgram = async () => {\n    try {\n      // Genera programma personalizzato\n      const res = await fetch(\"/api/program/generate\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" }\n      });\n\n      if (res.ok) {\n        // Programma generato con successo - naviga alla home\n        window.location.href = \"/\";\n        if (onComplete) onComplete(assessments);\n      } else {\n        const error = await res.json();\n        alert(`Errore nella generazione del programma: ${error.error || \"Riprova\"}`);\n      }\n    } catch (error) {\n      console.error(\"Error generating program:\", error);\n      alert(\"Errore nella generazione del programma. Riprova.\");\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-950 text-white p-6\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Assessment di Forza</h1>\n          <p className=\"text-slate-400\">\n            Test 10RM per calcolare il tuo massimale teorico\n          </p>\n        </div>\n\n        {/* Skip All Option */}\n        <div className=\"bg-blue-600/10 border border-blue-600/30 rounded-xl p-6 mb-6\">\n          <div className=\"flex items-start gap-3 mb-4\">\n            <Info className=\"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5\" />\n            <div className=\"flex-1\">\n              <h3 className=\"font-semibold text-blue-500 mb-1\">Non conosci i tuoi massimali?</h3>\n              <p className=\"text-sm text-slate-300\">\n                Nessun problema! Puoi saltare questi test e il programma user√† carichi di default basati sul tuo peso corporeo e livello di esperienza. \n                I pesi saranno conservativi e potrai aggiornarli durante gli allenamenti.\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={() => generateProgram()}\n            className=\"w-full py-3 bg-blue-600 hover:bg-blue-700 rounded-lg font-semibold transition-colors\"\n            data-testid=\"button-skip-all\"\n          >\n            Salta tutti i test - Genera programma con pesi di default\n          </button>\n        </div>\n\n        {/* Progress Bar */}\n        <div className=\"mb-8\">\n          <div className=\"flex justify-between text-sm text-slate-400 mb-2\">\n            <span>Esercizio {currentExercise + 1} di {MAIN_EXERCISES.length}</span>\n            <span>{Math.round(progress)}%</span>\n          </div>\n          <div className=\"w-full bg-slate-800 rounded-full h-2\">\n            <div\n              className=\"bg-emerald-600 h-2 rounded-full transition-all duration-300\"\n              style={{ width: `${progress}%` }}\n            />\n          </div>\n        </div>\n\n        {/* Info Card */}\n        {showInfo && (\n          <div className=\"bg-blue-600/10 border border-blue-600/30 rounded-xl p-4 mb-6\">\n            <div className=\"flex items-start gap-3\">\n              <Info className=\"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5\" />\n              <div>\n                <h3 className=\"font-semibold text-blue-500 mb-1\">Come funziona</h3>\n                <p className=\"text-sm text-slate-300\">\n                  {exercise.instructions}\n                </p>\n                <button\n                  onClick={() => setShowInfo(false)}\n                  className=\"text-xs text-blue-400 hover:text-blue-300 mt-2\"\n                >\n                  Ho capito ‚Üí\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Exercise Card */}\n        <div className=\"bg-slate-900 rounded-xl p-6 mb-6\">\n          <div className=\"flex items-center gap-3 mb-6\">\n            <div className=\"w-12 h-12 bg-emerald-600 rounded-xl flex items-center justify-center\">\n              <Dumbbell className=\"w-6 h-6\" />\n            </div>\n            <div>\n              <h2 className=\"text-2xl font-bold\">{exercise.name}</h2>\n              <p className=\"text-slate-400 text-sm\">{exercise.description}</p>\n            </div>\n          </div>\n\n          {/* Inputs */}\n          <div className=\"space-y-4\">\n            <div className=\"bg-blue-600/10 border border-blue-600/30 rounded-lg p-4 mb-4\">\n              <p className=\"text-sm text-blue-400\">\n                üí° <strong>Test 10RM standardizzato:</strong> Trova il carico massimo con cui riesci a fare <strong>esattamente 10 ripetizioni</strong>. \n                L'ultima rep deve essere dura ma non a cedimento muscolare.\n              </p>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold mb-2\">\n                Peso massimo per 10 ripetizioni (kg)\n              </label>\n              {suggestedWeight && (\n                <div className=\"mb-3 bg-emerald-600/10 border border-emerald-600/30 rounded-lg p-3\">\n                  <p className=\"text-sm text-emerald-400\">\n                    üí° <strong>Carico suggerito basato sul tuo peso corporeo ({bodyWeight}kg):</strong> ~{suggestedWeight}kg\n                  </p>\n                  <button\n                    onClick={() => setWeight(suggestedWeight.toString())}\n                    className=\"text-xs text-emerald-300 hover:text-emerald-200 mt-1\"\n                    data-testid=\"button-use-suggested\"\n                  >\n                    Usa questo carico come punto di partenza ‚Üí\n                  </button>\n                </div>\n              )}\n              <input\n                type=\"number\"\n                step=\"2.5\"\n                value={weight}\n                onChange={(e) => {\n                  setWeight(e.target.value);\n                  setCalculatedRM(null);\n                }}\n                className=\"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3 text-lg\"\n                placeholder=\"es. 80\"\n                data-testid=\"input-weight\"\n              />\n              <p className=\"text-xs text-slate-500 mt-1\">\n                Inserisci il peso con cui riesci a fare 10 reps (non 9, non 11)\n              </p>\n            </div>\n\n            <div>\n              <label className=\"block text-sm font-semibold mb-2\">\n                Note (opzionale)\n              </label>\n              <textarea\n                value={notes}\n                onChange={(e) => setNotes(e.target.value)}\n                className=\"w-full bg-slate-800 border border-slate-700 rounded-lg px-4 py-3\"\n                placeholder=\"Es. usato bilanciere, tecnica buona...\"\n                rows={2}\n              />\n            </div>\n\n            {/* Calculate Button */}\n            {!calculatedRM && (\n              <button\n                onClick={handleCalculate}\n                disabled={!weight}\n                className=\"w-full py-3 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-700 disabled:cursor-not-allowed rounded-lg font-semibold transition-colors\"\n                data-testid=\"button-calculate\"\n              >\n                Calcola Massimale (1RM)\n              </button>\n            )}\n\n            {/* Result */}\n            {calculatedRM && (\n              <div className=\"bg-emerald-600/10 border border-emerald-600/30 rounded-xl p-6\">\n                <div className=\"text-center\">\n                  <p className=\"text-sm text-emerald-400 mb-2\">Massimale stimato (Formula Brzycki)</p>\n                  <p className=\"text-4xl font-bold text-emerald-500\" data-testid=\"text-calculated-rm\">\n                    {calculatedRM.toFixed(1)} kg\n                  </p>\n                  <p className=\"text-xs text-slate-400 mt-2\">\n                    Basato su <strong>{weight}kg √ó 10 reps</strong> (test 10RM)\n                  </p>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* Actions */}\n        <div className=\"flex gap-3\">\n          <button\n            onClick={skipExercise}\n            className=\"flex-1 py-3 bg-slate-800 hover:bg-slate-700 rounded-lg font-semibold text-sm\"\n            data-testid=\"button-skip\"\n          >\n            Salta questo esercizio\n          </button>\n          <button\n            onClick={handleSave}\n            disabled={!calculatedRM}\n            className=\"flex-1 py-3 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-700 disabled:cursor-not-allowed rounded-lg font-semibold flex items-center justify-center gap-2\"\n            data-testid=\"button-save\"\n          >\n            {currentExercise < MAIN_EXERCISES.length - 1 ? (\n              <>\n                Successivo\n                <ChevronRight className=\"w-5 h-5\" />\n              </>\n            ) : (\n              <>\n                Completa\n                <Check className=\"w-5 h-5\" />\n              </>\n            )}\n          </button>\n        </div>\n\n        {/* Completed Exercises */}\n        {Object.keys(assessments).length > 0 && (\n          <div className=\"mt-8 bg-slate-900 rounded-xl p-6\">\n            <h3 className=\"font-semibold mb-4\">Esercizi completati</h3>\n            <div className=\"space-y-2\">\n              {Object.entries(assessments).map(([name, data]) => (\n                <div key={name} className=\"flex justify-between items-center py-2 border-b border-slate-800 last:border-0\">\n                  <span className=\"text-slate-300\">{name}</span>\n                  <span className=\"font-mono text-emerald-500\">\n                    {data.oneRepMax.toFixed(1)} kg\n                  </span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}","size_bytes":14830},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/Dashboard.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useAuth } from \"../hooks/useAuth\";\nimport {\n  Dumbbell,\n  TrendingUp,\n  Award,\n  Flame,\n  Calendar,\n  Play,\n  Crown,\n  Settings,\n  ChevronRight,\n  BarChart3,\n  RotateCcw,\n} from \"lucide-react\";\nimport PaymentModal from \"./PaymentModal\";\nimport WorkoutTracker from \"./WorkoutTracker\";\nimport ProgressCharts from \"./ProgressCharts\";\nimport PreWorkoutCheck, { PreWorkoutData } from \"./PreWorkoutCheck\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\n\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const { toast } = useToast();\n  const [activeProgram, setActiveProgram] = useState(null);\n  const [stats, setStats] = useState(null);\n  const [recentWorkouts, setRecentWorkouts] = useState([]);\n  const [nextWorkout, setNextWorkout] = useState(null);\n  const [showPaymentModal, setShowPaymentModal] = useState(false);\n  const [showResetDialog, setShowResetDialog] = useState(false);\n  const [activeView, setActiveView] = useState(\"overview\"); // overview, pre-check, workout, progress\n  const [preWorkoutData, setPreWorkoutData] = useState<PreWorkoutData | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [resetting, setResetting] = useState(false);\n\n  useEffect(() => {\n    loadDashboardData();\n  }, []);\n\n  const loadDashboardData = async () => {\n    setLoading(true);\n    try {\n      // Carica programma attivo\n      const programRes = await fetch(\"/api/program/active\");\n      const program = await programRes.json();\n      setActiveProgram(program);\n\n      // Determina prossimo workout\n      if (program?.weeklySchedule) {\n        const today = new Date().getDay();\n        const nextDay =\n          program.weeklySchedule.find((d, i) => i >= today) ||\n          program.weeklySchedule[0];\n        setNextWorkout(nextDay);\n      }\n\n      // Carica stats\n      const statsRes = await fetch(\"/api/stats\");\n      const statsData = await statsRes.json();\n      setStats(statsData);\n\n      // Carica workout recenti\n      const workoutsRes = await fetch(\"/api/workouts?limit=5\");\n      const workoutsData = await workoutsRes.json();\n      setRecentWorkouts(workoutsData);\n    } catch (error) {\n      console.error(\"Error loading dashboard:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const startWorkout = () => {\n    if (!user?.isPremium && recentWorkouts.length >= 3) {\n      setShowPaymentModal(true);\n      return;\n    }\n    setActiveView(\"pre-check\");\n  };\n\n  const handlePreWorkoutComplete = (data: PreWorkoutData) => {\n    setPreWorkoutData(data);\n    setActiveView(\"workout\");\n  };\n\n  const handlePreWorkoutSkip = () => {\n    setPreWorkoutData(null);\n    setActiveView(\"workout\");\n  };\n\n  const onWorkoutComplete = () => {\n    setActiveView(\"overview\");\n    setPreWorkoutData(null);\n    loadDashboardData();\n  };\n\n  const handleResetData = async () => {\n    setResetting(true);\n    try {\n      await apiRequest(\"DELETE\", \"/api/user/reset\");\n      \n      toast({\n        title: \"Dati cancellati!\",\n        description: \"Tutti i tuoi dati sono stati rimossi. Ricarica la pagina per ricominciare.\",\n      });\n      \n      // Ricarica pagina dopo 2 secondi\n      setTimeout(() => {\n        window.location.reload();\n      }, 2000);\n    } catch (error) {\n      toast({\n        title: \"Errore\",\n        description: \"Impossibile cancellare i dati. Riprova.\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setResetting(false);\n      setShowResetDialog(false);\n    }\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen bg-slate-950 flex items-center justify-center\">\n        <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-500\"></div>\n      </div>\n    );\n  }\n\n  // Pre-Workout Check View\n  if (activeView === \"pre-check\") {\n    return (\n      <PreWorkoutCheck\n        workout={nextWorkout}\n        onComplete={handlePreWorkoutComplete}\n        onSkip={handlePreWorkoutSkip}\n      />\n    );\n  }\n\n  // Workout View\n  if (activeView === \"workout\" && nextWorkout) {\n    return (\n      <WorkoutTracker\n        programDay={{ ...nextWorkout, programId: activeProgram?.id }}\n        preWorkoutData={preWorkoutData}\n        onComplete={onWorkoutComplete}\n      />\n    );\n  }\n\n  // Progress View\n  if (activeView === \"progress\") {\n    return (\n      <div className=\"min-h-screen bg-slate-950\">\n        <div className=\"border-b border-slate-800 p-4\">\n          <button\n            onClick={() => setActiveView(\"overview\")}\n            className=\"text-slate-400 hover:text-white flex items-center gap-2\"\n          >\n            ‚Üê Torna alla Dashboard\n          </button>\n        </div>\n        <ProgressCharts />\n      </div>\n    );\n  }\n\n  // Overview (Main Dashboard)\n  return (\n    <div className=\"min-h-screen bg-slate-950 text-white\">\n      {/* Header */}\n      <div className=\"border-b border-slate-800 bg-slate-900\">\n        <div className=\"max-w-7xl mx-auto px-6 py-6\">\n          <div className=\"flex items-center justify-between mb-4\">\n            <div>\n              <h1 className=\"text-3xl font-bold mb-1\">\n                Ciao, {user?.firstName || \"Atleta\"}! üëã\n              </h1>\n              <p className=\"text-slate-400\">\n                Pronto per il tuo prossimo allenamento?\n              </p>\n            </div>\n\n            {/* Actions */}\n            <div className=\"flex items-center gap-3\">\n              <button\n                onClick={() => setShowResetDialog(true)}\n                className=\"flex items-center gap-2 px-3 py-2 bg-slate-800 hover:bg-slate-700 rounded-lg border border-slate-700 transition-colors\"\n                data-testid=\"button-reset-data\"\n              >\n                <RotateCcw className=\"w-4 h-4\" />\n                <span className=\"text-sm\">Reset</span>\n              </button>\n\n              {user?.isPremium ? (\n                <div className=\"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-amber-500 to-orange-600 rounded-xl\">\n                  <Crown className=\"w-5 h-5\" />\n                  <span className=\"font-semibold\">Premium</span>\n                </div>\n              ) : (\n                <button\n                  onClick={() => setShowPaymentModal(true)}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-slate-800 hover:bg-slate-700 rounded-xl border border-amber-500/30\"\n                >\n                  <Crown className=\"w-5 h-5 text-amber-500\" />\n                  <span>Upgrade</span>\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-6 py-8\">\n        {/* Stats Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\n          <StatCard\n            icon={<Dumbbell className=\"w-6 h-6\" />}\n            label=\"Workout Completati\"\n            value={stats?.totalWorkouts || 0}\n            color=\"emerald\"\n          />\n          <StatCard\n            icon={<TrendingUp className=\"w-6 h-6\" />}\n            label=\"Volume Totale\"\n            value={`${Math.round((stats?.totalVolume || 0) / 1000)}k kg`}\n            color=\"blue\"\n          />\n          <StatCard\n            icon={<Award className=\"w-6 h-6\" />}\n            label=\"Personal Records\"\n            value={stats?.totalPRs || 0}\n            color=\"amber\"\n          />\n          <StatCard\n            icon={<Flame className=\"w-6 h-6\" />}\n            label=\"Streak\"\n            value={`${stats?.currentStreak || 0} giorni`}\n            color=\"orange\"\n          />\n        </div>\n\n        {/* Main Content Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n          {/* Left Column - Next Workout */}\n          <div className=\"lg:col-span-2 space-y-6\">\n            {/* Next Workout Card */}\n            {activeProgram && nextWorkout ? (\n              <div className=\"bg-gradient-to-br from-emerald-600 to-blue-600 rounded-2xl p-6 text-white\">\n                <div className=\"flex items-start justify-between mb-4\">\n                  <div>\n                    <p className=\"text-sm opacity-90 mb-1\">Prossimo Workout</p>\n                    <h2 className=\"text-2xl font-bold\">{nextWorkout.name}</h2>\n                  </div>\n                  <Calendar className=\"w-6 h-6 opacity-75\" />\n                </div>\n\n                <div className=\"bg-white/10 rounded-xl p-4 mb-4 backdrop-blur\">\n                  <p className=\"text-sm opacity-90 mb-2\">\n                    {nextWorkout.exercises.length} esercizi\n                  </p>\n                  <div className=\"space-y-1\">\n                    {nextWorkout.exercises.slice(0, 3).map((ex, i) => (\n                      <div key={i} className=\"text-sm\">\n                        ‚Ä¢ {ex.name} - {ex.sets}x{ex.reps}\n                      </div>\n                    ))}\n                    {nextWorkout.exercises.length > 3 && (\n                      <div className=\"text-sm opacity-75\">\n                        +{nextWorkout.exercises.length - 3} altri esercizi\n                      </div>\n                    )}\n                  </div>\n                </div>\n\n                <button\n                  onClick={startWorkout}\n                  className=\"w-full py-4 bg-white text-emerald-600 hover:bg-slate-50 rounded-xl font-semibold flex items-center justify-center gap-2 transition-colors\"\n                >\n                  <Play className=\"w-5 h-5\" />\n                  Inizia Workout\n                </button>\n              </div>\n            ) : (\n              <div className=\"bg-slate-900 rounded-2xl p-8 text-center\">\n                <Dumbbell className=\"w-12 h-12 mx-auto mb-4 text-slate-600\" />\n                <h3 className=\"text-xl font-semibold mb-2\">\n                  Nessun Programma Attivo\n                </h3>\n                <p className=\"text-slate-400 mb-6\">\n                  Completa lo screening per generare il tuo programma\n                  personalizzato\n                </p>\n                <a\n                  href=\"/screening\"\n                  className=\"inline-flex items-center gap-2 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 rounded-xl font-semibold\"\n                >\n                  Inizia Screening\n                  <ChevronRight className=\"w-5 h-5\" />\n                </a>\n              </div>\n            )}\n\n            {/* Recent Workouts */}\n            <div className=\"bg-slate-900 rounded-2xl p-6\">\n              <h3 className=\"text-xl font-semibold mb-4\">Workout Recenti</h3>\n\n              {recentWorkouts.length === 0 ? (\n                <div className=\"text-center py-8 text-slate-500\">\n                  <Calendar className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                  <p>Nessun workout ancora</p>\n                </div>\n              ) : (\n                <div className=\"space-y-3\">\n                  {recentWorkouts.map((workout) => (\n                    <div\n                      key={workout.id}\n                      className=\"bg-slate-800 rounded-xl p-4 flex items-center justify-between\"\n                    >\n                      <div>\n                        <h4 className=\"font-semibold mb-1\">\n                          {workout.dayName}\n                        </h4>\n                        <div className=\"flex items-center gap-3 text-sm text-slate-400\">\n                          <span>\n                            {new Date(workout.completedAt).toLocaleDateString(\n                              \"it-IT\",\n                            )}\n                          </span>\n                          {workout.duration && (\n                            <>\n                              <span>‚Ä¢</span>\n                              <span>{workout.duration} min</span>\n                            </>\n                          )}\n                          {workout.totalVolume && (\n                            <>\n                              <span>‚Ä¢</span>\n                              <span>\n                                {Math.round(parseFloat(workout.totalVolume))} kg\n                              </span>\n                            </>\n                          )}\n                        </div>\n                      </div>\n                      <div\n                        className={`px-3 py-1 rounded-lg text-sm font-semibold ${\n                          workout.status === \"completed\"\n                            ? \"bg-emerald-600/20 text-emerald-500\"\n                            : \"bg-slate-700 text-slate-400\"\n                        }`}\n                      >\n                        {workout.status === \"completed\"\n                          ? \"Completato\"\n                          : \"In corso\"}\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Right Column - Quick Actions */}\n          <div className=\"space-y-6\">\n            {/* Quick Actions */}\n            <div className=\"bg-slate-900 rounded-2xl p-6\">\n              <h3 className=\"text-xl font-semibold mb-4\">Azioni Rapide</h3>\n              <div className=\"space-y-3\">\n                <button\n                  onClick={() => setActiveView(\"progress\")}\n                  className=\"w-full p-4 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center gap-3 transition-colors\"\n                >\n                  <div className=\"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center\">\n                    <BarChart3 className=\"w-5 h-5\" />\n                  </div>\n                  <div className=\"text-left flex-1\">\n                    <p className=\"font-semibold\">Progressi</p>\n                    <p className=\"text-xs text-slate-400\">\n                      Grafici e statistiche\n                    </p>\n                  </div>\n                  <ChevronRight className=\"w-5 h-5 text-slate-500\" />\n                </button>\n\n                <a\n                  href=\"/assessment\"\n                  className=\"w-full p-4 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center gap-3 transition-colors\"\n                >\n                  <div className=\"w-10 h-10 bg-amber-600 rounded-lg flex items-center justify-center\">\n                    <Dumbbell className=\"w-5 h-5\" />\n                  </div>\n                  <div className=\"text-left flex-1\">\n                    <p className=\"font-semibold\">Nuovo Assessment</p>\n                    <p className=\"text-xs text-slate-400\">Test 10RM</p>\n                  </div>\n                  <ChevronRight className=\"w-5 h-5 text-slate-500\" />\n                </a>\n\n                <a\n                  href=\"/programs\"\n                  className=\"w-full p-4 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center gap-3 transition-colors\"\n                >\n                  <div className=\"w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center\">\n                    <Calendar className=\"w-5 h-5\" />\n                  </div>\n                  <div className=\"text-left flex-1\">\n                    <p className=\"font-semibold\">I Miei Programmi</p>\n                    <p className=\"text-xs text-slate-400\">Storico programmi</p>\n                  </div>\n                  <ChevronRight className=\"w-5 h-5 text-slate-500\" />\n                </a>\n              </div>\n            </div>\n\n            {/* Current Program Info */}\n            {activeProgram && (\n              <div className=\"bg-slate-900 rounded-2xl p-6\">\n                <h3 className=\"text-xl font-semibold mb-4\">\n                  Programma Attuale\n                </h3>\n                <div className=\"space-y-3\">\n                  <div>\n                    <p className=\"text-sm text-slate-400\">Nome</p>\n                    <p className=\"font-semibold\">{activeProgram.name}</p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-slate-400\">Split</p>\n                    <p className=\"font-semibold capitalize\">\n                      {activeProgram.split.replace(\"_\", \" \")}\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-slate-400\">Frequenza</p>\n                    <p className=\"font-semibold\">\n                      {activeProgram.daysPerWeek}x settimana\n                    </p>\n                  </div>\n                  <div>\n                    <p className=\"text-sm text-slate-400\">Progressione</p>\n                    <p className=\"font-semibold capitalize\">\n                      {activeProgram.progression.replace(\"_\", \" \")}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n\n      {/* Payment Modal */}\n      <PaymentModal\n        isOpen={showPaymentModal}\n        onClose={() => setShowPaymentModal(false)}\n        onSuccess={() => {\n          setShowPaymentModal(false);\n          loadDashboardData();\n        }}\n      />\n\n      {/* Reset Data Confirmation Dialog */}\n      <AlertDialog open={showResetDialog} onOpenChange={setShowResetDialog}>\n        <AlertDialogContent className=\"bg-slate-900 border-slate-800\">\n          <AlertDialogHeader>\n            <AlertDialogTitle className=\"text-white\">Cancellare tutti i dati?</AlertDialogTitle>\n            <AlertDialogDescription className=\"text-slate-400\">\n              <div>\n                Questa azione canceller√† <strong className=\"text-white\">tutti</strong> i tuoi dati:\n                <ul className=\"list-disc list-inside mt-2 space-y-1\">\n                  <li>Screening e quiz</li>\n                  <li>Assessment di forza</li>\n                  <li>Programmi di allenamento</li>\n                  <li>Workout completati</li>\n                  <li>Progressi e statistiche</li>\n                  <li>Personal records</li>\n                </ul>\n                <div className=\"mt-3 font-semibold\">Potrai ricominciare da capo dopo.</div>\n              </div>\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel className=\"bg-slate-800 hover:bg-slate-700 border-slate-700\">\n              Annulla\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleResetData}\n              disabled={resetting}\n              className=\"bg-red-600 hover:bg-red-700\"\n              data-testid=\"button-confirm-reset\"\n            >\n              {resetting ? \"Cancellazione...\" : \"S√¨, cancella tutto\"}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}\n\nfunction StatCard({ icon, label, value, color }) {\n  const colorClasses = {\n    emerald: \"bg-emerald-600\",\n    blue: \"bg-blue-600\",\n    amber: \"bg-amber-600\",\n    orange: \"bg-orange-600\",\n  };\n\n  return (\n    <div className=\"bg-slate-900 rounded-xl p-6 border border-slate-800\">\n      <div\n        className={`w-12 h-12 ${colorClasses[color]} rounded-xl flex items-center justify-center mb-4`}\n      >\n        {icon}\n      </div>\n      <p className=\"text-slate-400 text-sm mb-1\">{label}</p>\n      <p className=\"text-2xl font-bold\">{value}</p>\n    </div>\n  );\n}\n","size_bytes":19449},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"server/replitAuth.ts":{"content":"// Replit Auth integration con openid-client v6\nimport * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport pg from \"pg\";\n\nconst PgSession = connectPg(session);\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nexport async function setupAuth(app: Express) {\n  // ‚úÖ Verifica SESSION_SECRET\n  if (!process.env.SESSION_SECRET) {\n    console.warn(\"‚ö†Ô∏è SESSION_SECRET mancante, usando fallback (non sicuro per production!)\");\n  }\n\n  const pool = new pg.Pool({\n    connectionString: process.env.DATABASE_URL,\n  });\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    verified(null, user);\n  };\n\n  // ‚úÖ Configurazione ambiente-aware per cookie\n  const isProduction = process.env.NODE_ENV === \"production\";\n  const isReplit = !!process.env.REPL_SLUG || !!process.env.REPLIT_DOMAINS;\n  const isHttps = isProduction || isReplit;\n\n  console.log(\"üç™ Cookie config:\", { isProduction, isReplit, isHttps });\n\n  app.use(\n    session({\n      store: new PgSession({\n        pool,\n        tableName: \"user_sessions\",\n        createTableIfMissing: true,\n      }),\n      secret: process.env.SESSION_SECRET || \"trainsmart-secret-key-2024-fallback\",\n      resave: false,\n      saveUninitialized: false,\n      cookie: {\n        maxAge: 30 * 24 * 60 * 60 * 1000, // 30 giorni\n        httpOnly: true,\n        secure: isHttps, // ‚úÖ true su Replit (HTTPS) anche se development\n        sameSite: \"lax\", // ‚úÖ \"lax\" perch√© frontend e backend sono sullo stesso dominio\n      },\n    })\n  );\n\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // ‚úÖ Serializzazione/Deserializzazione Passport per sessioni\n  passport.serializeUser((user: any, done) => {\n    console.log(\"üìù Serializing user:\", JSON.stringify(user, null, 2));\n    done(null, user);\n  });\n\n  passport.deserializeUser((user: any, done) => {\n    console.log(\"üìñ Deserializing user:\", JSON.stringify(user, null, 2));\n    done(null, user);\n  });\n\n  // ‚úÖ Login con redirect_uri dinamico basato sull'hostname\n  app.get(\"/api/login\", async (req, res, next) => {\n    // Determina callbackURL dalla richiesta corrente\n    const protocol = req.protocol || 'https';\n    const host = req.get('host');\n    const callbackURL = `${protocol}://${host}/api/callback`;\n    \n    console.log(\"üîê Iniziando login OAuth...\");\n    console.log(\"üîê OAuth redirect_uri dinamico:\", callbackURL);\n\n    // Crea strategia dinamica con il callbackURL corretto\n    const dynamicStrategy = new Strategy(\n      {\n        name: \"replitauth-dynamic\",\n        config,\n        scope: \"openid email profile offline_access\",\n        callbackURL,\n      },\n      verify,\n    );\n\n    // Usa la strategia dinamica solo per questa richiesta\n    passport.use(dynamicStrategy);\n    \n    passport.authenticate(\"replitauth-dynamic\", {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", async (req, res, next) => {\n    // Determina callbackURL dalla richiesta corrente (deve corrispondere al login)\n    const protocol = req.protocol || 'https';\n    const host = req.get('host');\n    const callbackURL = `${protocol}://${host}/api/callback`;\n    \n    console.log(\"üîÅ OAuth callback ricevuto da:\", callbackURL);\n    console.log(\"üîë Query params:\", req.query);\n\n    // Crea strategia dinamica con il callbackURL corretto\n    const dynamicStrategy = new Strategy(\n      {\n        name: \"replitauth-callback\",\n        config,\n        scope: \"openid email profile offline_access\",\n        callbackURL,\n      },\n      verify,\n    );\n\n    // Usa la strategia dinamica solo per questa richiesta\n    passport.use(dynamicStrategy);\n    \n    passport.authenticate(\"replitauth-callback\", {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/?error=auth_failed\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n\n  app.get(\"/api/auth/user\", (req, res) => {\n    console.log(\"üîç /api/auth/user chiamato - isAuthenticated:\", req.isAuthenticated(), \"user:\", req.user ? \"presente\" : \"assente\", \"session:\", req.session.id);\n    if (req.isAuthenticated()) {\n      res.json(req.user);\n    } else {\n      res.status(401).json({ message: \"Unauthorized\" });\n    }\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n","size_bytes":6152},"client/src/components/Pricing.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Check, Lock, Sparkles } from \"lucide-react\";\nimport { PRICING_PLANS, getCurrentPrice, type SubscriptionTier } from \"@shared/pricingUtils\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\nimport PaymentModal from \"./PaymentModal\";\n\nexport default function Pricing() {\n  const [selectedTier, setSelectedTier] = useState<SubscriptionTier | null>(null);\n  \n  const { data: user } = useQuery<User>({\n    queryKey: ['/api/auth/user'],\n  });\n\n  const handleSubscribe = (tier: SubscriptionTier) => {\n    setSelectedTier(tier);\n  };\n\n  return (\n    <div className=\"py-24 bg-card\">\n      <div className=\"max-w-7xl mx-auto px-4\">\n        <div className=\"text-center mb-16\">\n          <h2 className=\"font-display text-4xl md:text-5xl mb-4 text-foreground\">\n            Scegli il tuo <span className=\"text-primary\">piano</span>\n          </h2>\n          <p className=\"text-lg text-muted-foreground mb-2\">\n            Allenamento personalizzato basato sulla scienza\n          </p>\n          <p className=\"text-sm text-muted-foreground\">\n            Prezzi bloccati per i primi 6 mesi, poi +‚Ç¨10/mese\n          </p>\n        </div>\n        \n        <div className=\"grid md:grid-cols-3 gap-6 max-w-6xl mx-auto\">\n          {PRICING_PLANS.map((plan) => {\n            const isCurrentTier = user?.subscriptionTier === plan.tier;\n            const currentPrice = getCurrentPrice(\n              plan.tier, \n              user?.subscriptionStartDate ? new Date(user.subscriptionStartDate) : null\n            );\n            const isHighlighted = plan.tier === 'premium';\n            \n            return (\n              <Card \n                key={plan.tier} \n                className={`relative flex flex-col ${isHighlighted ? 'border-primary shadow-lg scale-105' : ''}`}\n                data-testid={`card-plan-${plan.tier}`}\n              >\n                {isHighlighted && (\n                  <Badge className=\"absolute -top-3 left-1/2 -translate-x-1/2 bg-chart-2\">\n                    <Sparkles className=\"w-3 h-3 mr-1\" />\n                    Pi√π Popolare\n                  </Badge>\n                )}\n                \n                {isCurrentTier && (\n                  <Badge className=\"absolute -top-3 right-4 bg-chart-3\">\n                    Piano Attuale\n                  </Badge>\n                )}\n                \n                <CardHeader>\n                  <CardTitle className=\"text-2xl\">{plan.name}</CardTitle>\n                  <CardDescription className=\"text-base\">{plan.description}</CardDescription>\n                  <div className=\"pt-4\">\n                    <div className=\"flex items-baseline gap-1\">\n                      <span className=\"text-4xl font-bold\">‚Ç¨{currentPrice.toFixed(2)}</span>\n                      <span className=\"text-muted-foreground\">/mese</span>\n                    </div>\n                    {currentPrice === plan.basePrice ? (\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        Primi 6 mesi, poi ‚Ç¨{plan.increasedPrice.toFixed(2)}/mese\n                      </p>\n                    ) : (\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        Prezzo aumentato dopo 6 mesi\n                      </p>\n                    )}\n                  </div>\n                </CardHeader>\n                \n                <CardContent className=\"space-y-4 flex-1\">\n                  <div className=\"space-y-3\">\n                    {plan.features.map((feature, idx) => (\n                      <div key={idx} className=\"flex items-start gap-3\">\n                        <Check className=\"w-5 h-5 text-chart-3 mt-0.5 flex-shrink-0\" />\n                        <span className=\"text-sm\">{feature}</span>\n                      </div>\n                    ))}\n                    {plan.lockedFeatures && plan.lockedFeatures.length > 0 && plan.lockedFeatures.map((feature, idx) => (\n                      <div key={idx} className=\"flex items-start gap-3 opacity-50\">\n                        <Lock className=\"w-5 h-5 text-muted-foreground mt-0.5 flex-shrink-0\" />\n                        <span className=\"text-sm text-muted-foreground\">{feature}</span>\n                      </div>\n                    ))}\n                  </div>\n                </CardContent>\n                \n                <CardFooter>\n                  <Button \n                    className=\"w-full\" \n                    variant={isHighlighted ? \"default\" : \"outline\"}\n                    size=\"lg\"\n                    onClick={() => handleSubscribe(plan.tier)}\n                    disabled={isCurrentTier}\n                    data-testid={`button-subscribe-${plan.tier}`}\n                  >\n                    {isCurrentTier ? 'Piano Attuale' : `Abbonati a ${plan.name}`}\n                  </Button>\n                </CardFooter>\n              </Card>\n            );\n          })}\n        </div>\n        \n        <div className=\"mt-12 text-center space-y-2\">\n          <p className=\"text-sm text-muted-foreground\">\n            Pagamenti sicuri con Stripe e PayPal üîí\n          </p>\n          <p className=\"text-xs text-muted-foreground\">\n            Dopo 6 mesi dall'abbonamento, il prezzo aumenta automaticamente di ‚Ç¨10/mese\n          </p>\n        </div>\n      </div>\n\n      {selectedTier && (\n        <PaymentModal\n          isOpen={!!selectedTier}\n          onClose={() => setSelectedTier(null)}\n          tier={selectedTier}\n          onSuccess={() => {\n            setSelectedTier(null);\n            window.location.reload();\n          }}\n        />\n      )}\n    </div>\n  );\n}\n","size_bytes":5862},"server/routes.ts":{"content":"import type { Express, Request, Response } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { z } from \"zod\";\nimport rateLimit from \"express-rate-limit\";\nimport cors from \"cors\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\nimport { generateProgram, calculateOneRepMax } from \"./programGenerator\";\n\n// ===== VALIDATION SCHEMAS =====\nconst screeningSchema = z.object({\n  goal: z.enum([\"weight_loss\", \"muscle_gain\", \"strength\", \"endurance\", \"toning\", \"general\", \"performance\", \"disability\", \"pregnancy\"]),\n  objectiveType: z.string().optional(),\n  sportType: z.string().optional(),\n  specificBodyParts: z.array(z.string()).optional(),\n  disabilityType: z.string().optional(),\n  pregnancyWeek: z.number().int().min(1).max(40).optional(),\n  pregnancyTrimester: z.number().int().min(1).max(3).optional(),\n  hasDoctorClearance: z.boolean().optional(),\n  pregnancyComplications: z.array(z.string()).optional(),\n  bodyWeight: z.number().positive().max(300, \"Peso corporeo non valido\"),\n  level: z.enum([\"beginner\", \"intermediate\", \"advanced\"]),\n  location: z.enum([\"gym\", \"home\", \"mixed\"]).optional(),\n  hasGym: z.boolean(),\n  equipment: z.object({\n    barbell: z.boolean().optional(),\n    dumbbellMaxKg: z.number().optional(),\n    kettlebellKg: z.array(z.number()).optional(),\n    bands: z.boolean().optional(),\n    pullupBar: z.boolean().optional(),\n    bench: z.boolean().optional(),\n  }).optional(),\n  frequency: z\n    .number()\n    .int()\n    .min(2, \"Minimo 2 giorni/settimana\")\n    .max(6, \"Massimo 6 giorni/settimana\"),\n  painAreas: z.array(z.string()).default([]),\n  preferredSplit: z.string().optional(),\n});\n\nconst quizSchema = z.object({\n  score: z.number().int().min(0),\n  totalQuestions: z.number().int().positive(),\n  answers: z.record(z.any()),\n  difficulty: z.string(),\n});\n\nconst assessmentSchema = z.object({\n  exerciseName: z.string().min(1, \"Nome esercizio richiesto\"),\n  weight: z\n    .string()\n    .or(z.number())\n    .transform((val) => (typeof val === \"string\" ? parseFloat(val) : val)),\n  reps: z.number().int().positive().max(50, \"Ripetizioni non valide\"),\n  notes: z.string().optional(),\n});\n\nconst workoutStartSchema = z.object({\n  programId: z.string().min(1),\n  dayName: z.string().min(1),\n  sleepHours: z.number().min(0).max(24).optional(),\n  energyLevel: z.number().int().min(1).max(10).optional(),\n  painLevel: z.number().int().min(0).max(10).optional(),\n  painLocation: z.string().optional(),\n  preWorkoutNotes: z.string().optional(),\n});\n\nconst workoutSetSchema = z.object({\n  exerciseName: z.string().min(1),\n  setNumber: z.number().int().positive(),\n  reps: z.number().int().positive().max(100),\n  weight: z.number().positive().max(1000),\n  rpe: z.number().min(1).max(10).optional(),\n  isWarmup: z.boolean().optional(),\n});\n\nconst paymentSchema = z.object({\n  amount: z\n    .string()\n    .or(z.number())\n    .transform((val) => (typeof val === \"string\" ? parseFloat(val) : val)),\n  provider: z.enum([\"stripe\", \"paypal\"]),\n});\n\n// ===== CUSTOM ERRORS =====\nclass ValidationError extends Error {\n  constructor(message: string) {\n    super(message);\n    this.name = \"ValidationError\";\n  }\n}\n\nclass AuthorizationError extends Error {\n  constructor(message: string = \"Non autorizzato\") {\n    super(message);\n    this.name = \"AuthorizationError\";\n  }\n}\n\nclass NotFoundError extends Error {\n  constructor(message: string = \"Risorsa non trovata\") {\n    super(message);\n    this.name = \"NotFoundError\";\n  }\n}\n\n// ===== MIDDLEWARE =====\nconst apiLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000, // 15 minuti\n  max: 100, // max 100 richieste\n  message: { error: \"Troppe richieste, riprova tra 15 minuti\" },\n  standardHeaders: true,\n  legacyHeaders: false,\n  validate: { trustProxy: false }, // Disable trust proxy validation for Replit\n});\n\nconst strictLimiter = rateLimit({\n  windowMs: 15 * 60 * 1000,\n  max: 10, // max 10 richieste per operazioni critiche\n  message: { error: \"Troppe richieste, riprova tra 15 minuti\" },\n  validate: { trustProxy: false }, // Disable trust proxy validation for Replit\n});\n\n// Middleware per verificare ownership delle risorse\nconst verifyWorkoutOwnership = async (req: any, res: Response, next: any) => {\n  try {\n    const userId = req.user.claims.sub;\n    const workoutId = req.params.id;\n\n    const workout = await storage.getWorkout(workoutId);\n\n    if (!workout) {\n      throw new NotFoundError(\"Workout non trovato\");\n    }\n\n    if (workout.userId !== userId) {\n      throw new AuthorizationError(\n        \"Non sei autorizzato ad accedere a questo workout\",\n      );\n    }\n\n    req.workout = workout;\n    next();\n  } catch (error) {\n    if (error instanceof AuthorizationError) {\n      return res.status(403).json({ error: error.message });\n    }\n    if (error instanceof NotFoundError) {\n      return res.status(404).json({ error: error.message });\n    }\n    console.error(\"Error verifying ownership:\", error);\n    res.status(500).json({ error: \"Errore verifica autorizzazione\" });\n  }\n};\n\n// ===== ERROR HANDLER =====\nconst handleError = (error: any, res: Response, defaultMessage: string) => {\n  console.error(\"Error:\", error);\n\n  if (error instanceof z.ZodError) {\n    return res.status(400).json({\n      error: \"Dati non validi\",\n      details: error.errors.map((e) => ({\n        field: e.path.join(\".\"),\n        message: e.message,\n      })),\n    });\n  }\n\n  if (error instanceof ValidationError) {\n    return res.status(400).json({ error: error.message });\n  }\n\n  if (error instanceof AuthorizationError) {\n    return res.status(403).json({ error: error.message });\n  }\n\n  if (error instanceof NotFoundError) {\n    return res.status(404).json({ error: error.message });\n  }\n\n  // Generic error\n  res.status(500).json({\n    error: defaultMessage,\n    message: process.env.NODE_ENV === \"development\" ? error.message : undefined,\n  });\n};\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Setup CORS\n  app.use(\n    cors({\n      origin: process.env.FRONTEND_URL || \"*\",\n      credentials: true,\n      methods: [\"GET\", \"POST\", \"PUT\", \"DELETE\", \"PATCH\"],\n      allowedHeaders: [\"Content-Type\", \"Authorization\"],\n    }),\n  );\n\n  // Setup Replit Auth\n  await setupAuth(app);\n\n  // Apply rate limiting to all API routes\n  app.use(\"/api/\", apiLimiter);\n\n  // ===== AUTH ROUTES =====\n  app.get(\"/api/auth/user\", isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n\n      if (!user) {\n        throw new NotFoundError(\"Utente non trovato\");\n      }\n\n      res.json(user);\n    } catch (error) {\n      handleError(error, res, \"Errore recupero utente\");\n    }\n  });\n\n  // ===== SCREENING =====\n  app.post(\n    \"/api/screening\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n\n        // Validate input\n        const data = screeningSchema.parse(req.body);\n\n        const screening = await storage.saveScreening({\n          userId,\n          ...data,\n        });\n\n        res.json(screening);\n      } catch (error) {\n        handleError(error, res, \"Errore salvataggio screening\");\n      }\n    },\n  );\n\n  app.get(\n    \"/api/screening\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const screening = await storage.getLatestScreening(userId);\n        res.json(screening || null);\n      } catch (error) {\n        handleError(error, res, \"Errore recupero screening\");\n      }\n    },\n  );\n\n  app.post(\n    \"/api/screening/update-level\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const { level } = z\n          .object({\n            level: z.enum([\"beginner\", \"intermediate\", \"advanced\"]),\n          })\n          .parse(req.body);\n\n        const screening = await storage.getLatestScreening(userId);\n        if (!screening) {\n          throw new NotFoundError(\"Screening non trovato\");\n        }\n\n        await storage.updateScreeningLevel(screening.id, level);\n        res.json({ success: true, level });\n      } catch (error) {\n        handleError(error, res, \"Errore aggiornamento livello\");\n      }\n    },\n  );\n\n  // ===== QUIZ =====\n  app.post(\n    \"/api/quiz/submit\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const data = quizSchema.parse(req.body);\n\n        const result = await storage.saveQuizResult({\n          userId,\n          ...data,\n        });\n\n        res.json(result);\n      } catch (error) {\n        handleError(error, res, \"Errore salvataggio quiz\");\n      }\n    },\n  );\n\n  app.get(\n    \"/api/quiz/latest\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const quiz = await storage.getLatestQuiz(userId);\n        res.json(quiz || null);\n      } catch (error) {\n        handleError(error, res, \"Errore recupero quiz\");\n      }\n    },\n  );\n\n  // ===== ASSESSMENT =====\n  app.post(\n    \"/api/assessment\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const data = assessmentSchema.parse(req.body);\n\n        // Calculate 1RM using Brzycki formula\n        const oneRepMax = calculateOneRepMax(data.weight, data.reps);\n\n        const assessment = await storage.saveAssessment({\n          userId,\n          exerciseName: data.exerciseName,\n          weight: data.weight.toString(),\n          reps: data.reps,\n          oneRepMax: oneRepMax.toFixed(2),\n          notes: data.notes,\n        });\n\n        res.json(assessment);\n      } catch (error) {\n        handleError(error, res, \"Errore salvataggio assessment\");\n      }\n    },\n  );\n\n  app.get(\n    \"/api/assessment\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const assessments = await storage.getLatestAssessments(userId);\n        res.json(assessments);\n      } catch (error) {\n        handleError(error, res, \"Errore recupero assessments\");\n      }\n    },\n  );\n\n  // ===== PROGRAM GENERATION =====\n  app.post(\n    \"/api/program/generate\",\n    isAuthenticated,\n    strictLimiter,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n\n        // Get user data\n        const screening = await storage.getLatestScreening(userId);\n        const assessments = await storage.getLatestAssessments(userId);\n\n        if (!screening) {\n          throw new ValidationError(\"Completa prima lo screening\");\n        }\n\n        // Generate program\n        const programData = generateProgram({\n          level: screening.level,\n          frequency: screening.frequency,\n          location: screening.location || 'gym',\n          hasGym: screening.hasGym,\n          equipment: screening.equipment as any,\n          painAreas: screening.painAreas as string[],\n          assessments: assessments.map((a) => ({\n            exerciseName: a.exerciseName,\n            oneRepMax: parseFloat(a.oneRepMax),\n          })),\n          goal: screening.goal,\n          specificBodyParts: screening.specificBodyParts as string[] | undefined,\n          disabilityType: screening.disabilityType || undefined,\n          pregnancyWeek: screening.pregnancyWeek || undefined,\n          pregnancyTrimester: screening.pregnancyTrimester || undefined,\n          hasDoctorClearance: screening.hasDoctorClearance || undefined,\n          pregnancyComplications: screening.pregnancyComplications as string[] | undefined,\n        });\n\n        // Save to database\n        const program = await storage.createProgram({\n          userId,\n          name: programData.name,\n          description: programData.description,\n          split: programData.split,\n          daysPerWeek: programData.daysPerWeek,\n          weeklySchedule: programData.weeklySchedule,\n          progression: programData.progression,\n          includesDeload: programData.includesDeload,\n          deloadFrequency: programData.deloadFrequency,\n          totalWeeks: programData.totalWeeks,\n          requiresEndCycleTest: programData.requiresEndCycleTest,\n          isActive: true,\n        });\n\n        res.json(program);\n      } catch (error) {\n        handleError(error, res, \"Errore generazione programma\");\n      }\n    },\n  );\n\n  app.get(\n    \"/api/program/active\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const program = await storage.getActiveProgram(userId);\n        res.json(program || null);\n      } catch (error) {\n        handleError(error, res, \"Errore recupero programma\");\n      }\n    },\n  );\n\n  app.get(\"/api/programs\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const programs = await storage.getUserPrograms(userId);\n      res.json(programs);\n    } catch (error) {\n      handleError(error, res, \"Errore recupero programmi\");\n    }\n  });\n\n  // Adapt workout location (Home vs Gym)\n  app.post(\n    \"/api/program/:programId/day/:dayName/adapt\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const { programId, dayName } = req.params;\n        const { location, equipment } = z\n          .object({\n            location: z.enum([\"gym\", \"home\"]),\n            equipment: z\n              .object({\n                barbell: z.boolean().optional(),\n                dumbbellMaxKg: z.number().optional(),\n                kettlebellKg: z.array(z.number()).optional(),\n                bands: z.boolean().optional(),\n                pullupBar: z.boolean().optional(),\n                bench: z.boolean().optional(),\n              })\n              .optional(),\n          })\n          .parse(req.body);\n\n        // Verifica ownership programma\n        const program = await storage.getProgram(programId);\n        if (!program || program.userId !== userId) {\n          throw new AuthorizationError(\"Programma non valido\");\n        }\n\n        // Recupera screening e assessments originali\n        const screening = await storage.getLatestScreening(userId);\n        if (!screening) {\n          throw new NotFoundError(\"Screening non trovato\");\n        }\n\n        const assessments = await storage.getLatestAssessments(userId);\n\n        // Trova il giorno specifico nel weeklySchedule\n        const daySchedule = program.weeklySchedule?.find(\n          (day: any) => day.dayName === dayName,\n        );\n        if (!daySchedule) {\n          throw new NotFoundError(\"Giorno non trovato nel programma\");\n        }\n\n        // Rigenerata esercizi per il giorno con nuova location\n        const { generateExercisesForDay } = await import(\"./programGenerator\");\n\n        const adaptedExercises = await generateExercisesForDay({\n          dayName,\n          originalExercises: daySchedule.exercises,\n          location,\n          equipment: equipment || screening.equipment || {},\n          painAreas: screening.painAreas || [],\n          assessments: assessments.map((a) => ({\n            exerciseName: a.exerciseName,\n            oneRepMax: parseFloat(a.oneRepMax),\n          })),\n          level: screening.level,\n          goal: screening.goal,\n          specificBodyParts: screening.specificBodyParts || [],\n        });\n\n        // Salva l'adaptation\n        const adaptation = await storage.createWorkoutAdaptation({\n          userId,\n          programId,\n          dayName,\n          location,\n          equipment,\n          adaptedExercises,\n        });\n\n        // Cleanup vecchie adaptations\n        await storage.deleteOldAdaptations();\n\n        res.json({\n          adaptationId: adaptation.id,\n          exercises: adaptedExercises,\n          location,\n        });\n      } catch (error) {\n        handleError(error, res, \"Errore adattamento workout\");\n      }\n    },\n  );\n\n  // ===== WORKOUTS =====\n  app.post(\n    \"/api/workout/start\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const data = workoutStartSchema.parse(req.body);\n\n        // Verify program ownership\n        const program = await storage.getProgram(data.programId);\n        if (!program || program.userId !== userId) {\n          throw new AuthorizationError(\n            \"Programma non valido o non autorizzato\",\n          );\n        }\n\n        const workout = await storage.createWorkout({\n          userId,\n          programId: data.programId,\n          dayName: data.dayName,\n          status: \"in_progress\",\n          sleepHours: data.sleepHours?.toString(),\n          energyLevel: data.energyLevel,\n          painLevel: data.painLevel,\n          painLocation: data.painLocation,\n          preWorkoutNotes: data.preWorkoutNotes,\n        });\n\n        res.json(workout);\n      } catch (error) {\n        handleError(error, res, \"Errore avvio workout\");\n      }\n    },\n  );\n\n  app.get(\n    \"/api/workout/:id\",\n    isAuthenticated,\n    verifyWorkoutOwnership,\n    async (req: any, res: Response) => {\n      try {\n        const workout = req.workout;\n        const sets = await storage.getWorkoutSets(workout.id);\n        res.json({ ...workout, sets });\n      } catch (error) {\n        handleError(error, res, \"Errore recupero workout\");\n      }\n    },\n  );\n\n  app.post(\n    \"/api/workout/:id/set\",\n    isAuthenticated,\n    verifyWorkoutOwnership,\n    async (req: any, res: Response) => {\n      try {\n        const workoutId = req.params.id;\n        const data = workoutSetSchema.parse(req.body);\n\n        const set = await storage.saveWorkoutSet({\n          workoutId,\n          exerciseName: data.exerciseName,\n          setNumber: data.setNumber,\n          reps: data.reps,\n          weight: data.weight.toString(),\n          rpe: data.rpe,\n          isWarmup: data.isWarmup || false,\n        });\n\n        res.json(set);\n      } catch (error) {\n        handleError(error, res, \"Errore salvataggio serie\");\n      }\n    },\n  );\n\n  app.post(\n    \"/api/workout/:id/complete\",\n    isAuthenticated,\n    verifyWorkoutOwnership,\n    async (req: any, res: Response) => {\n      try {\n        const workoutId = req.params.id;\n        const { duration } = z\n          .object({\n            duration: z\n              .number()\n              .positive()\n              .max(300, \"Durata workout non valida\"), // max 5 ore\n          })\n          .parse(req.body);\n\n        // Calculate total volume\n        const sets = await storage.getWorkoutSets(workoutId);\n        const totalVolume = sets\n          .filter((s) => !s.isWarmup)\n          .reduce((sum, s) => sum + s.reps * parseFloat(s.weight), 0);\n\n        const workout = await storage.completeWorkout(\n          workoutId,\n          duration,\n          totalVolume,\n        );\n\n        // Update weekly progress\n        const weekStart = new Date(workout.startedAt);\n        weekStart.setDate(weekStart.getDate() - weekStart.getDay());\n        await storage.updateWeeklyProgress(workout.userId, weekStart);\n\n        res.json(workout);\n      } catch (error) {\n        handleError(error, res, \"Errore completamento workout\");\n      }\n    },\n  );\n\n  app.get(\"/api/workouts\", isAuthenticated, async (req: any, res: Response) => {\n    try {\n      const userId = req.user.claims.sub;\n      const limit = Math.min(parseInt(req.query.limit as string) || 50, 200); // max 200\n      const workouts = await storage.getUserWorkouts(userId, limit);\n      res.json(workouts);\n    } catch (error) {\n      handleError(error, res, \"Errore recupero workouts\");\n    }\n  });\n\n  app.get(\n    \"/api/workout/pain-analysis\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const recentWorkouts = await storage.getRecentWorkoutsWithPain(\n          userId,\n          6,\n        );\n\n        const { analyzePainPersistence, checkRecoveryFromPain } = await import(\n          \"./programGenerator\"\n        );\n\n        const painAnalysis = analyzePainPersistence(recentWorkouts.slice(0, 3));\n        const recoveryCheck = checkRecoveryFromPain(recentWorkouts);\n\n        res.json({\n          painAnalysis,\n          recoveryCheck,\n          recentWorkouts: recentWorkouts.map((w) => ({\n            completedAt: w.completedAt,\n            painLevel: w.painLevel,\n            painLocation: w.painLocation,\n          })),\n        });\n      } catch (error) {\n        handleError(error, res, \"Errore analisi dolore\");\n      }\n    },\n  );\n\n  app.post(\n    \"/api/program/recalibrate\",\n    isAuthenticated,\n    strictLimiter,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n\n        const recentWorkouts = await storage.getRecentWorkoutsWithPain(\n          userId,\n          6,\n        );\n        const {\n          checkRecoveryFromPain,\n          calculateDetrainingFactor,\n          recalibrateProgram,\n          generateProgram,\n        } = await import(\"./programGenerator\");\n\n        const recoveryCheck = checkRecoveryFromPain(recentWorkouts);\n\n        if (!recoveryCheck.canReturnToNormal) {\n          throw new ValidationError(\n            \"Non hai ancora completato 3 sedute consecutive senza dolore\",\n          );\n        }\n\n        const detrainingFactor = calculateDetrainingFactor(recentWorkouts);\n        const assessments = await storage.getLatestAssessments(userId);\n\n        const recalibratedAssessments = recalibrateProgram(\n          assessments.map((a) => ({\n            exerciseName: a.exerciseName,\n            oneRepMax: parseFloat(a.oneRepMax),\n          })),\n          detrainingFactor,\n        );\n\n        const screening = await storage.getLatestScreening(userId);\n        if (!screening) {\n          throw new NotFoundError(\"Screening non trovato\");\n        }\n\n        const activeProgram = await storage.getActiveProgram(userId);\n        if (activeProgram) {\n          await storage.updateProgramStatus(activeProgram.id, false);\n        }\n\n        const programData = generateProgram({\n          level: screening.level,\n          frequency: screening.frequency,\n          location: screening.location || 'gym',\n          hasGym: screening.hasGym,\n          equipment: screening.equipment as any,\n          painAreas: screening.painAreas || [],\n          assessments: recalibratedAssessments,\n          goal: screening.goal,\n          specificBodyParts: screening.specificBodyParts as string[] | undefined,\n          disabilityType: screening.disabilityType || undefined,\n          pregnancyWeek: screening.pregnancyWeek || undefined,\n          pregnancyTrimester: screening.pregnancyTrimester || undefined,\n          hasDoctorClearance: screening.hasDoctorClearance || undefined,\n          pregnancyComplications: screening.pregnancyComplications as string[] | undefined,\n        });\n\n        const newProgram = await storage.createProgram({\n          userId,\n          name: programData.name + \" (Ricalibrato)\",\n          description: programData.description,\n          split: programData.split,\n          daysPerWeek: programData.daysPerWeek,\n          weeklySchedule: programData.weeklySchedule,\n          progression: programData.progression,\n          includesDeload: programData.includesDeload,\n          deloadFrequency: programData.deloadFrequency,\n          totalWeeks: programData.totalWeeks,\n          requiresEndCycleTest: programData.requiresEndCycleTest,\n          isActive: true,\n        });\n\n        res.json({\n          program: newProgram,\n          detrainingFactor,\n          recalibratedAssessments,\n          message: `Programma ricalibrato con successo. Riduzione applicata: ${Math.round((1 - detrainingFactor) * 100)}%`,\n        });\n      } catch (error) {\n        handleError(error, res, \"Errore ricalibrazione programma\");\n      }\n    },\n  );\n\n  // ===== STATS & PROGRESS =====\n  app.get(\n    \"/api/stats/weekly\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const weeks = Math.min(parseInt(req.query.weeks as string) || 12, 52); // max 1 anno\n        const progress = await storage.getWeeklyProgress(userId, weeks);\n        res.json(progress);\n      } catch (error) {\n        handleError(error, res, \"Errore recupero statistiche\");\n      }\n    },\n  );\n\n  app.get(\n    \"/api/stats/prs\",\n    isAuthenticated,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const prs = await storage.getUserPRs(userId);\n        res.json(prs);\n      } catch (error) {\n        handleError(error, res, \"Errore recupero PR\");\n      }\n    },\n  );\n\n  // ===== PAYMENTS =====\n  app.post(\n    \"/api/payment/create\",\n    isAuthenticated,\n    strictLimiter,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const data = paymentSchema.parse(req.body);\n\n        const payment = await storage.createPayment({\n          userId,\n          amount: data.amount.toString(),\n          currency: \"EUR\",\n          provider: data.provider,\n          status: \"pending\",\n        });\n\n        res.json(payment);\n      } catch (error) {\n        handleError(error, res, \"Errore creazione pagamento\");\n      }\n    },\n  );\n\n  app.post(\n    \"/api/payment/:id/confirm\",\n    isAuthenticated,\n    strictLimiter,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        const paymentId = req.params.id;\n        const { transactionId } = z\n          .object({\n            transactionId: z.string().min(1),\n          })\n          .parse(req.body);\n\n        // Verify payment ownership\n        const payment = await storage.getPayment(paymentId);\n        if (!payment || payment.userId !== userId) {\n          throw new AuthorizationError(\"Pagamento non valido\");\n        }\n\n        const updatedPayment = await storage.updatePaymentStatus(\n          paymentId,\n          \"completed\",\n          transactionId,\n        );\n        await storage.updateUserPremium(userId, true);\n\n        res.json(updatedPayment);\n      } catch (error) {\n        handleError(error, res, \"Errore conferma pagamento\");\n      }\n    },\n  );\n\n  // ===== RESET USER DATA =====\n  app.delete(\n    \"/api/user/reset\",\n    isAuthenticated,\n    strictLimiter,\n    async (req: any, res: Response) => {\n      try {\n        const userId = req.user.claims.sub;\n        await storage.resetUserData(userId);\n        res.json({\n          success: true,\n          message: \"Tutti i dati sono stati cancellati. Ricomincia da capo!\",\n        });\n      } catch (error) {\n        handleError(error, res, \"Errore reset dati\");\n      }\n    },\n  );\n\n  // ===== VIEW CODE DOCUMENTATION =====\n  app.get(\"/view-code\", async (req: Request, res: Response) => {\n    try {\n      const fs = await import(\"fs/promises\");\n      const path = await import(\"path\");\n      const filePath = path.join(process.cwd(), \"CODICE_COMPLETO.md\");\n      const content = await fs.readFile(filePath, \"utf-8\");\n\n      const html = `\n<!DOCTYPE html>\n<html lang=\"it\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>TrainSmart - Codice Completo</title>\n  <style>\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      max-width: 100%;\n      margin: 0;\n      padding: 16px;\n      background: #0f172a;\n      color: #e2e8f0;\n      line-height: 1.6;\n    }\n    pre {\n      background: #1e293b;\n      padding: 12px;\n      border-radius: 6px;\n      overflow-x: auto;\n      font-size: 13px;\n    }\n    code {\n      background: #1e293b;\n      padding: 2px 6px;\n      border-radius: 3px;\n      font-size: 14px;\n    }\n    h1 { color: #10b981; margin-top: 24px; }\n    h2 { color: #34d399; margin-top: 20px; }\n    h3 { color: #6ee7b7; margin-top: 16px; }\n    a { color: #60a5fa; }\n    hr { border: 1px solid #334155; margin: 24px 0; }\n    .download-btn {\n      position: fixed;\n      bottom: 20px;\n      right: 20px;\n      background: #10b981;\n      color: white;\n      padding: 12px 24px;\n      border-radius: 8px;\n      text-decoration: none;\n      box-shadow: 0 4px 6px rgba(0,0,0,0.3);\n      font-weight: 600;\n    }\n  </style>\n</head>\n<body>\n  <a href=\"/download-code\" class=\"download-btn\">üì• Download</a>\n  <pre>${content.replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")}</pre>\n</body>\n</html>\n      `;\n\n      res.setHeader(\"Content-Type\", \"text/html; charset=utf-8\");\n      res.send(html);\n    } catch (error) {\n      console.error(\"Error serving code:\", error);\n      res.status(500).send(\"File non trovato\");\n    }\n  });\n\n  app.get(\"/download-code\", async (req: Request, res: Response) => {\n    try {\n      const fs = await import(\"fs/promises\");\n      const path = await import(\"path\");\n      const filePath = path.join(process.cwd(), \"CODICE_COMPLETO.md\");\n      const content = await fs.readFile(filePath, \"utf-8\");\n\n      res.setHeader(\"Content-Type\", \"text/markdown; charset=utf-8\");\n      res.setHeader(\n        \"Content-Disposition\",\n        'attachment; filename=\"CODICE_COMPLETO.md\"',\n      );\n      res.send(content);\n    } catch (error) {\n      console.error(\"Error downloading code:\", error);\n      res.status(500).send(\"Errore download\");\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":29446},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}\n","size_bytes":116},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/components/examples/Pricing.tsx":{"content":"import Pricing from '../Pricing';\n\nexport default function PricingExample() {\n  return <Pricing />;\n}\n","size_bytes":102},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/QuizComponent.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { CheckCircle2, AlertCircle, Info } from \"lucide-react\";\n\n// 7 domande TECNICHE (tecnica esercizi)\nconst TECHNICAL_QUESTIONS = [\n  {\n    question: \"Durante lo squat, dove deve passare la linea del bilanciere vista di lato?\",\n    options: [\n      \"Dietro i talloni\",\n      \"Davanti alle punte dei piedi\",\n      \"Sul centro del piede, in linea con le caviglie\",\n      \"Non importa, basta scendere parallelo\"\n    ],\n    correctAnswer: 2,\n    type: \"technical\"\n  },\n  {\n    question: \"Nello stacco da terra, dove deve rimanere il bilanciere durante tutta la salita?\",\n    options: [\n      \"Deve toccare solo all'inizio\",\n      \"Lontano dal corpo per evitare di toccare le gambe\",\n      \"Deve oscillare liberamente\",\n      \"Attaccato al corpo o a pochi millimetri di distanza\"\n    ],\n    correctAnswer: 3,\n    type: \"technical\"\n  },\n  {\n    question: \"Cosa devono fare le scapole PRIMA di iniziare a tirare nelle trazioni?\",\n    options: [\n      \"Depresse (abbassate) e leggermente addotte (avvicinate)\",\n      \"Rimanere completamente rilassate\",\n      \"Non importa, basta tirare forte\",\n      \"Elevarsi completamente verso l'alto\"\n    ],\n    correctAnswer: 0,\n    type: \"technical\"\n  },\n  {\n    question: \"Nella panca piana, qual √® la traiettoria corretta del bilanciere?\",\n    options: [\n      \"Orizzontale parallela al pavimento\",\n      \"Verticale dritta su e gi√π\",\n      \"Circolare intorno al petto\",\n      \"Leggermente diagonale verso i piedi in discesa, verso la testa in salita\"\n    ],\n    correctAnswer: 3,\n    type: \"technical\"\n  },\n  {\n    question: \"Nel military press, dove deve essere posizionato il bilanciere a inizio movimento?\",\n    options: [\n      \"All'altezza dell'ombelico\",\n      \"Appoggiato sulle spalle dietro la testa\",\n      \"All'altezza delle clavicole/parte alta petto\",\n      \"Sopra la testa\"\n    ],\n    correctAnswer: 2,\n    type: \"technical\"\n  },\n  {\n    question: \"Durante il rematore con bilanciere, qual √® l'angolo corretto del busto?\",\n    options: [\n      \"Dipende dall'umore\",\n      \"Completamente verticale (90¬∞)\",\n      \"Quasi orizzontale al pavimento (10-20¬∞ sopra)\",\n      \"Circa 45¬∞ rispetto al pavimento\"\n    ],\n    correctAnswer: 2,\n    type: \"technical\"\n  },\n  {\n    question: \"Cos'√® il 'valsalva' e quando si usa?\",\n    options: [\n      \"Una marca di bilancieri\",\n      \"Un esercizio per i polpacci\",\n      \"Un tipo di squat bulgaro\",\n      \"Una tecnica di respirazione per stabilizzare il core sotto carico pesante\"\n    ],\n    correctAnswer: 3,\n    type: \"technical\"\n  }\n];\n\n// 3 domande PRESTAZIONI (carichi e 1RM)\nconst PERFORMANCE_QUESTIONS = [\n  {\n    question: \"Quanto pesi e quanto fai di squat per 5 ripetizioni con buona tecnica?\",\n    options: [\n      \"Meno del mio peso corporeo\",\n      \"Uguale al mio peso corporeo\",\n      \"1.5x il mio peso corporeo\",\n      \"2x o pi√π il mio peso corporeo\"\n    ],\n    correctAnswer: -1, // Nessuna risposta \"corretta\", serve solo per valutare\n    scores: [0, 1, 2, 3], // Punteggio per ogni opzione\n    type: \"performance\"\n  },\n  {\n    question: \"Quanto fai di panca piana per 5 ripetizioni con buona tecnica?\",\n    options: [\n      \"Meno di 60kg\",\n      \"60-80kg\",\n      \"80-100kg\",\n      \"Oltre 100kg\"\n    ],\n    correctAnswer: -1,\n    scores: [0, 1, 2, 3],\n    type: \"performance\"\n  },\n  {\n    question: \"Conosci i tuoi massimali (1RM) negli esercizi fondamentali?\",\n    options: [\n      \"No, non li ho mai testati\",\n      \"S√¨, ma sono stime approssimative\",\n      \"S√¨, li ho calcolati con formule affidabili\",\n      \"S√¨, li ho testati realmente e li aggiorno regolarmente\"\n    ],\n    correctAnswer: -1,\n    scores: [0, 1, 2, 3],\n    type: \"performance\"\n  }\n];\n\nconst ALL_QUESTIONS = [...TECHNICAL_QUESTIONS, ...PERFORMANCE_QUESTIONS];\n\nexport default function QuizComponent() {\n  const [currentQuestion, setCurrentQuestion] = useState(0);\n  const [selectedAnswer, setSelectedAnswer] = useState<number | null>(null);\n  const [showResult, setShowResult] = useState(false);\n  const [technicalScore, setTechnicalScore] = useState(0);\n  const [performanceScore, setPerformanceScore] = useState(0);\n  const [answers, setAnswers] = useState<number[]>([]);\n\n  const question = ALL_QUESTIONS[currentQuestion];\n  const progress = ((currentQuestion + 1) / ALL_QUESTIONS.length) * 100;\n\n  const handleAnswer = (index: number) => {\n    setSelectedAnswer(index);\n  };\n\n  const handleNext = () => {\n    if (selectedAnswer === null) return;\n\n    const newAnswers = [...answers, selectedAnswer];\n    setAnswers(newAnswers);\n\n    // Calcola punteggi\n    if (question.type === \"technical\") {\n      if (selectedAnswer === question.correctAnswer) {\n        setTechnicalScore(technicalScore + 1);\n      }\n    } else if (question.type === \"performance\") {\n      const scores = (question as any).scores;\n      setPerformanceScore(performanceScore + scores[selectedAnswer]);\n    }\n\n    if (currentQuestion < ALL_QUESTIONS.length - 1) {\n      setCurrentQuestion(currentQuestion + 1);\n      setSelectedAnswer(null);\n    } else {\n      setShowResult(true);\n    }\n  };\n\n  if (showResult) {\n    const technicalPercentage = Math.round((technicalScore / TECHNICAL_QUESTIONS.length) * 100);\n    const maxPerformanceScore = PERFORMANCE_QUESTIONS.reduce((sum, q: any) => sum + Math.max(...q.scores), 0);\n    const performancePercentage = Math.round((performanceScore / maxPerformanceScore) * 100);\n\n    // LOGICA DETERMINAZIONE LIVELLO\n    let level: string;\n    let levelLabel: string;\n    let message: string;\n\n    if (technicalPercentage < 50) {\n      // TECNICA INSUFFICIENTE ‚Üí PRINCIPIANTE (indipendentemente dai carichi)\n      level = \"beginner\";\n      levelLabel = \"Principiante\";\n      message = \"La tecnica √® fondamentale per la sicurezza. Anche se i tuoi carichi sono buoni, √® necessario un reset sulla tecnica prima di progredire. Inizierai con un programma focalizzato sulla forma corretta.\";\n    } else if (performancePercentage < 40) {\n      // TECNICA OK ma carichi bassi ‚Üí INTERMEDIO\n      level = \"intermediate\";\n      levelLabel = \"Intermedio\";\n      message = \"Ottima tecnica! Ora √® il momento di costruire forza con un programma strutturato per aumentare i carichi in sicurezza.\";\n    } else {\n      // TECNICA OK e carichi buoni ‚Üí AVANZATO\n      level = \"advanced\";\n      levelLabel = \"Avanzato\";\n      message = \"Eccellente! Hai tecnica solida e buoni carichi. Sei pronto per un programma avanzato con periodizzazione e progressione ottimale.\";\n    }\n\n    // Salva quiz e aggiorna livello\n    const handleContinue = async () => {\n      try {\n        // Salva risultato quiz\n        await fetch(\"/api/quiz/submit\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({\n            score: technicalScore + performanceScore,\n            totalQuestions: ALL_QUESTIONS.length,\n            answers,\n            difficulty: level\n          })\n        });\n\n        // Aggiorna screening con livello determinato\n        await fetch(\"/api/screening/update-level\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ level })\n        });\n\n        // Naviga a assessment\n        window.location.href = \"/assessment\";\n      } catch (error) {\n        console.error(\"Error saving quiz:\", error);\n      }\n    };\n\n    return (\n      <div className=\"min-h-screen bg-background flex items-center py-12\">\n        <div className=\"max-w-2xl mx-auto px-4 w-full\">\n          <Card>\n            <CardHeader className=\"text-center\">\n              <div className=\"w-20 h-20 mx-auto mb-4 rounded-full bg-primary/10 flex items-center justify-center\">\n                {technicalPercentage >= 50 ? (\n                  <CheckCircle2 className=\"w-10 h-10 text-chart-3\" />\n                ) : (\n                  <AlertCircle className=\"w-10 h-10 text-chart-2\" />\n                )}\n              </div>\n              <CardTitle className=\"text-3xl\">Valutazione Completata!</CardTitle>\n              <CardDescription className=\"text-lg\">\n                Tecnica: {technicalScore}/{TECHNICAL_QUESTIONS.length} ({technicalPercentage}%) | \n                Prestazioni: {performanceScore}/{maxPerformanceScore} ({performancePercentage}%)\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div className=\"text-center space-y-4\">\n                <div className=\"bg-primary/10 border border-primary/20 rounded-lg p-4\">\n                  <p className=\"text-sm text-muted-foreground mb-2\">Livello determinato:</p>\n                  <p className=\"text-2xl font-bold text-primary\">{levelLabel}</p>\n                </div>\n\n                <div className=\"bg-muted/50 rounded-lg p-4\">\n                  <div className=\"flex items-start gap-3\">\n                    <Info className=\"w-5 h-5 text-primary flex-shrink-0 mt-0.5\" />\n                    <p className=\"text-sm text-muted-foreground text-left\">{message}</p>\n                  </div>\n                </div>\n\n                {technicalPercentage < 50 && performancePercentage >= 60 && (\n                  <div className=\"bg-amber-500/10 border border-amber-500/20 rounded-lg p-4\">\n                    <p className=\"text-sm text-amber-600 dark:text-amber-400\">\n                      ‚ö†Ô∏è <strong>Importante:</strong> Anche se hai buoni carichi, la tecnica insufficiente pu√≤ portare a infortuni. \n                      Il programma Principiante ti aiuter√† a perfezionare la forma prima di aumentare l'intensit√†.\n                    </p>\n                  </div>\n                )}\n              </div>\n\n              <Button onClick={handleContinue} className=\"w-full\" size=\"lg\" data-testid=\"button-continue\">\n                Continua al Test di Forza\n              </Button>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center py-12\">\n      <div className=\"max-w-2xl mx-auto px-4 w-full\">\n        <div className=\"mb-8\">\n          <Progress value={progress} className=\"h-2\" />\n          <div className=\"flex justify-between text-sm text-muted-foreground mt-2\">\n            <span>Domanda {currentQuestion + 1} di {ALL_QUESTIONS.length}</span>\n            <span>{question.type === \"technical\" ? \"Tecnica\" : \"Prestazioni\"}</span>\n          </div>\n        </div>\n\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-xl\">{question.question}</CardTitle>\n            <CardDescription>\n              {question.type === \"technical\" ? \"Seleziona la risposta tecnicamente corretta\" : \"Seleziona l'opzione che ti rappresenta\"}\n            </CardDescription>\n          </CardHeader>\n\n          <CardContent className=\"space-y-3\">\n            {question.options.map((option, index) => (\n              <button\n                key={index}\n                onClick={() => handleAnswer(index)}\n                className={`w-full text-left p-4 rounded-lg border transition-all hover-elevate ${\n                  selectedAnswer === index \n                    ? 'border-primary bg-primary/5' \n                    : 'border-border'\n                }`}\n                data-testid={`button-option-${index}`}\n              >\n                <div className=\"flex items-center gap-3\">\n                  <div className={`w-6 h-6 rounded-full border-2 flex items-center justify-center ${\n                    selectedAnswer === index ? 'border-primary bg-primary' : 'border-muted'\n                  }`}>\n                    {selectedAnswer === index && <div className=\"w-2 h-2 rounded-full bg-primary-foreground\" />}\n                  </div>\n                  <span>{option}</span>\n                </div>\n              </button>\n            ))}\n          </CardContent>\n\n          <div className=\"p-6 pt-0\">\n            <Button \n              onClick={handleNext}\n              disabled={selectedAnswer === null}\n              className=\"w-full\"\n              size=\"lg\"\n              data-testid=\"button-next-question\"\n            >\n              {currentQuestion === ALL_QUESTIONS.length - 1 ? 'Vedi Risultato' : 'Prossima Domanda'}\n            </Button>\n          </div>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":12478},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/components/Features.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Brain, TrendingUp, Shield, Target, BarChart3, Zap, Sparkles } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\n\nconst features = [\n  {\n    icon: Sparkles,\n    title: \"ADAPTFLOW‚Ñ¢\",\n    description: \"Sistema intelligente che adatta automaticamente il tuo piano in base a dolori, situazioni e progressi\",\n    highlight: true\n  },\n  {\n    icon: Brain,\n    title: \"Quiz Tecnico\",\n    description: \"Quiz iniziale per stabilire il tuo livello di conoscenza degli esercizi\"\n  },\n  {\n    icon: Target,\n    title: \"Programmi Personalizzati\",\n    description: \"Schede basate sul tuo livello, frequenza e obiettivi specifici\"\n  },\n  {\n    icon: TrendingUp,\n    title: \"Progressione Scientifica\",\n    description: \"Calcolo automatico dei pesi usando formule validate scientificamente\"\n  },\n  {\n    icon: BarChart3,\n    title: \"Tracciamento Dettagliato\",\n    description: \"Monitora ogni serie, ripetizione e kg sollevato nel tempo\"\n  },\n  {\n    icon: Shield,\n    title: \"Gestione Infortuni\",\n    description: \"Esercizi alternativi sicuri in base alle tue zone doloranti\"\n  }\n];\n\nexport default function Features() {\n  return (\n    <div className=\"py-24 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4\">\n        <div className=\"text-center mb-16\">\n          <h2 className=\"font-display text-4xl md:text-5xl mb-4 text-foreground\">\n            Tutto ci√≤ che ti serve per <span className=\"text-primary\">crescere</span>\n          </h2>\n          <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n            Sistema completo di allenamento che si adatta al tuo livello e ai tuoi obiettivi\n          </p>\n        </div>\n\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {features.map((feature, index) => (\n            <Card \n              key={index} \n              className={`hover-elevate ${feature.highlight ? 'border-primary shadow-lg' : ''}`} \n              data-testid={`card-feature-${index}`}\n            >\n              <CardHeader>\n                {feature.highlight && (\n                  <Badge className=\"w-fit mb-2 bg-chart-2\">\n                    <Sparkles className=\"w-3 h-3 mr-1\" />\n                    Tecnologia Esclusiva\n                  </Badge>\n                )}\n                <div className=\"w-12 h-12 rounded-lg bg-primary/10 flex items-center justify-center mb-4\">\n                  <feature.icon className=\"w-6 h-6 text-primary\" />\n                </div>\n                <CardTitle className=\"text-xl\">{feature.title}</CardTitle>\n                <CardDescription className=\"text-base\">{feature.description}</CardDescription>\n              </CardHeader>\n            </Card>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2828},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"client/src/components/ScreeningFlow.tsx":{"content":"import { useState } from \"react\";\nimport {\n  ChevronRight,\n  ChevronLeft,\n  Target,\n  TrendingUp,\n  Dumbbell,\n  Calendar,\n  AlertCircle,\n  AlertTriangle,\n} from \"lucide-react\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\n\nconst STEPS = [\n  { id: \"goal\", title: \"Obiettivo\", icon: Target },\n  { id: \"sport\", title: \"Sport\", icon: TrendingUp }, // Solo se performance\n  { id: \"specific_goals\", title: \"Obiettivi Specifici\", icon: Target }, // Solo se toning o muscle_gain\n  { id: \"disability_type\", title: \"Tipo Disabilit√†\", icon: AlertCircle }, // Solo se disability\n  { id: \"pregnancy_info\", title: \"Info Gravidanza\", icon: AlertCircle }, // Solo se pregnancy\n  { id: \"bodyweight\", title: \"Peso\", icon: TrendingUp },\n  { id: \"availability\", title: \"Disponibilit√†\", icon: Calendar },\n  { id: \"location\", title: \"Location\", icon: Dumbbell },\n  { id: \"equipment\", title: \"Attrezzatura\", icon: Dumbbell }, // Solo se home/mixed\n  { id: \"injuries\", title: \"Infortuni\", icon: AlertCircle },\n];\n\nconst GOALS = [\n  {\n    id: \"weight_loss\",\n    label: \"Perdita Peso\",\n    emoji: \"üî•\",\n    description: \"Focus su deficit calorico e cardio\",\n  },\n  {\n    id: \"muscle_gain\",\n    label: \"Massa Muscolare\",\n    emoji: \"üí™\",\n    description: \"Ipertrofia e surplus calorico\",\n  },\n  {\n    id: \"strength\",\n    label: \"Forza\",\n    emoji: \"‚ö°\",\n    description: \"Massimali e potenza\",\n  },\n  {\n    id: \"toning\",\n    label: \"Tonificazione\",\n    emoji: \"‚ú®\",\n    description: \"Obiettivo estetico - definizione e composizione corporea\",\n  },\n  {\n    id: \"performance\",\n    label: \"Prestazioni Sportive\",\n    emoji: \"üèÜ\",\n    description: \"Obiettivo prestativo - forza, potenza, performance atletica\",\n  },\n  {\n    id: \"endurance\",\n    label: \"Resistenza\",\n    emoji: \"üèÉ\",\n    description: \"Capacit√† aerobica\",\n  },\n  {\n    id: \"general\",\n    label: \"Fitness Generale\",\n    emoji: \"üéØ\",\n    description: \"Salute e benessere\",\n  },\n  {\n    id: \"disability\",\n    label: \"Disabilit√† Motorie\",\n    emoji: \"ü¶Ω\",\n    description: \"Programmi adattati per limitazioni fisiche\",\n  },\n  {\n    id: \"pregnancy\",\n    label: \"Gravidanza\",\n    emoji: \"ü§∞\",\n    description: \"Allenamento sicuro per donne in gravidanza\",\n  },\n];\n\nconst SPORTS = [\n  { id: \"calcio\", label: \"Calcio\", emoji: \"‚öΩ\" },\n  { id: \"basket\", label: \"Basket\", emoji: \"üèÄ\" },\n  { id: \"tennis\", label: \"Tennis\", emoji: \"üéæ\" },\n  { id: \"pallavolo\", label: \"Pallavolo\", emoji: \"üèê\" },\n  { id: \"nuoto\", label: \"Nuoto\", emoji: \"üèä\" },\n  { id: \"motocross\", label: \"Motocross\", emoji: \"üèçÔ∏è\" },\n  { id: \"rugby\", label: \"Rugby\", emoji: \"üèâ\" },\n];\n\nconst SOCCER_ROLES = [\n  { id: \"portiere\", label: \"Portiere\", emoji: \"üß§\", description: \"Esplosivit√† e reattivit√†\" },\n  { id: \"difensore\", label: \"Difensore\", emoji: \"üõ°Ô∏è\", description: \"Forza e duelli\" },\n  { id: \"centrocampista\", label: \"Centrocampista\", emoji: \"üèÉ\", description: \"Resistenza aerobica\" },\n  { id: \"attaccante\", label: \"Attaccante\", emoji: \"‚ö°\", description: \"Velocit√† ed esplosivit√†\" },\n];\n\nconst INJURY_AREAS = [\n  { id: \"knee\", label: \"Ginocchia\", emoji: \"ü¶µ\" },\n  { id: \"shoulder\", label: \"Spalle\", emoji: \"üí™\" },\n  { id: \"back\", label: \"Schiena\", emoji: \"üîô\" },\n  { id: \"elbow\", label: \"Gomiti\", emoji: \"üí™\" },\n  { id: \"wrist\", label: \"Polsi\", emoji: \"ü§ö\" },\n  { id: \"ankles\", label: \"Caviglie\", emoji: \"ü¶∂\" },\n];\n\nconst DISABILITY_TYPES = [\n  { id: \"paraplegia\", label: \"Paraplegia\", emoji: \"ü¶Ω\", description: \"Paralisi degli arti inferiori\" },\n  { id: \"tetraplegia\", label: \"Tetraplegia\", emoji: \"ü¶º\", description: \"Paralisi di tutti e quattro gli arti\" },\n  { id: \"hemiplegia\", label: \"Emiplegia\", emoji: \"ü¶Ø\", description: \"Paralisi di un lato del corpo\" },\n  { id: \"amputazione_arti_inferiori\", label: \"Amputazione Arti Inferiori\", emoji: \"ü¶ø\", description: \"Amputazione di una o entrambe le gambe\" },\n  { id: \"amputazione_arti_superiori\", label: \"Amputazione Arti Superiori\", emoji: \"ü¶æ\", description: \"Amputazione di uno o entrambi gli arti superiori\" },\n  { id: \"sclerosi_multipla\", label: \"Sclerosi Multipla\", emoji: \"üß†\", description: \"Compromissione progressiva del movimento\" },\n  { id: \"distrofia_muscolare\", label: \"Distrofia Muscolare\", emoji: \"üí™\", description: \"Debolezza muscolare progressiva\" },\n  { id: \"cerebral_palsy\", label: \"Paralisi Cerebrale\", emoji: \"üß†\", description: \"Disturbi del movimento e della postura\" },\n  { id: \"altra\", label: \"Altra Disabilit√† Motoria\", emoji: \"üîß\", description: \"Specifica nelle note\" },\n];\n\nconst BODY_FOCUS_AREAS = [\n  { id: \"chest\", label: \"Petto\", emoji: \"üõ°Ô∏è\", description: \"Sviluppo pettorali\" },\n  { id: \"arms\", label: \"Braccia\", emoji: \"üí™\", description: \"Bicipiti e tricipiti\" },\n  { id: \"shoulders\", label: \"Spalle\", emoji: \"üî•\", description: \"Deltoidi 3D\" },\n  { id: \"back_width\", label: \"Schiena Larga\", emoji: \"ü¶Ö\", description: \"Dorsali e ampiezza\" },\n  { id: \"back_thickness\", label: \"Schiena Spessa\", emoji: \"üíé\", description: \"Trapezi e romboidi\" },\n  { id: \"legs\", label: \"Gambe\", emoji: \"ü¶µ\", description: \"Quadricipiti e femorali\" },\n  { id: \"glutes\", label: \"Glutei\", emoji: \"üçë\", description: \"Focus glutei\" },\n  { id: \"abs\", label: \"Addome\", emoji: \"‚ö°\", description: \"Core e definizione addominale\" },\n  { id: \"calves\", label: \"Polpacci\", emoji: \"ü¶ø\", description: \"Sviluppo polpacci\" },\n];\n\nconst PREGNANCY_COMPLICATIONS = [\n  { id: \"pre_eclampsia\", label: \"Pre-eclampsia\", emoji: \"‚ö†Ô∏è\", description: \"Pressione alta in gravidanza\" },\n  { id: \"gestational_diabetes\", label: \"Diabete Gestazionale\", emoji: \"ü©∫\", description: \"Glicemia elevata\" },\n  { id: \"placenta_previa\", label: \"Placenta Previa\", emoji: \"üö®\", description: \"Placenta bassa\" },\n  { id: \"cervical_insufficiency\", label: \"Insufficienza Cervicale\", emoji: \"‚ö†Ô∏è\", description: \"Collo dell'utero debole\" },\n  { id: \"multiple_pregnancy\", label: \"Gravidanza Gemellare\", emoji: \"üë∂üë∂\", description: \"Due o pi√π feti\" },\n  { id: \"previous_cesarean\", label: \"Precedente Cesareo\", emoji: \"üè•\", description: \"Storia di parto cesareo\" },\n];\n\ninterface ScreeningFlowProps {\n  onComplete?: () => void;\n}\n\nexport default function ScreeningFlow({ onComplete }: ScreeningFlowProps) {\n  const [currentStep, setCurrentStep] = useState(0);\n  const [data, setData] = useState<{\n    goal: string;\n    sportType: string;\n    specificBodyParts: string[];\n    disabilityType: string;\n    pregnancyWeek: number;\n    pregnancyTrimester: number;\n    hasDoctorClearance: boolean;\n    hasReadPregnancyDisclaimer: boolean;\n    hasReadDisabilityDisclaimer: boolean;\n    pregnancyComplications: string[];\n    bodyWeight: number;\n    level: string;\n    frequency: number;\n    location: string;\n    hasGym: boolean | null;\n    equipment: {\n      barbell: boolean;\n      dumbbellMaxKg: number;\n      kettlebellKg: number[];\n      bands: boolean;\n      pullupBar: boolean;\n      bench: boolean;\n    };\n    painAreas: string[];\n  }>({\n    goal: \"\",\n    sportType: \"\",\n    specificBodyParts: [],\n    disabilityType: \"\",\n    pregnancyWeek: 12,\n    pregnancyTrimester: 1,\n    hasDoctorClearance: false,\n    hasReadPregnancyDisclaimer: false,\n    hasReadDisabilityDisclaimer: false,\n    pregnancyComplications: [],\n    bodyWeight: 70,\n    level: \"beginner\",\n    frequency: 3,\n    location: \"\",\n    hasGym: null,\n    equipment: {\n      barbell: false,\n      dumbbellMaxKg: 0,\n      kettlebellKg: [],\n      bands: false,\n      pullupBar: false,\n      bench: false,\n    },\n    painAreas: [],\n  });\n\n  // Determina gli step visibili in base al goal e location\n  const visibleSteps = STEPS.filter(step => {\n    if (step.id === \"sport\") {\n      return data.goal === \"performance\";\n    }\n    if (step.id === \"specific_goals\") {\n      return data.goal === \"toning\" || data.goal === \"muscle_gain\";\n    }\n    if (step.id === \"disability_type\") {\n      return data.goal === \"disability\";\n    }\n    if (step.id === \"pregnancy_info\") {\n      return data.goal === \"pregnancy\";\n    }\n    if (step.id === \"equipment\") {\n      return data.location === \"home\" || data.location === \"mixed\";\n    }\n    return true;\n  });\n\n  const step = visibleSteps[currentStep];\n  const progress = ((currentStep + 1) / visibleSteps.length) * 100;\n\n  // Step opzionali (possono essere skippati)\n  const isOptionalStep = ['specific_goals', 'equipment', 'injuries'].includes(step.id);\n\n  const handleNext = () => {\n    if (currentStep < visibleSteps.length - 1) {\n      setCurrentStep(currentStep + 1);\n    } else {\n      handleSubmit();\n    }\n  };\n\n  const handleBack = () => {\n    if (currentStep > 0) {\n      setCurrentStep(currentStep - 1);\n    }\n  };\n\n  const handleSubmit = async () => {\n    try {\n      // Prepara i dati per il submit\n      const submitData: any = { ...data };\n      \n      // Aggiungi objectiveType solo se necessario\n      if (data.goal === \"toning\") {\n        submitData.objectiveType = \"toning\";\n      } else if (data.goal === \"performance\") {\n        submitData.objectiveType = \"performance\";\n      }\n      // Non include objectiveType se non √® toning o performance\n\n      await fetch(\"/api/screening\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(submitData),\n      });\n\n      // Naviga al quiz per determinare il livello\n      window.location.href = \"/quiz\";\n      \n      if (onComplete) onComplete();\n    } catch (error) {\n      console.error(\"Error saving screening:\", error);\n      alert(\"Errore nel salvare lo screening. Riprova.\");\n    }\n  };\n\n  const isStepValid = () => {\n    switch (step.id) {\n      case \"goal\":\n        return data.goal !== \"\";\n      case \"sport\":\n        return data.sportType !== \"\";\n      case \"specific_goals\":\n        return true; // Optional - pu√≤ essere vuoto o con selezioni multiple\n      case \"disability_type\":\n        return data.disabilityType !== \"\" && data.hasReadDisabilityDisclaimer;\n      case \"pregnancy_info\":\n        return data.hasReadPregnancyDisclaimer && data.hasDoctorClearance && data.pregnancyWeek >= 1 && data.pregnancyWeek <= 40;\n      case \"bodyweight\":\n        return data.bodyWeight >= 30 && data.bodyWeight <= 250;\n      case \"availability\":\n        return data.frequency >= 2;\n      case \"location\":\n        return data.location !== \"\";\n      case \"equipment\":\n        return true; // Optional, qualsiasi configurazione va bene\n      case \"injuries\":\n        return true; // Optional\n      default:\n        return false;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-slate-950 text-white p-6\">\n      <div className=\"max-w-2xl mx-auto\">\n        {/* Progress Bar */}\n        <div className=\"mb-8\">\n          <div className=\"flex justify-between text-sm text-slate-400 mb-2\">\n            <span>\n              Step {currentStep + 1} di {visibleSteps.length}\n            </span>\n            <span>{Math.round(progress)}%</span>\n          </div>\n          <div className=\"w-full bg-slate-800 rounded-full h-2\">\n            <div\n              className=\"bg-emerald-600 h-2 rounded-full transition-all duration-300\"\n              style={{ width: `${progress}%` }}\n            />\n          </div>\n        </div>\n\n        {/* Step Indicators */}\n        <div className=\"flex justify-between mb-8\">\n          {visibleSteps.map((s, i) => {\n            const Icon = s.icon;\n            const isActive = i === currentStep;\n            const isCompleted = i < currentStep;\n\n            return (\n              <div key={s.id} className=\"flex flex-col items-center\">\n                <div\n                  className={`w-12 h-12 rounded-full flex items-center justify-center mb-2 transition-colors ${\n                    isActive\n                      ? \"bg-emerald-600\"\n                      : isCompleted\n                        ? \"bg-emerald-600/30\"\n                        : \"bg-slate-800\"\n                  }`}\n                >\n                  <Icon className=\"w-6 h-6\" />\n                </div>\n                <p className=\"text-xs text-slate-400 hidden sm:block\">\n                  {s.title}\n                </p>\n              </div>\n            );\n          })}\n        </div>\n\n        {/* Step Content */}\n        <div className=\"bg-slate-900 rounded-2xl p-8 mb-6\">\n          <div className=\"flex items-center gap-3 mb-6\">\n            <h2 className=\"text-2xl font-bold\">{step.title}</h2>\n            {isOptionalStep && (\n              <span className=\"text-xs px-2 py-1 rounded-full bg-blue-600/20 text-blue-400 border border-blue-600/30\">\n                Opzionale\n              </span>\n            )}\n          </div>\n          {isOptionalStep && (\n            <p className=\"text-sm text-slate-400 mb-4\">\n              üí° Questo step √® opzionale. Puoi cliccare \"Avanti\" per saltarlo se non applicabile.\n            </p>\n          )}\n\n          {/* Goal Step */}\n          {step.id === \"goal\" && (\n            <div className=\"space-y-3\">\n              {GOALS.map((goal) => (\n                <button\n                  key={goal.id}\n                  onClick={() => setData({ ...data, goal: goal.id })}\n                  className={`w-full p-4 rounded-xl border-2 transition-all text-left ${\n                    data.goal === goal.id\n                      ? \"border-emerald-600 bg-emerald-600/10\"\n                      : \"border-slate-700 hover:border-slate-600\"\n                  }`}\n                  data-testid={`button-goal-${goal.id}`}\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <span className=\"text-3xl\">{goal.emoji}</span>\n                    <div className=\"flex-1\">\n                      <p className=\"font-semibold\">{goal.label}</p>\n                      <p className=\"text-sm text-slate-400\">\n                        {goal.description}\n                      </p>\n                    </div>\n                  </div>\n                </button>\n              ))}\n            </div>\n          )}\n\n          {/* Sport Step - Solo per Prestazioni Sportive */}\n          {step.id === \"sport\" && (\n            <div>\n              <p className=\"text-slate-400 mb-6\">\n                Per quale sport vuoi migliorare le prestazioni?\n              </p>\n              <div className=\"grid grid-cols-2 gap-3\">\n                {SPORTS.map((sport) => (\n                  <button\n                    key={sport.id}\n                    onClick={() => setData({ ...data, sportType: sport.id })}\n                    className={`p-4 rounded-xl border-2 transition-all ${\n                      data.sportType === sport.id\n                        ? \"border-emerald-600 bg-emerald-600/10\"\n                        : \"border-slate-700 hover:border-slate-600\"\n                    }`}\n                    data-testid={`button-sport-${sport.id}`}\n                  >\n                    <div className=\"text-center\">\n                      <div className=\"text-4xl mb-2\">{sport.emoji}</div>\n                      <p className=\"font-semibold text-sm\">{sport.label}</p>\n                    </div>\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Specific Goals Step - Solo per Tonificazione e Ipertrofia */}\n          {step.id === \"specific_goals\" && (\n            <div>\n              <p className=\"text-slate-400 mb-6\">\n                {data.goal === \"toning\" \n                  ? \"Su quali zone vuoi concentrarti per la tonificazione?\"\n                  : \"Quali gruppi muscolari vuoi sviluppare maggiormente?\"}\n              </p>\n              <p className=\"text-sm text-emerald-400 mb-4\">\n                ‚ú® Seleziona uno o pi√π obiettivi specifici (opzionale)\n              </p>\n              <div className=\"grid grid-cols-2 gap-3\">\n                {BODY_FOCUS_AREAS.map((area) => {\n                  const isSelected = data.specificBodyParts.includes(area.id);\n                  return (\n                    <button\n                      key={area.id}\n                      onClick={() => {\n                        const newParts = isSelected\n                          ? data.specificBodyParts.filter(p => p !== area.id)\n                          : [...data.specificBodyParts, area.id];\n                        setData({ ...data, specificBodyParts: newParts });\n                      }}\n                      className={`p-4 rounded-xl border-2 transition-all ${\n                        isSelected\n                          ? \"border-emerald-600 bg-emerald-600/10\"\n                          : \"border-slate-700 hover:border-slate-600\"\n                      }`}\n                      data-testid={`button-bodypart-${area.id}`}\n                    >\n                      <div className=\"text-center\">\n                        <div className=\"text-3xl mb-1\">{area.emoji}</div>\n                        <p className=\"font-semibold text-sm\">{area.label}</p>\n                        <p className=\"text-xs text-slate-400 mt-1\">{area.description}</p>\n                      </div>\n                    </button>\n                  );\n                })}\n              </div>\n              <div className=\"bg-blue-600/10 border border-blue-600/30 rounded-xl p-4 mt-6\">\n                <p className=\"text-sm text-blue-400\">\n                  üí° La scheda verr√† adattata per dare priorit√† alle zone selezionate\n                </p>\n              </div>\n            </div>\n          )}\n\n          {/* Disability Type Step - Solo per Disabilit√† Motorie */}\n          {step.id === \"disability_type\" && (\n            <div>\n              <p className=\"text-slate-400 mb-6\">\n                Seleziona il tipo specifico di disabilit√† motoria per ricevere un piano di allenamento individualizzato\n              </p>\n              <div className=\"space-y-3\">\n                {DISABILITY_TYPES.map((disability) => (\n                  <button\n                    key={disability.id}\n                    onClick={() => setData({ ...data, disabilityType: disability.id })}\n                    className={`w-full p-4 rounded-xl border-2 transition-all text-left ${\n                      data.disabilityType === disability.id\n                        ? \"border-emerald-600 bg-emerald-600/10\"\n                        : \"border-slate-700 hover:border-slate-600\"\n                    }`}\n                    data-testid={`button-disability-${disability.id}`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-3xl\">{disability.emoji}</span>\n                      <div className=\"flex-1\">\n                        <p className=\"font-semibold\">{disability.label}</p>\n                        <p className=\"text-sm text-slate-400\">{disability.description}</p>\n                      </div>\n                    </div>\n                  </button>\n                ))}\n              </div>\n              \n              {/* LEGAL DISCLAIMER DISABILITY */}\n              <Alert variant=\"destructive\" className=\"mt-6\">\n                <AlertTriangle className=\"h-4 w-4\" />\n                <AlertTitle>Avviso Medico Importante - Responsabilit√† Utente</AlertTitle>\n                <AlertDescription className=\"mt-2 space-y-3\">\n                  <p className=\"text-sm\">\n                    <strong>Questo programma √® complementare ma NON sostituisce le indicazioni del tuo fisioterapista o medico specialista.</strong>\n                  </p>\n                  <p className=\"text-sm\">\n                    Devi consultare sempre il tuo team medico prima di modificare la tua routine di allenamento. \n                    L'utente si assume piena responsabilit√† per le proprie scelte.\n                  </p>\n                  <label className=\"flex items-start gap-3 mt-4 p-3 bg-black/30 rounded-lg cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={data.hasReadDisabilityDisclaimer}\n                      onChange={(e) => setData({ ...data, hasReadDisabilityDisclaimer: e.target.checked })}\n                      className=\"mt-1 w-4 h-4 rounded border-red-600 text-red-600 focus:ring-red-600\"\n                      data-testid=\"checkbox-disability-disclaimer\"\n                    />\n                    <span className=\"text-sm text-slate-200\">\n                      Ho letto e compreso. Confermo di aver consultato il mio team medico e procedo sotto mia responsabilit√†.\n                    </span>\n                  </label>\n                </AlertDescription>\n              </Alert>\n            </div>\n          )}\n\n          {/* Pregnancy Info Step - Solo per Gravidanza */}\n          {step.id === \"pregnancy_info\" && (\n            <div>\n              <p className=\"text-slate-400 mb-6\">\n                Fornisci informazioni sulla tua gravidanza per un programma sicuro e personalizzato\n              </p>\n              \n              {/* Settimana di gravidanza */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium mb-3\">\n                  Settimana di gravidanza: <span className=\"text-emerald-500 font-bold\">{data.pregnancyWeek}</span>\n                </label>\n                <input\n                  type=\"range\"\n                  min=\"1\"\n                  max=\"40\"\n                  value={data.pregnancyWeek}\n                  onChange={(e) => {\n                    const week = parseInt(e.target.value);\n                    const trimester = week <= 13 ? 1 : week <= 27 ? 2 : 3;\n                    setData({ ...data, pregnancyWeek: week, pregnancyTrimester: trimester });\n                  }}\n                  className=\"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer\"\n                  data-testid=\"slider-pregnancy-week\"\n                />\n                <div className=\"flex justify-between text-xs text-slate-500 mt-1\">\n                  <span>1</span>\n                  <span>13</span>\n                  <span>27</span>\n                  <span>40</span>\n                </div>\n              </div>\n\n              {/* Trimestre (auto-calcolato) */}\n              <div className=\"mb-6 p-4 bg-slate-800 rounded-xl\">\n                <p className=\"text-sm text-slate-300\">\n                  Trimestre: <span className=\"font-bold text-emerald-500\">{data.pregnancyTrimester}¬∞</span>\n                </p>\n              </div>\n\n              {/* LEGAL DISCLAIMER */}\n              <Alert variant=\"destructive\" className=\"mb-6\">\n                <AlertTriangle className=\"h-4 w-4\" />\n                <AlertTitle>Avviso Medico Importante - Responsabilit√† Utente</AlertTitle>\n                <AlertDescription className=\"mt-2 space-y-3\">\n                  <p className=\"text-sm\">\n                    <strong>TrainSmart fornisce linee guida generali ma NON sostituisce il parere del tuo medico o ostetrica.</strong> \n                  </p>\n                  <p className=\"text-sm\">\n                    Devi consultare sempre il tuo medico prima di iniziare qualsiasi programma di allenamento durante la gravidanza. \n                    L'utente si assume piena responsabilit√† per le proprie scelte di allenamento.\n                  </p>\n                  <label className=\"flex items-start gap-3 mt-4 p-3 bg-black/30 rounded-lg cursor-pointer\">\n                    <input\n                      type=\"checkbox\"\n                      checked={data.hasReadPregnancyDisclaimer}\n                      onChange={(e) => setData({ ...data, hasReadPregnancyDisclaimer: e.target.checked })}\n                      className=\"mt-1 w-4 h-4 rounded border-red-600 text-red-600 focus:ring-red-600\"\n                      data-testid=\"checkbox-pregnancy-disclaimer\"\n                    />\n                    <span className=\"text-sm text-slate-200\">\n                      Ho letto e compreso. Confermo di aver consultato il mio medico e procedo sotto mia responsabilit√†.\n                    </span>\n                  </label>\n                </AlertDescription>\n              </Alert>\n\n              {/* Autorizzazione medica */}\n              <div className=\"mb-6\">\n                <label className=\"flex items-center gap-3 p-4 border-2 border-slate-700 rounded-xl cursor-pointer hover:border-slate-600 transition-colors\">\n                  <input\n                    type=\"checkbox\"\n                    checked={data.hasDoctorClearance}\n                    onChange={(e) => setData({ ...data, hasDoctorClearance: e.target.checked })}\n                    className=\"w-5 h-5 rounded border-slate-600 text-emerald-600 focus:ring-emerald-600 focus:ring-offset-slate-900\"\n                    data-testid=\"checkbox-doctor-clearance\"\n                  />\n                  <div className=\"flex-1\">\n                    <p className=\"font-semibold\">Ho l'autorizzazione medica per allenarmi</p>\n                    <p className=\"text-sm text-slate-400\">Richiesto per procedere</p>\n                  </div>\n                </label>\n              </div>\n\n              {/* Complicazioni (opzionale) */}\n              <div className=\"mb-6\">\n                <label className=\"block text-sm font-medium mb-3\">\n                  Eventuali complicazioni (opzionale):\n                </label>\n                <div className=\"grid grid-cols-1 gap-2\">\n                  {PREGNANCY_COMPLICATIONS.map((complication) => {\n                    const isSelected = data.pregnancyComplications.includes(complication.id);\n                    return (\n                      <button\n                        key={complication.id}\n                        onClick={() => {\n                          const updated = isSelected\n                            ? data.pregnancyComplications.filter(c => c !== complication.id)\n                            : [...data.pregnancyComplications, complication.id];\n                          setData({ ...data, pregnancyComplications: updated });\n                        }}\n                        className={`p-3 rounded-xl border-2 transition-all text-left ${\n                          isSelected\n                            ? \"border-emerald-600 bg-emerald-600/10\"\n                            : \"border-slate-700 hover:border-slate-600\"\n                        }`}\n                        data-testid={`button-complication-${complication.id}`}\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <span className=\"text-2xl\">{complication.emoji}</span>\n                          <div className=\"flex-1\">\n                            <p className=\"font-semibold text-sm\">{complication.label}</p>\n                            <p className=\"text-xs text-slate-400\">{complication.description}</p>\n                          </div>\n                        </div>\n                      </button>\n                    );\n                  })}\n                </div>\n              </div>\n\n              <div className=\"bg-amber-600/10 border border-amber-600/30 rounded-xl p-4\">\n                <p className=\"text-sm text-amber-400\">\n                  ‚ö†Ô∏è Assicurati di aver consultato il tuo medico prima di iniziare qualsiasi programma di allenamento durante la gravidanza\n                </p>\n              </div>\n            </div>\n          )}\n\n          {/* Body Weight Step */}\n          {step.id === \"bodyweight\" && (\n            <div>\n              <p className=\"text-slate-400 mb-6\">\n                Qual √® il tuo peso corporeo? (Serve per suggerire i carichi negli esercizi)\n              </p>\n              <div className=\"flex items-center gap-4 mb-6\">\n                <button\n                  onClick={() =>\n                    setData({\n                      ...data,\n                      bodyWeight: Math.max(30, data.bodyWeight - 1),\n                    })\n                  }\n                  className=\"w-12 h-12 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center justify-center text-2xl\"\n                  data-testid=\"button-bodyweight-decrease\"\n                >\n                  -\n                </button>\n                <div className=\"flex-1 text-center\">\n                  <input\n                    type=\"number\"\n                    value={data.bodyWeight}\n                    onChange={(e) => {\n                      const value = parseFloat(e.target.value) || 30;\n                      setData({\n                        ...data,\n                        bodyWeight: Math.max(30, Math.min(250, value))\n                      });\n                    }}\n                    className=\"text-5xl font-bold bg-transparent text-center w-full outline-none\"\n                    data-testid=\"input-bodyweight\"\n                  />\n                  <p className=\"text-slate-400 text-sm mt-2\">kg</p>\n                </div>\n                <button\n                  onClick={() =>\n                    setData({\n                      ...data,\n                      bodyWeight: Math.min(250, data.bodyWeight + 1),\n                    })\n                  }\n                  className=\"w-12 h-12 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center justify-center text-2xl\"\n                  data-testid=\"button-bodyweight-increase\"\n                >\n                  +\n                </button>\n              </div>\n              <div className=\"bg-blue-600/10 border border-blue-600/30 rounded-xl p-4\">\n                <p className=\"text-sm text-blue-400\">\n                  üí° Il peso verr√† usato per calcolare carichi suggeriti nel test di forza\n                </p>\n              </div>\n            </div>\n          )}\n\n          {/* Availability Step */}\n          {step.id === \"availability\" && (\n            <div>\n              <p className=\"text-slate-400 mb-6\">\n                Quanti giorni a settimana puoi allenarti?\n              </p>\n              <div className=\"flex items-center gap-4 mb-6\">\n                <button\n                  onClick={() =>\n                    setData({\n                      ...data,\n                      frequency: Math.max(2, data.frequency - 1),\n                    })\n                  }\n                  className=\"w-12 h-12 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center justify-center text-2xl\"\n                >\n                  -\n                </button>\n                <div className=\"flex-1 text-center\">\n                  <p className=\"text-5xl font-bold\">{data.frequency}</p>\n                  <p className=\"text-slate-400 text-sm mt-2\">\n                    giorni/settimana\n                  </p>\n                </div>\n                <button\n                  onClick={() =>\n                    setData({\n                      ...data,\n                      frequency: Math.min(6, data.frequency + 1),\n                    })\n                  }\n                  className=\"w-12 h-12 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center justify-center text-2xl\"\n                >\n                  +\n                </button>\n              </div>\n              <div className=\"bg-blue-600/10 border border-blue-600/30 rounded-xl p-4\">\n                <p className=\"text-sm text-blue-400\">\n                  üí° Consigliamo 3-5 giorni per risultati ottimali\n                </p>\n              </div>\n            </div>\n          )}\n\n          {/* Location Step */}\n          {step.id === \"location\" && (\n            <div className=\"space-y-4\">\n              <p className=\"text-slate-400 mb-4\">\n                Dove ti alleni principalmente?\n              </p>\n              <button\n                onClick={() => setData({ ...data, location: \"gym\", hasGym: true })}\n                className={`w-full p-6 rounded-xl border-2 transition-all ${\n                  data.location === \"gym\"\n                    ? \"border-emerald-600 bg-emerald-600/10\"\n                    : \"border-slate-700 hover:border-slate-600\"\n                }`}\n                data-testid=\"button-location-gym\"\n              >\n                <p className=\"text-2xl mb-2\">üèãÔ∏è</p>\n                <p className=\"font-semibold mb-1\">Palestra</p>\n                <p className=\"text-sm text-slate-400\">\n                  Accesso completo a bilancieri, manubri, macchine\n                </p>\n              </button>\n              <button\n                onClick={() => setData({ ...data, location: \"home\", hasGym: false })}\n                className={`w-full p-6 rounded-xl border-2 transition-all ${\n                  data.location === \"home\"\n                    ? \"border-emerald-600 bg-emerald-600/10\"\n                    : \"border-slate-700 hover:border-slate-600\"\n                }`}\n                data-testid=\"button-location-home\"\n              >\n                <p className=\"text-2xl mb-2\">üè†</p>\n                <p className=\"font-semibold mb-1\">Casa</p>\n                <p className=\"text-sm text-slate-400\">\n                  Corpo libero o attrezzatura minima\n                </p>\n              </button>\n              <button\n                onClick={() => setData({ ...data, location: \"mixed\", hasGym: true })}\n                className={`w-full p-6 rounded-xl border-2 transition-all ${\n                  data.location === \"mixed\"\n                    ? \"border-emerald-600 bg-emerald-600/10\"\n                    : \"border-slate-700 hover:border-slate-600\"\n                }`}\n                data-testid=\"button-location-mixed\"\n              >\n                <p className=\"text-2xl mb-2\">üîÄ</p>\n                <p className=\"font-semibold mb-1\">Misto</p>\n                <p className=\"text-sm text-slate-400\">\n                  Alcuni giorni palestra, altri giorni casa\n                </p>\n              </button>\n            </div>\n          )}\n\n          {/* Equipment Step - Solo per Home/Mixed */}\n          {step.id === \"equipment\" && (\n            <div className=\"space-y-4\">\n              <p className=\"text-slate-400 mb-4\">\n                Che attrezzatura hai disponibile a casa?\n              </p>\n              \n              {/* Barbell */}\n              <label className=\"flex items-center gap-3 p-4 rounded-xl border-2 border-slate-700 hover:border-slate-600 cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={data.equipment.barbell}\n                  onChange={(e) => setData({\n                    ...data,\n                    equipment: { ...data.equipment, barbell: e.target.checked }\n                  })}\n                  className=\"w-5 h-5\"\n                  data-testid=\"checkbox-equipment-barbell\"\n                />\n                <div className=\"flex-1\">\n                  <p className=\"font-semibold\">Bilanciere</p>\n                  <p className=\"text-sm text-slate-400\">Con dischi</p>\n                </div>\n              </label>\n\n              {/* Dumbbells */}\n              <div className=\"p-4 rounded-xl border-2 border-slate-700\">\n                <label className=\"block mb-2\">\n                  <span className=\"font-semibold\">Manubri fino a (kg):</span>\n                </label>\n                <input\n                  type=\"number\"\n                  value={data.equipment.dumbbellMaxKg || \"\"}\n                  onChange={(e) => setData({\n                    ...data,\n                    equipment: { ...data.equipment, dumbbellMaxKg: parseInt(e.target.value) || 0 }\n                  })}\n                  placeholder=\"0 (se non li hai)\"\n                  className=\"w-full p-3 bg-slate-800 rounded-lg\"\n                  data-testid=\"input-equipment-dumbbells\"\n                />\n              </div>\n\n              {/* Bands */}\n              <label className=\"flex items-center gap-3 p-4 rounded-xl border-2 border-slate-700 hover:border-slate-600 cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={data.equipment.bands}\n                  onChange={(e) => setData({\n                    ...data,\n                    equipment: { ...data.equipment, bands: e.target.checked }\n                  })}\n                  className=\"w-5 h-5\"\n                  data-testid=\"checkbox-equipment-bands\"\n                />\n                <div className=\"flex-1\">\n                  <p className=\"font-semibold\">Elastici</p>\n                  <p className=\"text-sm text-slate-400\">Bande di resistenza</p>\n                </div>\n              </label>\n\n              {/* Pull-up Bar */}\n              <label className=\"flex items-center gap-3 p-4 rounded-xl border-2 border-slate-700 hover:border-slate-600 cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={data.equipment.pullupBar}\n                  onChange={(e) => setData({\n                    ...data,\n                    equipment: { ...data.equipment, pullupBar: e.target.checked }\n                  })}\n                  className=\"w-5 h-5\"\n                  data-testid=\"checkbox-equipment-pullupbar\"\n                />\n                <div className=\"flex-1\">\n                  <p className=\"font-semibold\">Sbarra per trazioni</p>\n                  <p className=\"text-sm text-slate-400\">Pull-up bar</p>\n                </div>\n              </label>\n\n              {/* Bench */}\n              <label className=\"flex items-center gap-3 p-4 rounded-xl border-2 border-slate-700 hover:border-slate-600 cursor-pointer\">\n                <input\n                  type=\"checkbox\"\n                  checked={data.equipment.bench}\n                  onChange={(e) => setData({\n                    ...data,\n                    equipment: { ...data.equipment, bench: e.target.checked }\n                  })}\n                  className=\"w-5 h-5\"\n                  data-testid=\"checkbox-equipment-bench\"\n                />\n                <div className=\"flex-1\">\n                  <p className=\"font-semibold\">Panca</p>\n                  <p className=\"text-sm text-slate-400\">Bench press</p>\n                </div>\n              </label>\n\n              <div className=\"bg-blue-600/10 border border-blue-600/30 rounded-xl p-4\">\n                <p className=\"text-sm text-blue-400\">\n                  üí° Adatteremo gli esercizi in base alla tua attrezzatura\n                </p>\n              </div>\n            </div>\n          )}\n\n          {/* Injuries Step */}\n          {step.id === \"injuries\" && (\n            <div>\n              <p className=\"text-slate-400 mb-4\">\n                Hai dolori o limitazioni? (opzionale)\n              </p>\n              <div className=\"space-y-2 mb-4\">\n                {INJURY_AREAS.map((area) => (\n                  <button\n                    key={area.id}\n                    onClick={() => {\n                      const current = data.painAreas || [];\n                      setData({\n                        ...data,\n                        painAreas: current.includes(area.id)\n                          ? current.filter((a) => a !== area.id)\n                          : [...current, area.id],\n                      });\n                    }}\n                    className={`w-full p-4 rounded-xl border-2 transition-all text-left ${\n                      data.painAreas?.includes(area.id)\n                        ? \"border-amber-600 bg-amber-600/10\"\n                        : \"border-slate-700 hover:border-slate-600\"\n                    }`}\n                  >\n                    <div className=\"flex items-center gap-3\">\n                      <span className=\"text-2xl\">{area.emoji}</span>\n                      <span className=\"font-semibold\">{area.label}</span>\n                    </div>\n                  </button>\n                ))}\n              </div>\n              <div className=\"bg-amber-600/10 border border-amber-600/30 rounded-xl p-4\">\n                <p className=\"text-sm text-amber-400\">\n                  ‚ö†Ô∏è Adatteremo gli esercizi per evitare stress su queste aree\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n\n        {/* Navigation */}\n        <div className=\"flex gap-3\">\n          {currentStep > 0 && (\n            <button\n              onClick={handleBack}\n              className=\"px-6 py-3 bg-slate-800 hover:bg-slate-700 rounded-xl flex items-center gap-2\"\n            >\n              <ChevronLeft className=\"w-5 h-5\" />\n              Indietro\n            </button>\n          )}\n          <button\n            onClick={handleNext}\n            disabled={!isStepValid()}\n            className=\"flex-1 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-700 disabled:cursor-not-allowed rounded-xl font-semibold flex items-center justify-center gap-2\"\n          >\n            {currentStep === STEPS.length - 1 ? \"Completa\" : \"Avanti\"}\n            <ChevronRight className=\"w-5 h-5\" />\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":40624},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n        display: [\"var(--font-display)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4092},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"server/programGenerator.ts":{"content":"// ===== FORMULE E CALCOLI =====\n\n/**\n * Formula Brzycki per calcolo 1RM\n */\nexport function calculateOneRepMax(weight: number, reps: number): number {\n  if (reps === 1) return weight;\n  return weight * (36 / (37 - reps));\n}\n\n/**\n * Calcola il peso target da un 1RM per una specifica percentuale\n */\nexport function calculateTargetWeight(\n  oneRepMax: number,\n  percentage: number,\n): number {\n  return Math.round((oneRepMax * percentage) / 2.5) * 2.5; // arrotonda a 2.5kg\n}\n\n// ===== LOGICA GENERAZIONE PROGRAMMI =====\n\nimport { \n  getExerciseForLocation, \n  type Equipment,\n  type GiantSet \n} from './exerciseSubstitutions';\n\ninterface ProgramInput {\n  level: string; // beginner, intermediate, advanced\n  frequency: number; // giorni/settimana\n  location?: string; // gym, home, mixed\n  hasGym: boolean;\n  equipment?: Equipment;\n  painAreas: string[];\n  assessments: Array<{ exerciseName: string; oneRepMax: number }>;\n  goal: string; // weight_loss, muscle_gain, strength, endurance, toning, general, performance, disability, pregnancy\n  specificBodyParts?: string[]; // per toning e muscle_gain (chest, arms, shoulders, etc.)\n  disabilityType?: string; // tipo specifico di disabilit√† motoria\n  pregnancyWeek?: number; // settimana di gestazione (1-40)\n  pregnancyTrimester?: number; // trimestre (1, 2, 3)\n  hasDoctorClearance?: boolean; // autorizzazione medica\n  pregnancyComplications?: string[]; // complicazioni\n}\n\n// ===== MAPPATURA BODY PARTS -> ESERCIZI =====\n\n/**\n * Mappa le body parts agli esercizi prioritari per toning e muscle_gain\n */\nconst BODY_PART_EXERCISES: Record<string, string[]> = {\n  chest: ['Panca Piana', 'Panca Inclinata', 'Chest Press', 'Chest Fly', 'Push-up'],\n  arms: ['Curl bilanciere', 'French Press', 'Dips', 'Hammer Curl', 'Triceps Pushdown', 'Concentration Curl'],\n  shoulders: ['Military Press', 'Alzate laterali', 'Face Pull', 'Arnold Press', 'Shoulder Press'],\n  back_width: ['Trazioni', 'Lat Machine', 'Pull-down', 'Straight Arm Pulldown'],\n  back_thickness: ['Rematore', 'Rematore Bilanciere', 'Seal Row', 'T-Bar Row', 'Chest Supported Row'],\n  legs: ['Squat', 'Leg Press', 'Leg Extension', 'Bulgarian Split Squat', 'Hack Squat'],\n  glutes: ['Hip Thrust', 'Glute Bridge', 'Romanian Deadlift', 'Abductor Machine', 'Kickback'],\n  abs: ['Crunch', 'Cable Crunch', 'Ab Wheel', 'Hanging Leg Raise', 'Russian Twist'],\n  calves: ['Calf Raises', 'Standing Calf Raise', 'Seated Calf Raise', 'Donkey Calf Raise'],\n};\n\n/**\n * Trova esercizi aggiuntivi basati sugli obiettivi specifici\n */\nfunction getExercisesForBodyPart(bodyPart: string, level: string): string[] {\n  const exercises = BODY_PART_EXERCISES[bodyPart] || [];\n  \n  // Restituisci 1-2 esercizi in base al livello\n  if (level === 'beginner') {\n    return exercises.slice(0, 1);\n  } else if (level === 'intermediate') {\n    return exercises.slice(0, 2);\n  } else {\n    return exercises.slice(0, 2);\n  }\n}\n\n// ===== REGOLE SICUREZZA ESERCIZI =====\n\n/**\n * Esercizi controindicati per gravidanza (soprattutto post 1¬∞ trimestre)\n */\nconst PREGNANCY_UNSAFE_EXERCISES = [\n  // Addominali diretti\n  'Crunch', 'Sit-up', 'V-ups', 'Leg Raises', 'Bicycle Crunch',\n  // Supini (post 1¬∞ trimestre)\n  'Panca Piana', 'Bench Press', 'Floor Press',\n  // Carico vertebrale eccessivo\n  'Stacco', 'Deadlift', 'Romanian Deadlift', 'Good Morning',\n  // Pliometrici/impatto\n  'Box Jump', 'Burpees', 'Jump Squat', 'Jump Lunge',\n  // Rischio Valsalva\n  'Front Squat', 'Back Squat',\n];\n\n/**\n * Esercizi specifici consigliati per gravidanza per trimestre\n */\nconst PREGNANCY_SAFE_EXERCISES_BY_TRIMESTER: Record<number, {\n  recommended: string[];\n  modifications: string[];\n}> = {\n  1: {\n    recommended: [\n      'Squat (leggero)',\n      'Goblet Squat',\n      'Wall Sit',\n      'Incline Chest Press',\n      'Cable Row',\n      'Lat Pulldown',\n      'Shoulder Press (leggero)',\n      'Lateral Raise',\n      'Bicep Curl',\n      'Triceps Extension',\n      'Bird Dog',\n      'Side Plank',\n      'Pelvic Tilt',\n      'Cat-Cow',\n    ],\n    modifications: [\n      'Mantenere carichi moderati (50-60% 1RM)',\n      'Evitare Valsalva - respirare sempre',\n      'Stop immediato se dolore o pressione pelvica',\n    ],\n  },\n  2: {\n    recommended: [\n      'Goblet Squat',\n      'Wall Sit',\n      'Incline Chest Press (45¬∞)',\n      'Cable Row',\n      'Lat Pulldown',\n      'Seated Shoulder Press',\n      'Lateral Raise',\n      'Bicep Curl',\n      'Triceps Pushdown',\n      'Bird Dog',\n      'Modified Side Plank',\n      'Pelvic Tilt',\n      'Cat-Cow',\n      'Glute Bridge (elevato)',\n    ],\n    modifications: [\n      'NO esercizi supini (sostituire con inclinata 45¬∞+)',\n      'Carichi ridotti (40-50% 1RM)',\n      'Focus su stabilit√† e mobilit√†',\n      'Pause frequenti e idratazione',\n    ],\n  },\n  3: {\n    recommended: [\n      'Wall Sit (breve)',\n      'Incline Chest Press (60¬∞)',\n      'Seated Cable Row',\n      'Lat Pulldown (leggero)',\n      'Seated Shoulder Press (leggero)',\n      'Lateral Raise (leggero)',\n      'Bicep Curl',\n      'Triceps Pushdown',\n      'Bird Dog (modificato)',\n      'Wall Push-ups',\n      'Pelvic Tilt',\n      'Cat-Cow',\n      'Breathing exercises',\n    ],\n    modifications: [\n      'Carichi minimi (30-40% 1RM)',\n      'NO esercizi supini, NO addominali diretti',\n      'Priorit√†: mobilit√†, respirazione, postura',\n      'Range motion ridotto per comfort',\n      'Preparazione al parto - focus pavimento pelvico',\n    ],\n  },\n};\n\n/**\n * Esercizi adattati per disabilit√† (evitare movimenti complessi)\n */\nconst DISABILITY_COMPLEX_EXERCISES = [\n  // Movimenti complessi/tecnici\n  'Clean', 'Snatch', 'Clean & Jerk',\n  // Esercizi unilaterali instabili\n  'Bulgarian Split Squat', 'Single Leg RDL', 'Pistol Squat',\n  // Overhead instabili\n  'Overhead Squat', 'Snatch Grip Deadlift',\n];\n\n/**\n * Esercizi specifici consigliati per tipo di disabilit√†\n */\nconst DISABILITY_SPECIFIC_EXERCISES: Record<string, {\n  recommended: string[];\n  avoid: string[];\n  modifications: string[];\n}> = {\n  paraplegia: {\n    recommended: [\n      'Chest Press Machine',\n      'Shoulder Press Machine',\n      'Lat Pulldown',\n      'Seated Row',\n      'Cable Fly',\n      'Triceps Pushdown',\n      'Bicep Curl',\n      'Cable Crunch',\n    ],\n    avoid: [\n      'Squat',\n      'Deadlift',\n      'Leg Press',\n      'Lunges',\n      'Romanian Deadlift',\n      'Bulgarian Split Squat',\n      'Calf Raises',\n      'Leg Extension',\n      'Leg Curl',\n    ],\n    modifications: [\n      'Usare sempre macchine con seduta stabile',\n      'Focus su upper body e core',\n      'Evitare esercizi che richiedono equilibrio',\n    ],\n  },\n  tetraplegia: {\n    recommended: [\n      'Chest Press Machine assistito',\n      'Lat Machine con supporto',\n      'Cable exercises con assistenza',\n      'Core exercises da seduti',\n    ],\n    avoid: [\n      'Squat',\n      'Deadlift',\n      'Overhead Press',\n      'Barbell exercises',\n      'Free weights senza supervisione',\n    ],\n    modifications: [\n      'Tutto da seduti con massimo supporto',\n      'Usare macchine con cinture di sicurezza',\n      'Assistenza necessaria per tutti gli esercizi',\n    ],\n  },\n  hemiplegia: {\n    recommended: [\n      'Cable exercises unilaterali',\n      'Machine exercises',\n      'Leg Press (lato funzionale)',\n      'Chest Press Machine',\n      'Lat Pulldown',\n      'Seated Row',\n      'Core stability exercises',\n    ],\n    avoid: [\n      'Barbell Squat',\n      'Barbell Deadlift',\n      'Standing Overhead Press',\n      'Esercizi che richiedono coordinazione bilaterale',\n    ],\n    modifications: [\n      'Lavorare pi√π sul lato debole',\n      'Usare macchine per stabilit√†',\n      'Evitare bilancieri, preferire manubri/cavi',\n    ],\n  },\n  amputazione_arti_inferiori: {\n    recommended: [\n      'Chest Press',\n      'Shoulder Press',\n      'Lat Pulldown',\n      'Seated Row',\n      'Cable Fly',\n      'Leg Press (se protesi)',\n      'Core exercises da seduti',\n    ],\n    avoid: [\n      'Standing Squat',\n      'Standing Deadlift',\n      'Lunges',\n      'Bulgarian Split Squat',\n      'Standing Calf Raises',\n    ],\n    modifications: [\n      'Tutti gli esercizi upper body standard',\n      'Lower body solo se con protesi adeguata',\n      'Focus su stabilit√† del core',\n    ],\n  },\n  amputazione_arti_superiori: {\n    recommended: [\n      'Leg Press',\n      'Squat con supporto',\n      'Romanian Deadlift con trap bar',\n      'Leg Extension',\n      'Leg Curl',\n      'Cable exercises (lato funzionale)',\n      'Machine exercises unilaterali',\n    ],\n    avoid: [\n      'Barbell Bench Press',\n      'Barbell Squat',\n      'Barbell Overhead Press',\n      'Esercizi che richiedono presa bilaterale',\n    ],\n    modifications: [\n      'Usare macchine e cavi per upper body',\n      'Lower body standard se equilibrio ok',\n      'Evitare bilancieri',\n    ],\n  },\n  sclerosi_multipla: {\n    recommended: [\n      'Machine exercises',\n      'Cable exercises seduti',\n      'Leg Press',\n      'Chest Press Machine',\n      'Lat Pulldown',\n      'Seated Row',\n      'Leg Extension',\n      'Leg Curl',\n    ],\n    avoid: [\n      'Free weights complessi',\n      'Olympic lifts',\n      'Esercizi ad alta coordinazione',\n      'Deadlift',\n      'Overhead Press standing',\n    ],\n    modifications: [\n      'Privilegiare macchine guidate',\n      'Evitare affaticamento eccessivo',\n      'Adattare in base alla fatica giornaliera',\n    ],\n  },\n  distrofia_muscolare: {\n    recommended: [\n      'Machine exercises a basso carico',\n      'Cable exercises',\n      'Leg Press leggero',\n      'Chest Press Machine',\n      'Lat Pulldown',\n      'Core exercises isometrici',\n    ],\n    avoid: [\n      'Carichi pesanti',\n      'Esercizi eccentrici intensi',\n      'Deadlift',\n      'Squat pesanti',\n      'Overhead Press',\n    ],\n    modifications: [\n      'Carichi molto bassi, alto volume',\n      'Focus su mantenimento forza',\n      'Evitare progressione aggressiva',\n    ],\n  },\n  cerebral_palsy: {\n    recommended: [\n      'Machine exercises con supporto',\n      'Cable exercises seduti',\n      'Leg Press',\n      'Chest Press Machine',\n      'Lat Machine',\n      'Seated exercises',\n    ],\n    avoid: [\n      'Free weights in piedi',\n      'Esercizi instabili',\n      'Olympic lifts',\n      'Bulgarian Split Squat',\n      'Single leg exercises',\n    ],\n    modifications: [\n      'Tutto da seduti o con massimo supporto',\n      'Macchine guidate prioritarie',\n      'Focus su pattern motori semplici',\n    ],\n  },\n  altra: {\n    recommended: [\n      'Machine exercises',\n      'Cable exercises',\n      'Esercizi adattabili',\n    ],\n    avoid: [\n      'Olympic lifts',\n      'Esercizi complessi multi-articolari',\n    ],\n    modifications: [\n      'Adattare caso per caso',\n      'Consultare specialista',\n    ],\n  },\n};\n\n/**\n * Controlla se un esercizio √® sicuro per gravidanza\n */\nexport function isExerciseSafeForPregnancy(exerciseName: string): boolean {\n  return !PREGNANCY_UNSAFE_EXERCISES.some(unsafe => \n    exerciseName.toLowerCase().includes(unsafe.toLowerCase())\n  );\n}\n\n/**\n * Controlla se un esercizio √® sicuro per disabilit√† motorie\n */\nexport function isExerciseSafeForDisability(exerciseName: string, disabilityType?: string): boolean {\n  // Se abbiamo un tipo specifico di disabilit√†, usiamo la lista specifica\n  if (disabilityType && DISABILITY_SPECIFIC_EXERCISES[disabilityType]) {\n    const specificAvoid = DISABILITY_SPECIFIC_EXERCISES[disabilityType].avoid;\n    const isInAvoidList = specificAvoid.some(avoid => \n      exerciseName.toLowerCase().includes(avoid.toLowerCase())\n    );\n    if (isInAvoidList) return false;\n  }\n  \n  // Controllo generale per esercizi complessi\n  return !DISABILITY_COMPLEX_EXERCISES.some(complex => \n    exerciseName.toLowerCase().includes(complex.toLowerCase())\n  );\n}\n\n/**\n * Ottiene esercizi raccomandati per tipo di disabilit√†\n */\nexport function getRecommendedExercisesForDisability(disabilityType: string): string[] {\n  if (DISABILITY_SPECIFIC_EXERCISES[disabilityType]) {\n    return DISABILITY_SPECIFIC_EXERCISES[disabilityType].recommended;\n  }\n  return [];\n}\n\n/**\n * Ottiene modifiche/note per tipo di disabilit√†\n */\nexport function getDisabilityModifications(disabilityType: string): string[] {\n  if (DISABILITY_SPECIFIC_EXERCISES[disabilityType]) {\n    return DISABILITY_SPECIFIC_EXERCISES[disabilityType].modifications;\n  }\n  return [];\n}\n\n/**\n * Trova alternativa sicura per gravidanza\n */\nexport function getPregnancySafeAlternative(exerciseName: string): string {\n  const alternatives: Record<string, string> = {\n    'Panca Piana': 'Panca Inclinata 45¬∞',\n    'Bench Press': 'Incline Press',\n    'Floor Press': 'Standing Cable Press',\n    'Stacco': 'Hip Thrust',\n    'Deadlift': 'Goblet Squat',\n    'Romanian Deadlift': 'Cable Pull Through',\n    'Good Morning': 'Cable Pull Through',\n    'Squat': 'Goblet Squat',\n    'Front Squat': 'Goblet Squat',\n    'Back Squat': 'Goblet Squat',\n    'Crunch': 'Bird Dog',\n    'Sit-up': 'Dead Bug',\n    'V-ups': 'Dead Bug',\n    'Leg Raises': 'Side Plank',\n    'Bicycle Crunch': 'Side Plank',\n    'Box Jump': 'Step-ups',\n    'Burpees': 'Modified Burpees (no jump)',\n    'Jump Squat': 'Bodyweight Squat',\n    'Jump Lunge': 'Static Lunge',\n  };\n  \n  for (const [unsafe, safe] of Object.entries(alternatives)) {\n    if (exerciseName.toLowerCase().includes(unsafe.toLowerCase())) {\n      return safe;\n    }\n  }\n  \n  return exerciseName; // Nessuna sostituzione necessaria\n}\n\n/**\n * Trova alternativa per disabilit√†\n */\nexport function getDisabilitySafeAlternative(exerciseName: string): string {\n  const alternatives: Record<string, string> = {\n    'Bulgarian Split Squat': 'Leg Press',\n    'Single Leg RDL': 'Seated Leg Curl',\n    'Pistol Squat': 'Chair Squat',\n    'Overhead Squat': 'Goblet Squat',\n    'Snatch Grip Deadlift': 'Trap Bar Deadlift',\n    'Clean': 'Dumbbell Clean',\n    'Snatch': 'Dumbbell Snatch',\n    'Clean & Jerk': 'Push Press',\n  };\n  \n  for (const [complex, simple] of Object.entries(alternatives)) {\n    if (exerciseName.toLowerCase().includes(complex.toLowerCase())) {\n      return simple;\n    }\n  }\n  \n  return exerciseName;\n}\n\nexport function generateProgram(input: ProgramInput) {\n  const { level, frequency, location, hasGym, equipment, painAreas, assessments, goal, disabilityType } = input;\n  \n  // Normalizza specificBodyParts per retrocompatibilit√† (upper_chest ‚Üí chest)\n  const specificBodyParts = input.specificBodyParts?.map(part => \n    part === 'upper_chest' ? 'chest' : part\n  );\n\n  // Determina lo split in base alla frequenza\n  let split: string;\n  let daysPerWeek: number;\n\n  if (frequency <= 3) {\n    split = \"full_body\";\n    daysPerWeek = frequency;\n  } else if (frequency === 4) {\n    split = \"upper_lower\";\n    daysPerWeek = 4;\n  } else {\n    split = \"ppl\"; // Push Pull Legs\n    daysPerWeek = frequency;\n  }\n\n  // Determina progressione in base al livello\n  let progression: string;\n  if (level === \"beginner\") {\n    progression = \"wave_loading\"; // 2-3-4 serie\n  } else if (level === \"intermediate\") {\n    progression = \"ondulata_settimanale\";\n  } else {\n    progression = \"ondulata_giornaliera\";\n  }\n\n  // Genera schedule settimanale\n  const weeklySchedule = generateWeeklySchedule(\n    split,\n    daysPerWeek,\n    location || 'gym',\n    hasGym,\n    equipment,\n    painAreas,\n    assessments,\n    level,\n    goal,\n    specificBodyParts,\n    disabilityType,\n  );\n\n  // Determina deload e test finale\n  const includesDeload = level === \"intermediate\" || level === \"advanced\";\n  const deloadFrequency = includesDeload ? 4 : undefined;\n  const requiresEndCycleTest = goal === \"strength\" || goal === \"muscle_gain\" || goal === \"performance\";\n  \n  // Calcola durata programma\n  let totalWeeks = 4; // default\n  if (goal === \"strength\") totalWeeks = 8;\n  else if (goal === \"muscle_gain\") totalWeeks = 12;\n  else if (goal === \"performance\") totalWeeks = 8;\n  else if (goal === \"pregnancy\") totalWeeks = 4; // cicli brevi per monitoraggio\n  else if (goal === \"disability\") totalWeeks = 6;\n  \n  return {\n    name: `Programma ${split.toUpperCase()} - ${level}`,\n    description: `${daysPerWeek}x/settimana, progressione ${progression}${includesDeload ? ' (con deload ogni 4 settimane)' : ''}`,\n    split,\n    daysPerWeek,\n    weeklySchedule,\n    progression,\n    includesDeload,\n    deloadFrequency,\n    totalWeeks,\n    requiresEndCycleTest,\n  };\n}\n\nfunction generateWeeklySchedule(\n  split: string,\n  daysPerWeek: number,\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  painAreas: string[],\n  assessments: Array<{ exerciseName: string; oneRepMax: number }>,\n  level: string,\n  goal: string,\n  specificBodyParts?: string[],\n  disabilityType?: string,\n) {\n  const schedule: any[] = [];\n\n  if (split === \"full_body\") {\n    // Full Body A/B alternati\n    for (let i = 0; i < daysPerWeek; i++) {\n      const dayName = i % 2 === 0 ? \"Full Body A\" : \"Full Body B\";\n      schedule.push({\n        dayName,\n        exercises: generateFullBodyDay(\n          i % 2 === 0 ? \"A\" : \"B\",\n          location,\n          hasGym,\n          equipment,\n          painAreas,\n          assessments,\n          level,\n          goal,\n          specificBodyParts,\n          disabilityType,\n        ),\n      });\n    }\n  } else if (split === \"upper_lower\") {\n    // Upper Lower alternati\n    schedule.push(\n      {\n        dayName: \"Upper A\",\n        exercises: generateUpperDay(\"A\", location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n      },\n      {\n        dayName: \"Lower A\",\n        exercises: generateLowerDay(\"A\", location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n      },\n      {\n        dayName: \"Upper B\",\n        exercises: generateUpperDay(\"B\", location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n      },\n      {\n        dayName: \"Lower B\",\n        exercises: generateLowerDay(\"B\", location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n      },\n    );\n  } else {\n    // PPL\n    schedule.push(\n      {\n        dayName: \"Push\",\n        exercises: generatePushDay(location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n      },\n      {\n        dayName: \"Pull\",\n        exercises: generatePullDay(location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n      },\n      {\n        dayName: \"Legs\",\n        exercises: generateLegsDay(location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n      },\n    );\n    if (daysPerWeek >= 6) {\n      schedule.push(\n        {\n          dayName: \"Push B\",\n          exercises: generatePushDay(location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n        },\n        {\n          dayName: \"Pull B\",\n          exercises: generatePullDay(location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n        },\n        {\n          dayName: \"Legs B\",\n          exercises: generateLegsDay(location, hasGym, equipment, painAreas, assessments, level, goal, specificBodyParts, disabilityType),\n        },\n      );\n    }\n  }\n\n  return schedule;\n}\n\n// ===== GENERATORI SPECIFICI PER TIPO ALLENAMENTO =====\n\nfunction generateFullBodyDay(\n  variant: \"A\" | \"B\",\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  painAreas: string[],\n  assessments: any[],\n  level: string,\n  goal: string,\n  specificBodyParts?: string[],\n  disabilityType?: string,\n) {\n  const exercises: any[] = [];\n  const baseLoad = getBaseLoads(assessments);\n\n  // Helper per applicare sostituzioni di sicurezza\n  const safeExercise = (name: string) => {\n    if (goal === 'pregnancy') {\n      return isExerciseSafeForPregnancy(name) ? name : getPregnancySafeAlternative(name);\n    } else if (goal === 'disability') {\n      return isExerciseSafeForDisability(name, disabilityType) ? name : getDisabilitySafeAlternative(name);\n    }\n    return name;\n  };\n\n  // Squat pattern\n  if (!painAreas.includes(\"knee\") && !painAreas.includes(\"lower_back\")) {\n    const squat = safeExercise(\"Squat\");\n    exercises.push(\n      createExercise(squat, location, hasGym, equipment, baseLoad.squat, level, goal, \"compound\"),\n    );\n  } else {\n    exercises.push(\n      createExercise(\n        \"Leg Press\",\n        location,\n        hasGym,\n        equipment,\n        baseLoad.squat * 1.3,\n        level,\n        goal,\n        \"compound\",\n      ),\n    );\n  }\n\n  // Hip hinge\n  if (!painAreas.includes(\"lower_back\")) {\n    const hinge = safeExercise(variant === \"A\" ? \"Stacco\" : \"Romanian Deadlift\");\n    exercises.push(\n      createExercise(\n        hinge,\n        location,\n        hasGym,\n        equipment,\n        baseLoad.deadlift,\n        level,\n        goal,\n        \"compound\",\n      ),\n    );\n  }\n\n  // Push horizontal\n  if (!painAreas.includes(\"shoulder\")) {\n    const push = safeExercise(variant === \"A\" ? \"Panca Piana\" : \"Panca Inclinata\");\n    exercises.push(\n      createExercise(\n        push,\n        location,\n        hasGym,\n        equipment,\n        baseLoad.bench,\n        level,\n        goal,\n        \"compound\",\n      ),\n    );\n  }\n\n  // Pull horizontal/vertical\n  exercises.push(\n    createExercise(\n      variant === \"A\" ? \"Trazioni\" : \"Rematore\",\n      location,\n      hasGym,\n      equipment,\n      baseLoad.pull,\n      level,\n      goal,\n      \"compound\",\n    ),\n  );\n\n  // Spalle\n  if (!painAreas.includes(\"shoulder\")) {\n    exercises.push(\n      createExercise(\n        \"Military Press\",\n        location,\n        hasGym,\n        equipment,\n        baseLoad.press,\n        level,\n        goal,\n        \"accessory\",\n      ),\n    );\n  }\n\n  // Core - Sostituzioni speciali per gravidanza\n  const coreExercise = goal === 'pregnancy' ? 'Bird Dog' : 'Plank';\n  exercises.push(createExercise(coreExercise, location, hasGym, equipment, 0, level, goal, \"core\"));\n\n  // ESERCIZI EXTRA per obiettivi specifici (toning/muscle_gain)\n  if (specificBodyParts && specificBodyParts.length > 0) {\n    // Raccogli nomi esercizi gi√† presenti per evitare duplicati\n    const existingExercises = new Set(exercises.map(ex => ex.name?.toLowerCase()));\n    \n    specificBodyParts.forEach(bodyPart => {\n      // Full body pu√≤ targetizzare qualsiasi parte\n      const extraExercises = getExercisesForBodyPart(bodyPart, level);\n      extraExercises.forEach(ex => {\n        // Controllo duplicati\n        if (existingExercises.has(ex.toLowerCase())) return;\n        \n        // Controllo sicurezza\n        let safeEx = ex;\n        if (goal === 'pregnancy' && !isExerciseSafeForPregnancy(ex)) {\n          safeEx = getPregnancySafeAlternative(ex);\n        } else if (goal === 'disability' && !isExerciseSafeForDisability(ex, disabilityType)) {\n          safeEx = getDisabilitySafeAlternative(ex);\n        }\n        \n        // Controllo pain areas\n        const shouldSkip = painAreas.some(area => {\n          if (area === 'knee' && (safeEx.toLowerCase().includes('squat') || safeEx.toLowerCase().includes('lunge'))) return true;\n          if (area === 'shoulder' && safeEx.toLowerCase().includes('press')) return true;\n          if (area === 'lower_back' && safeEx.toLowerCase().includes('deadlift')) return true;\n          return false;\n        });\n        \n        if (!shouldSkip && !existingExercises.has(safeEx.toLowerCase())) {\n          exercises.push(\n            createExercise(safeEx, location, hasGym, equipment, 0, level, goal, \"isolation\")\n          );\n          existingExercises.add(safeEx.toLowerCase());\n        }\n      });\n    });\n  }\n\n  return exercises;\n}\n\nfunction generateUpperDay(\n  variant: \"A\" | \"B\",\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  painAreas: string[],\n  assessments: any[],\n  level: string,\n  goal: string,\n  specificBodyParts?: string[],\n  disabilityType?: string,\n) {\n  const exercises: any[] = [];\n  const baseLoad = getBaseLoads(assessments);\n\n  // Helper per applicare sostituzioni di sicurezza\n  const safeExercise = (name: string) => {\n    if (goal === 'pregnancy') {\n      return isExerciseSafeForPregnancy(name) ? name : getPregnancySafeAlternative(name);\n    } else if (goal === 'disability') {\n      return isExerciseSafeForDisability(name, disabilityType) ? name : getDisabilitySafeAlternative(name);\n    }\n    return name;\n  };\n\n  // Pattern principale\n  if (variant === \"A\") {\n    const bench = safeExercise(\"Panca Piana\");\n    exercises.push(\n      createExercise(bench, location, hasGym, equipment, baseLoad.bench, level, goal, \"compound\"),\n    );\n    exercises.push(\n      createExercise(\"Trazioni\", location, hasGym, equipment, baseLoad.pull, level, goal, \"compound\"),\n    );\n  } else {\n    const incline = safeExercise(\"Panca Inclinata\");\n    exercises.push(\n      createExercise(\n        incline,\n        location,\n        hasGym,\n        equipment,\n        baseLoad.bench * 0.85,\n        level,\n        goal,\n        \"compound\",\n      ),\n    );\n    exercises.push(\n      createExercise(\n        \"Rematore Bilanciere\",\n        location,\n        hasGym,\n        equipment,\n        baseLoad.pull * 0.9,\n        level,\n        goal,\n        \"compound\",\n      ),\n    );\n  }\n\n  // Spalle\n  exercises.push(\n    createExercise(\n      \"Military Press\",\n      location,\n      hasGym,\n      equipment,\n      baseLoad.press,\n      level,\n      goal,\n      \"accessory\",\n    ),\n  );\n\n  // Isolamento\n  exercises.push(\n    createExercise(\n      variant === \"A\" ? \"Curl bilanciere\" : \"French Press\",\n      location,\n      hasGym,\n      equipment,\n      0,\n      level,\n      goal,\n      \"isolation\",\n    ),\n  );\n\n  // ESERCIZI EXTRA per obiettivi specifici (toning/muscle_gain)\n  if (specificBodyParts && specificBodyParts.length > 0) {\n    const existingExercises = new Set(exercises.map(ex => ex.name?.toLowerCase()));\n    \n    specificBodyParts.forEach(bodyPart => {\n      // Upper day: chest, arms, shoulders, back_width, back_thickness\n      if (['chest', 'arms', 'shoulders', 'back_width', 'back_thickness'].includes(bodyPart)) {\n        const extraExercises = getExercisesForBodyPart(bodyPart, level);\n        extraExercises.forEach(ex => {\n          if (existingExercises.has(ex.toLowerCase())) return;\n          \n          let safeEx = ex;\n          if (goal === 'pregnancy' && !isExerciseSafeForPregnancy(ex)) {\n            safeEx = getPregnancySafeAlternative(ex);\n          } else if (goal === 'disability' && !isExerciseSafeForDisability(ex, disabilityType)) {\n            safeEx = getDisabilitySafeAlternative(ex);\n          }\n          \n          const shouldSkip = painAreas.some(area => {\n            if (area === 'shoulder' && safeEx.toLowerCase().includes('press')) return true;\n            return false;\n          });\n          \n          if (!shouldSkip && !existingExercises.has(safeEx.toLowerCase())) {\n            exercises.push(\n              createExercise(safeEx, location, hasGym, equipment, 0, level, goal, \"isolation\")\n            );\n            existingExercises.add(safeEx.toLowerCase());\n          }\n        });\n      }\n    });\n  }\n\n  return exercises;\n}\n\nfunction generateLowerDay(\n  variant: \"A\" | \"B\",\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  painAreas: string[],\n  assessments: any[],\n  level: string,\n  goal: string,\n  specificBodyParts?: string[],\n  disabilityType?: string,\n) {\n  const exercises: any[] = [];\n  const baseLoad = getBaseLoads(assessments);\n\n  // Helper per applicare sostituzioni di sicurezza\n  const safeExercise = (name: string) => {\n    if (goal === 'pregnancy') {\n      return isExerciseSafeForPregnancy(name) ? name : getPregnancySafeAlternative(name);\n    } else if (goal === 'disability') {\n      return isExerciseSafeForDisability(name, disabilityType) ? name : getDisabilitySafeAlternative(name);\n    }\n    return name;\n  };\n\n  if (variant === \"A\") {\n    const squat = safeExercise(\"Squat\");\n    exercises.push(\n      createExercise(squat, location, hasGym, equipment, baseLoad.squat, level, goal, \"compound\"),\n    );\n    const rdl = safeExercise(\"Romanian Deadlift\");\n    exercises.push(\n      createExercise(\n        rdl,\n        location,\n        hasGym,\n        equipment,\n        baseLoad.deadlift * 0.7,\n        level,\n        goal,\n        \"compound\",\n      ),\n    );\n  } else {\n    const frontSquat = safeExercise(\"Front Squat\");\n    exercises.push(\n      createExercise(\n        frontSquat,\n        location,\n        hasGym,\n        equipment,\n        baseLoad.squat * 0.8,\n        level,\n        goal,\n        \"compound\",\n      ),\n    );\n    const deadlift = safeExercise(\"Stacco\");\n    exercises.push(\n      createExercise(deadlift, location, hasGym, equipment, baseLoad.deadlift, level, goal, \"compound\"),\n    );\n  }\n\n  exercises.push(createExercise(\"Leg Curl\", location, hasGym, equipment, 0, level, goal, \"isolation\"));\n  \n  // Calf Raises solo se non ci sono problemi alle caviglie\n  if (!painAreas.includes(\"ankles\")) {\n    exercises.push(createExercise(\"Calf Raises\", location, hasGym, equipment, 0, level, goal, \"isolation\"));\n  }\n\n  // ESERCIZI EXTRA per obiettivi specifici (toning/muscle_gain)\n  if (specificBodyParts && specificBodyParts.length > 0) {\n    const existingExercises = new Set(exercises.map(ex => ex.name?.toLowerCase()));\n    \n    specificBodyParts.forEach(bodyPart => {\n      // Lower day: legs, glutes, calves, abs\n      if (['legs', 'glutes', 'calves', 'abs'].includes(bodyPart)) {\n        const extraExercises = getExercisesForBodyPart(bodyPart, level);\n        extraExercises.forEach(ex => {\n          if (existingExercises.has(ex.toLowerCase())) return;\n          \n          let safeEx = ex;\n          if (goal === 'pregnancy' && !isExerciseSafeForPregnancy(ex)) {\n            safeEx = getPregnancySafeAlternative(ex);\n          } else if (goal === 'disability' && !isExerciseSafeForDisability(ex, disabilityType)) {\n            safeEx = getDisabilitySafeAlternative(ex);\n          }\n          \n          const shouldSkip = painAreas.some(area => {\n            if (area === 'knee' && (safeEx.toLowerCase().includes('squat') || safeEx.toLowerCase().includes('lunge'))) return true;\n            if (area === 'lower_back' && safeEx.toLowerCase().includes('deadlift')) return true;\n            if (area === 'ankles' && (safeEx.toLowerCase().includes('calf') || safeEx.toLowerCase().includes('jump'))) return true;\n            return false;\n          });\n          \n          if (!shouldSkip && !existingExercises.has(safeEx.toLowerCase())) {\n            exercises.push(\n              createExercise(safeEx, location, hasGym, equipment, 0, level, goal, \"isolation\")\n            );\n            existingExercises.add(safeEx.toLowerCase());\n          }\n        });\n      }\n    });\n  }\n\n  return exercises;\n}\n\nfunction generatePushDay(\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  painAreas: string[],\n  assessments: any[],\n  level: string,\n  goal: string,\n  specificBodyParts?: string[],\n  disabilityType?: string,\n) {\n  const exercises: any[] = [];\n  const baseLoad = getBaseLoads(assessments);\n\n  // Helper per applicare sostituzioni di sicurezza\n  const safeExercise = (name: string) => {\n    if (goal === 'pregnancy') {\n      return isExerciseSafeForPregnancy(name) ? name : getPregnancySafeAlternative(name);\n    } else if (goal === 'disability') {\n      return isExerciseSafeForDisability(name, disabilityType) ? name : getDisabilitySafeAlternative(name);\n    }\n    return name;\n  };\n\n  const bench = safeExercise(\"Panca Piana\");\n  exercises.push(\n    createExercise(bench, location, hasGym, equipment, baseLoad.bench, level, goal, \"compound\"),\n  );\n  exercises.push(\n    createExercise(\"Military Press\", location, hasGym, equipment, baseLoad.press, level, goal, \"compound\"),\n  );\n  exercises.push(createExercise(\"Dips\", location, hasGym, equipment, 0, level, goal, \"compound\"));\n  exercises.push(\n    createExercise(\"Croci manubri\", location, hasGym, equipment, 0, level, goal, \"isolation\"),\n  );\n  exercises.push(createExercise(\"French Press\", location, hasGym, equipment, 0, level, goal, \"isolation\"));\n\n  // ESERCIZI EXTRA per obiettivi specifici (toning/muscle_gain)\n  if (specificBodyParts && specificBodyParts.length > 0) {\n    const existingExercises = new Set(exercises.map(ex => ex.name?.toLowerCase()));\n    \n    specificBodyParts.forEach(bodyPart => {\n      // Push day: chest, arms, shoulders\n      if (['chest', 'arms', 'shoulders'].includes(bodyPart)) {\n        const extraExercises = getExercisesForBodyPart(bodyPart, level);\n        extraExercises.forEach(ex => {\n          if (existingExercises.has(ex.toLowerCase())) return;\n          \n          let safeEx = ex;\n          if (goal === 'pregnancy' && !isExerciseSafeForPregnancy(ex)) {\n            safeEx = getPregnancySafeAlternative(ex);\n          } else if (goal === 'disability' && !isExerciseSafeForDisability(ex, disabilityType)) {\n            safeEx = getDisabilitySafeAlternative(ex);\n          }\n          \n          const shouldSkip = painAreas.some(area => {\n            if (area === 'shoulder' && safeEx.toLowerCase().includes('press')) return true;\n            return false;\n          });\n          \n          if (!shouldSkip && !existingExercises.has(safeEx.toLowerCase())) {\n            exercises.push(\n              createExercise(safeEx, location, hasGym, equipment, 0, level, goal, \"isolation\")\n            );\n            existingExercises.add(safeEx.toLowerCase());\n          }\n        });\n      }\n    });\n  }\n\n  return exercises;\n}\n\nfunction generatePullDay(\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  painAreas: string[],\n  assessments: any[],\n  level: string,\n  goal: string,\n  specificBodyParts?: string[],\n  disabilityType?: string,\n) {\n  const exercises: any[] = [];\n  const baseLoad = getBaseLoads(assessments);\n\n  // Helper per applicare sostituzioni di sicurezza\n  const safeExercise = (name: string) => {\n    if (goal === 'pregnancy') {\n      return isExerciseSafeForPregnancy(name) ? name : getPregnancySafeAlternative(name);\n    } else if (goal === 'disability') {\n      return isExerciseSafeForDisability(name, disabilityType) ? name : getDisabilitySafeAlternative(name);\n    }\n    return name;\n  };\n\n  const deadlift = safeExercise(\"Stacco\");\n  exercises.push(\n    createExercise(deadlift, location, hasGym, equipment, baseLoad.deadlift, level, goal, \"compound\"),\n  );\n  const pullup = safeExercise(\"Trazioni\");\n  exercises.push(\n    createExercise(pullup, location, hasGym, equipment, baseLoad.pull, level, goal, \"compound\"),\n  );\n  const row = safeExercise(\"Rematore Bilanciere\");\n  exercises.push(\n    createExercise(\n      row,\n      location,\n      hasGym,\n      equipment,\n      baseLoad.pull * 0.9,\n      level,\n      goal,\n      \"compound\",\n    ),\n  );\n  const curl = safeExercise(\"Curl bilanciere\");\n  exercises.push(\n    createExercise(curl, location, hasGym, equipment, 0, level, goal, \"isolation\"),\n  );\n  const facePull = safeExercise(\"Face Pull\");\n  exercises.push(createExercise(facePull, location, hasGym, equipment, 0, level, goal, \"isolation\"));\n\n  // ESERCIZI EXTRA per obiettivi specifici (toning/muscle_gain)\n  if (specificBodyParts && specificBodyParts.length > 0) {\n    const existingExercises = new Set(exercises.map(ex => ex.name?.toLowerCase()));\n    \n    specificBodyParts.forEach(bodyPart => {\n      // Pull day: back_width, back_thickness, arms\n      if (['back_width', 'back_thickness', 'arms'].includes(bodyPart)) {\n        const extraExercises = getExercisesForBodyPart(bodyPart, level);\n        extraExercises.forEach(ex => {\n          if (existingExercises.has(ex.toLowerCase())) return;\n          \n          let safeEx = ex;\n          if (goal === 'pregnancy' && !isExerciseSafeForPregnancy(ex)) {\n            safeEx = getPregnancySafeAlternative(ex);\n          } else if (goal === 'disability' && !isExerciseSafeForDisability(ex, disabilityType)) {\n            safeEx = getDisabilitySafeAlternative(ex);\n          }\n          \n          // Controllo pain areas\n          const shouldSkip = painAreas.some(area => {\n            if (area === 'shoulder' && safeEx.toLowerCase().includes('press')) return true;\n            if (area === 'lower_back' && (safeEx.toLowerCase().includes('deadlift') || safeEx.toLowerCase().includes('row'))) return true;\n            return false;\n          });\n          \n          if (!shouldSkip && !existingExercises.has(safeEx.toLowerCase())) {\n            exercises.push(\n              createExercise(safeEx, location, hasGym, equipment, 0, level, goal, \"isolation\")\n            );\n            existingExercises.add(safeEx.toLowerCase());\n          }\n        });\n      }\n    });\n  }\n\n  return exercises;\n}\n\nfunction generateLegsDay(\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  painAreas: string[],\n  assessments: any[],\n  level: string,\n  goal: string,\n  specificBodyParts?: string[],\n  disabilityType?: string,\n) {\n  const exercises: any[] = [];\n  const baseLoad = getBaseLoads(assessments);\n\n  // Helper per applicare sostituzioni di sicurezza\n  const safeExercise = (name: string) => {\n    if (goal === 'pregnancy') {\n      return isExerciseSafeForPregnancy(name) ? name : getPregnancySafeAlternative(name);\n    } else if (goal === 'disability') {\n      return isExerciseSafeForDisability(name, disabilityType) ? name : getDisabilitySafeAlternative(name);\n    }\n    return name;\n  };\n\n  const squat = safeExercise(\"Squat\");\n  exercises.push(\n    createExercise(squat, location, hasGym, equipment, baseLoad.squat, level, goal, \"compound\"),\n  );\n  const legPress = safeExercise(\"Leg Press\");\n  exercises.push(\n    createExercise(\n      legPress,\n      location,\n      hasGym,\n      equipment,\n      baseLoad.squat * 1.5,\n      level,\n      goal,\n      \"compound\",\n    ),\n  );\n  const rdl = safeExercise(\"Romanian Deadlift\");\n  exercises.push(\n    createExercise(\n      rdl,\n      location,\n      hasGym,\n      equipment,\n      baseLoad.deadlift * 0.7,\n      level,\n      goal,\n      \"compound\",\n    ),\n  );\n  exercises.push(createExercise(\"Leg Curl\", location, hasGym, equipment, 0, level, goal, \"isolation\"));\n  exercises.push(\n    createExercise(\"Leg Extension\", location, hasGym, equipment, 0, level, goal, \"isolation\"),\n  );\n\n  // ESERCIZI EXTRA per obiettivi specifici (toning/muscle_gain)\n  if (specificBodyParts && specificBodyParts.length > 0) {\n    const existingExercises = new Set(exercises.map(ex => ex.name?.toLowerCase()));\n    \n    specificBodyParts.forEach(bodyPart => {\n      // Legs day: legs, glutes, calves, abs\n      if (['legs', 'glutes', 'calves', 'abs'].includes(bodyPart)) {\n        const extraExercises = getExercisesForBodyPart(bodyPart, level);\n        extraExercises.forEach(ex => {\n          if (existingExercises.has(ex.toLowerCase())) return;\n          \n          let safeEx = ex;\n          if (goal === 'pregnancy' && !isExerciseSafeForPregnancy(ex)) {\n            safeEx = getPregnancySafeAlternative(ex);\n          } else if (goal === 'disability' && !isExerciseSafeForDisability(ex, disabilityType)) {\n            safeEx = getDisabilitySafeAlternative(ex);\n          }\n          \n          const shouldSkip = painAreas.some(area => {\n            if (area === 'knee' && (safeEx.toLowerCase().includes('squat') || safeEx.toLowerCase().includes('lunge'))) return true;\n            if (area === 'lower_back' && safeEx.toLowerCase().includes('deadlift')) return true;\n            if (area === 'ankles' && (safeEx.toLowerCase().includes('calf') || safeEx.toLowerCase().includes('jump'))) return true;\n            return false;\n          });\n          \n          if (!shouldSkip && !existingExercises.has(safeEx.toLowerCase())) {\n            exercises.push(\n              createExercise(safeEx, location, hasGym, equipment, 0, level, goal, \"isolation\")\n            );\n            existingExercises.add(safeEx.toLowerCase());\n          }\n        });\n      }\n    });\n  }\n\n  return exercises;\n}\n\n// ===== HELPERS =====\n\nfunction createExercise(\n  name: string,\n  location: string,\n  hasGym: boolean,\n  equipment: Equipment | undefined,\n  baseWeight: number,\n  level: string,\n  goal: string,\n  type: \"compound\" | \"accessory\" | \"isolation\" | \"core\",\n) {\n  let sets, reps, rest;\n\n  // Serie in base al livello (wave loading per beginner)\n  if (level === \"beginner\") {\n    sets = type === \"compound\" ? 3 : 2;\n  } else if (level === \"intermediate\") {\n    sets = type === \"compound\" ? 4 : 3;\n  } else {\n    sets = type === \"compound\" ? 5 : 3;\n  }\n\n  // Ripetizioni in base al tipo\n  if (type === \"compound\") {\n    reps = \"5-8\";\n  } else if (type === \"accessory\") {\n    reps = \"8-12\";\n  } else if (type === \"isolation\") {\n    reps = \"12-15\";\n  } else {\n    reps = \"30-60s\";\n  }\n\n  // Recupero\n  if (type === \"compound\") {\n    rest = 180;\n  } else if (type === \"accessory\") {\n    rest = 120;\n  } else {\n    rest = 60;\n  }\n\n  // Usa nuovo sistema sostituzioni con giant sets\n  const exerciseOrGiantSet = getExerciseForLocation(name, location as 'gym' | 'home' | 'mixed', equipment, goal, level);\n\n  // SICUREZZA: NON usare Giant Sets per pregnancy/disability (contengono esercizi non sicuri)\n  if (typeof exerciseOrGiantSet !== 'string') {\n    if (goal === 'pregnancy' || goal === 'disability') {\n      // Usa alternativa sicura invece del Giant Set\n      const safeAlternative = goal === 'pregnancy' \n        ? getPregnancySafeAlternative(name) \n        : getDisabilitySafeAlternative(name);\n      \n      return {\n        name: safeAlternative,\n        sets,\n        reps,\n        rest,\n        weight: baseWeight > 0 ? calculateTargetWeight(baseWeight, 0.7) : null,\n        notes: `‚ö†Ô∏è Esercizio adattato per sicurezza (${goal === 'pregnancy' ? 'gravidanza' : 'disabilit√†'})`,\n      };\n    }\n    return exerciseOrGiantSet; // √à un GiantSet (solo per altri goal)\n  }\n\n  return {\n    name: exerciseOrGiantSet,\n    sets,\n    reps,\n    rest,\n    weight: baseWeight > 0 ? calculateTargetWeight(baseWeight, 0.7) : null,\n    notes:\n      type === \"compound\"\n        ? \"Esercizio fondamentale\"\n        : \"Esercizio complementare\",\n  };\n}\n\nfunction getBaseLoads(assessments: any[]) {\n  const findLoad = (exercise: string) => {\n    const assessment = assessments.find((a) =>\n      a.exerciseName.toLowerCase().includes(exercise.toLowerCase()),\n    );\n    return assessment ? assessment.oneRepMax : 50; // default 50kg\n  };\n\n  return {\n    squat: findLoad(\"squat\"),\n    deadlift: findLoad(\"stacco\"),\n    bench: findLoad(\"panca\"),\n    pull: findLoad(\"trazioni\") || findLoad(\"pull\"),\n    press: findLoad(\"press\") || findLoad(\"spalle\"),\n  };\n}\n\nfunction getHomeAlternative(exercise: string): string {\n  const alternatives: Record<string, string> = {\n    Squat: \"Squat a corpo libero\",\n    \"Panca Piana\": \"Push-up\",\n    Stacco: \"Single Leg Deadlift\",\n    Trazioni: \"Australian Pull-up\",\n    \"Military Press\": \"Pike Push-up\",\n    \"Leg Press\": \"Bulgarian Split Squat\",\n    \"Leg Curl\": \"Nordic Curl\",\n    \"Rematore Bilanciere\": \"Inverted Row\",\n  };\n\n  return alternatives[exercise] || exercise;\n}\n\n// ===== PAIN MANAGEMENT =====\n\nexport function analyzePainPersistence(workouts: any[]) {\n  const painAreas: Record<string, number> = {};\n\n  workouts.forEach((w) => {\n    if (w.painLevel && w.painLevel > 3 && w.painLocation) {\n      painAreas[w.painLocation] = (painAreas[w.painLocation] || 0) + 1;\n    }\n  });\n\n  const persistentPain = Object.entries(painAreas)\n    .filter(([_, count]) => count >= 3)\n    .map(([location, _]) => location);\n\n  return {\n    hasPersistentPain: persistentPain.length > 0,\n    persistentAreas: persistentPain,\n  };\n}\n\n// ===== WORKOUT ADAPTATION =====\n\n/**\n * Rigenera gli esercizi di un giorno con una nuova location\n * Usato per adattare al volo un workout (es. da palestra a casa)\n */\nexport async function generateExercisesForDay(params: {\n  dayName: string;\n  originalExercises: any[];\n  location: string;\n  equipment: Equipment;\n  painAreas: string[];\n  assessments: Array<{ exerciseName: string; oneRepMax: number }>;\n  level: string;\n  goal: string;\n  specificBodyParts?: string[];\n  disabilityType?: string;\n}) {\n  const {\n    originalExercises,\n    location,\n    equipment,\n    assessments,\n    level,\n    goal,\n    disabilityType,\n  } = params;\n  \n  // Normalizza specificBodyParts per retrocompatibilit√† (upper_chest ‚Üí chest)\n  const specificBodyParts = params.specificBodyParts?.map(part => \n    part === 'upper_chest' ? 'chest' : part\n  );\n\n  const adaptedExercises: any[] = [];\n  const baseLoad = getBaseLoads(assessments);\n\n  // Helper per applicare sostituzioni di sicurezza\n  const safeExercise = (name: string) => {\n    if (goal === 'pregnancy') {\n      return isExerciseSafeForPregnancy(name) ? name : getPregnancySafeAlternative(name);\n    } else if (goal === 'disability') {\n      return isExerciseSafeForDisability(name, disabilityType) ? name : getDisabilitySafeAlternative(name);\n    }\n    return name;\n  };\n\n  // Per ogni esercizio originale, genera la variante adattata\n  for (const originalExercise of originalExercises) {\n    // Se √® gi√† un Giant Set, mantienilo (non possiamo adattare un giant set)\n    if (originalExercise.type === 'giant_set') {\n      adaptedExercises.push(originalExercise);\n      continue;\n    }\n\n    const exerciseName = originalExercise.name;\n    const safeExerciseName = safeExercise(exerciseName);\n    \n    // Trova il peso base per questo esercizio\n    let baseWeight = 0;\n    const exerciseKey = getExerciseKeyForLoad(safeExerciseName);\n    if (exerciseKey && exerciseKey in baseLoad) {\n      baseWeight = baseLoad[exerciseKey as keyof typeof baseLoad];\n    }\n\n    // Usa createExercise per generare l'esercizio adattato\n    const exerciseType = originalExercise.reps && parseInt(originalExercise.reps) <= 8 \n      ? 'compound' \n      : originalExercise.reps && parseInt(originalExercise.reps) <= 12\n      ? 'accessory'\n      : 'isolation';\n\n    // Calcola hasEquipment: true se palestra OPPURE se casa con almeno un attrezzo\n    const hasEquipmentCheck = location === 'gym' || (\n      equipment.barbell ||\n      equipment.bands ||\n      equipment.pullupBar ||\n      equipment.bench ||\n      (equipment.dumbbellMaxKg && equipment.dumbbellMaxKg > 0)\n    );\n    const hasEquipment: boolean = Boolean(hasEquipmentCheck);\n\n    const adaptedExercise = createExercise(\n      safeExerciseName,\n      location,\n      hasEquipment,\n      equipment,\n      baseWeight,\n      level,\n      goal,\n      exerciseType\n    );\n\n    adaptedExercises.push(adaptedExercise);\n  }\n\n  return adaptedExercises;\n}\n\n/**\n * Helper per mappare nome esercizio a chiave per baseLoad\n */\nfunction getExerciseKeyForLoad(exerciseName: string): string | null {\n  const name = exerciseName.toLowerCase();\n  if (name.includes('squat')) return 'squat';\n  if (name.includes('stacco') || name.includes('deadlift')) return 'deadlift';\n  if (name.includes('panca') || name.includes('bench') || name.includes('push')) return 'bench';\n  if (name.includes('traz') || name.includes('pull') || name.includes('lat') || name.includes('rematore')) return 'pull';\n  if (name.includes('press') || name.includes('military') || name.includes('shoulder')) return 'press';\n  return null;\n}\n\nexport function checkRecoveryFromPain(workouts: any[]) {\n  const lastThree = workouts.slice(0, 3);\n  const noPainSessions = lastThree.filter(\n    (w) => !w.painLevel || w.painLevel <= 2,\n  );\n\n  return {\n    canReturnToNormal: noPainSessions.length === 3,\n    painFreeSessions: noPainSessions.length,\n  };\n}\n\n// ===== DETRAINING E RECALIBRAZIONE =====\n\nexport function calculateDetrainingFactor(workouts: any[]) {\n  if (workouts.length === 0) return 0.7; // default 30% riduzione\n\n  const lastWorkout = workouts[0];\n  const daysSinceLastWorkout = lastWorkout.completedAt\n    ? Math.floor(\n        (Date.now() - new Date(lastWorkout.completedAt).getTime()) /\n          (1000 * 60 * 60 * 24),\n      )\n    : 0;\n\n  if (daysSinceLastWorkout < 7) return 1.0; // nessuna riduzione\n  if (daysSinceLastWorkout < 14) return 0.95; // -5%\n  if (daysSinceLastWorkout < 21) return 0.9; // -10%\n  if (daysSinceLastWorkout < 30) return 0.85; // -15%\n  return 0.7; // -30% oltre 1 mese\n}\n\nexport function recalibrateProgram(\n  assessments: any[],\n  detrainingFactor: number,\n) {\n  return assessments.map((a) => ({\n    exerciseName: a.exerciseName,\n    oneRepMax: a.oneRepMax * detrainingFactor,\n  }));\n}\n","size_bytes":48407},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/examples/Hero.tsx":{"content":"import Hero from '../Hero';\n\nexport default function HeroExample() {\n  return <Hero />;\n}\n","size_bytes":90},"client/src/components/examples/ScreeningFlow.tsx":{"content":"import ScreeningFlow from '../ScreeningFlow';\n\nexport default function ScreeningFlowExample() {\n  return <ScreeningFlow />;\n}\n","size_bytes":126},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"CODICE_PER_CLAUDE.md":{"content":"# TrainSmart - Codice Completo per Claude\n\n## üìã Stato Attuale\n\n### ‚úÖ Implementato\n1. **Autenticazione Replit** - Login/Logout funzionanti\n2. **Database PostgreSQL** - Configurato con Drizzle ORM\n3. **UI Dark Mode** - Design completo con componenti Landing, Dashboard, Header\n4. **Schema Database Base** - Tabelle `users` e `sessions`\n\n### ‚ùå Da Implementare\n1. Schema fitness (screening, quiz, assessment, workouts, payments)\n2. API routes per fitness logic\n3. Logica generazione programmi (formule Brzycki)\n4. Sistema pagamenti PayPal/Stripe\n\n---\n\n## üìÅ File Principali\n\n### 1. shared/schema.ts (Attuale - Solo Auth)\n```typescript\nimport { sql } from \"drizzle-orm\";\nimport { pgTable, varchar, timestamp, jsonb, index, boolean } from \"drizzle-orm/pg-core\";\n\n// Session storage - Replit Auth\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// Users table - Replit Auth\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  isPremium: boolean(\"is_premium\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\n```\n\n### 2. server/storage.ts (Attuale - Solo Auth)\n```typescript\nimport { users, type User, type UpsertUser } from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq } from \"drizzle-orm\";\n\nexport interface IStorage {\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n}\n\nexport const storage = new DatabaseStorage();\n```\n\n### 3. server/routes.ts (Attuale - Solo Auth)\n```typescript\nimport type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  await setupAuth(app);\n\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n```\n\n### 4. client/src/App.tsx\n```typescript\nimport { Switch, Route } from \"wouter\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport NotFound from \"@/pages/not-found\";\nimport Landing from \"@/pages/Landing\";\nimport Home from \"@/pages/Home\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { useEffect } from \"react\";\n\nfunction Router() {\n  const { isAuthenticated, isLoading } = useAuth();\n\n  return (\n    <Switch>\n      {isLoading || !isAuthenticated ? (\n        <Route path=\"/\" component={Landing} />\n      ) : (\n        <Route path=\"/\" component={Home} />\n      )}\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  useEffect(() => {\n    document.documentElement.classList.add('dark');\n  }, []);\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Router />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n```\n\n### 5. client/src/hooks/useAuth.ts\n```typescript\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n```\n\n---\n\n## üöÄ Schema Fitness da Aggiungere\n\nAggiungi questo a `shared/schema.ts`:\n\n```typescript\nimport { integer } from \"drizzle-orm/pg-core\";\n\n// Screening\nexport const screenings = pgTable(\"screenings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  goal: varchar(\"goal\").notNull(),\n  level: varchar(\"level\").notNull(),\n  hasGym: boolean(\"has_gym\").notNull(),\n  frequency: integer(\"frequency\").notNull(),\n  painAreas: jsonb(\"pain_areas\").$type<string[]>().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Quiz Results\nexport const quizResults = pgTable(\"quiz_results\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  score: integer(\"score\").notNull(),\n  totalQuestions: integer(\"total_questions\").notNull(),\n  answers: jsonb(\"answers\").$type<number[]>(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Assessments (10RM test)\nexport const assessments = pgTable(\"assessments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  weight: integer(\"weight\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Programs\nexport const programs = pgTable(\"programs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  name: varchar(\"name\").notNull(),\n  split: jsonb(\"split\").$type<string[]>(),\n  exercises: jsonb(\"exercises\").$type<any[]>(),\n  progression: varchar(\"progression\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Workouts\nexport const workouts = pgTable(\"workouts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  programId: varchar(\"program_id\").references(() => programs.id),\n  dayName: varchar(\"day_name\").notNull(),\n  completedAt: timestamp(\"completed_at\").defaultNow(),\n});\n\n// Workout Sets\nexport const workoutSets = pgTable(\"workout_sets\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  workoutId: varchar(\"workout_id\").notNull().references(() => workouts.id),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  setNumber: integer(\"set_number\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  weight: integer(\"weight\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Payments\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  amount: integer(\"amount\").notNull(),\n  currency: varchar(\"currency\").default(\"EUR\"),\n  provider: varchar(\"provider\").notNull(),\n  status: varchar(\"status\").notNull(),\n  transactionId: varchar(\"transaction_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Export types\nexport type Screening = typeof screenings.$inferSelect;\nexport type InsertScreening = typeof screenings.$inferInsert;\nexport type QuizResult = typeof quizResults.$inferSelect;\nexport type Assessment = typeof assessments.$inferSelect;\nexport type Program = typeof programs.$inferSelect;\nexport type Workout = typeof workouts.$inferSelect;\nexport type WorkoutSet = typeof workoutSets.$inferSelect;\nexport type Payment = typeof payments.$inferSelect;\n```\n\n---\n\n## üîß API Routes da Aggiungere\n\nAggiungi a `server/routes.ts`:\n\n```typescript\n// Screening\napp.post(\"/api/screening\", isAuthenticated, async (req: any, res) => {\n  const userId = req.user.claims.sub;\n  const screening = await storage.saveScreening({ userId, ...req.body });\n  res.json(screening);\n});\n\napp.get(\"/api/screening\", isAuthenticated, async (req: any, res) => {\n  const userId = req.user.claims.sub;\n  const screening = await storage.getLatestScreening(userId);\n  res.json(screening);\n});\n\n// Quiz\napp.post(\"/api/quiz/submit\", isAuthenticated, async (req: any, res) => {\n  const userId = req.user.claims.sub;\n  const result = await storage.saveQuizResult({ userId, ...req.body });\n  res.json(result);\n});\n\n// Assessment\napp.post(\"/api/assessment\", isAuthenticated, async (req: any, res) => {\n  const userId = req.user.claims.sub;\n  const assessment = await storage.saveAssessment({ userId, ...req.body });\n  res.json(assessment);\n});\n\n// Program Generation\napp.post(\"/api/program/generate\", isAuthenticated, async (req: any, res) => {\n  const userId = req.user.claims.sub;\n  // Qui usa la logica dal file allegato\n  const program = await generateProgramLogic(userId);\n  res.json(program);\n});\n\n// Workout Tracking\napp.post(\"/api/workout/start\", isAuthenticated, async (req: any, res) => {\n  const userId = req.user.claims.sub;\n  const workout = await storage.createWorkout({ userId, ...req.body });\n  res.json(workout);\n});\n\napp.post(\"/api/workout/:id/set\", isAuthenticated, async (req: any, res) => {\n  const set = await storage.saveWorkoutSet(req.params.id, req.body);\n  res.json(set);\n});\n\n// Stats\napp.get(\"/api/stats\", isAuthenticated, async (req: any, res) => {\n  const userId = req.user.claims.sub;\n  const stats = await storage.getUserStats(userId);\n  res.json(stats);\n});\n\n// Payments - Stripe\napp.post(\"/api/payment/stripe/checkout\", isAuthenticated, async (req: any, res) => {\n  const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!);\n  const session = await stripe.checkout.sessions.create({\n    payment_method_types: ['card'],\n    line_items: [{\n      price_data: {\n        currency: 'eur',\n        product_data: { name: 'TrainSmart Premium' },\n        unit_amount: 999, // ‚Ç¨9.99\n      },\n      quantity: 1,\n    }],\n    mode: 'subscription',\n    success_url: `${req.protocol}://${req.hostname}/success`,\n    cancel_url: `${req.protocol}://${req.hostname}/pricing`,\n  });\n  res.json({ url: session.url });\n});\n\n// Payments - PayPal (usa @paypal/paypal-server-sdk)\n```\n\n---\n\n## üì¶ Storage Methods da Aggiungere\n\nAggiungi a `server/storage.ts`:\n\n```typescript\n// Nella interface IStorage:\nsaveScreening(data: any): Promise<Screening>;\ngetLatestScreening(userId: string): Promise<Screening | undefined>;\nsaveQuizResult(data: any): Promise<QuizResult>;\nsaveAssessment(data: any): Promise<Assessment>;\ncreateWorkout(data: any): Promise<Workout>;\nsaveWorkoutSet(workoutId: string, data: any): Promise<WorkoutSet>;\ngetUserStats(userId: string): Promise<any>;\n\n// Implementazioni in DatabaseStorage\nasync saveScreening(data: any) {\n  const [screening] = await db.insert(screenings).values(data).returning();\n  return screening;\n}\n\nasync getLatestScreening(userId: string) {\n  const [screening] = await db\n    .select()\n    .from(screenings)\n    .where(eq(screenings.userId, userId))\n    .orderBy(desc(screenings.createdAt))\n    .limit(1);\n  return screening;\n}\n\n// ... altri metodi simili\n```\n\n---\n\n## üßÆ Logica Fitness (File Allegato)\n\nIl file `Pasted-import-useState-useEffect...txt` contiene:\n\n1. **Formule Brzycki** per calcolo 1RM:\n```typescript\nfunction calculateOneRepMax(weight: number, reps: number): number {\n  if (reps === 1) return weight;\n  return weight * (36 / (37 - reps));\n}\n```\n\n2. **Calcolo pesi target** in base a livello\n\n3. **Generazione esercizi** con sostituzione in caso di infortuni\n\n4. **Split training**: Full Body, Upper/Lower, PPL\n\n**Porta questa logica in `server/programGenerator.ts`**\n\n---\n\n## üí≥ Setup Pagamenti\n\n### Stripe\n1. Ottieni chiavi: `STRIPE_SECRET_KEY`, `VITE_STRIPE_PUBLIC_KEY`\n2. Gi√† installato: `stripe` package\n3. Usa Checkout Sessions per subscriptions\n\n### PayPal\n1. Ottieni chiavi: `PAYPAL_CLIENT_ID`, `PAYPAL_CLIENT_SECRET`\n2. Gi√† installato: `@paypal/paypal-server-sdk`\n3. Crea Orders API per one-time/recurring\n\n---\n\n## üéØ Prompt per Claude\n\n```\nDevo implementare le funzionalit√† fitness per la mia app TrainSmart.\n\nFATTO:\n- Autenticazione Replit Auth funzionante\n- Database PostgreSQL con tabelle users/sessions\n- UI completa in dark mode\n\nDA FARE:\n1. Aggiungi le tabelle fitness allo schema (screening, quiz, assessments, programs, workouts, sets, payments)\n2. Implementa i metodi storage per CRUD operations\n3. Crea le API routes per screening ‚Üí quiz ‚Üí assessment ‚Üí program generation ‚Üí workout tracking\n4. Porta la logica di generazione programmi (formule Brzycki, calcolo pesi, split training) dal file allegato\n5. Implementa checkout Stripe e PayPal per upgrade Premium\n\nCODICE ATTUALE:\n[incolla questo file]\n\nFILE CON LOGICA FITNESS:\n[incolla il file Pasted-import...]\n\nProcedi step-by-step implementando tutto il necessario.\n```\n\n---\n\n## ‚úÖ Checklist Implementazione\n\n- [ ] Aggiungi tabelle fitness a `shared/schema.ts`\n- [ ] Run `npm run db:push --force`\n- [ ] Aggiungi metodi storage\n- [ ] Implementa API routes\n- [ ] Crea `server/programGenerator.ts` con logica dal file allegato\n- [ ] Testa flow: Screening ‚Üí Quiz ‚Üí Assessment ‚Üí Program\n- [ ] Setup chiavi Stripe/PayPal\n- [ ] Implementa payment checkout\n- [ ] Testa upgrade Premium\n\n---\n\n## üìÇ Struttura Componenti Frontend\n\n```\nclient/src/components/\n‚îú‚îÄ‚îÄ Hero.tsx         (Landing hero section)\n‚îú‚îÄ‚îÄ Features.tsx     (Features showcase)\n‚îú‚îÄ‚îÄ Pricing.tsx      (Pricing cards)\n‚îú‚îÄ‚îÄ Header.tsx       (Navigation)\n‚îú‚îÄ‚îÄ Dashboard.tsx    (User home)\n‚îú‚îÄ‚îÄ ScreeningFlow.tsx (5-step onboarding)\n‚îú‚îÄ‚îÄ QuizComponent.tsx (Technical quiz)\n‚îî‚îÄ‚îÄ WorkoutTracker.tsx (Track sets/reps)\n```\n\n**Tutti i componenti UI sono gi√† pronti!** Serve solo collegare le API.\n","size_bytes":14325},"design_guidelines.md":{"content":"# Design Guidelines: TrainSmart Fitness App\n\n## Design Approach\n\n**Hybrid Strategy**: Reference-based design inspired by leading fitness apps (Strava, Nike Training Club, Strong) for emotional engagement and motivation, combined with Material Design System principles for data-dense workout tracking interfaces.\n\n### Design Philosophy\n- **Motivational Energy**: Bold, energetic visual language that inspires action\n- **Data Clarity**: Clean, scannable layouts for workout data and progress metrics\n- **Performance First**: Fast, responsive UI optimized for in-workout usage\n- **Premium Feel**: Polished aesthetic that justifies subscription value\n\n---\n\n## Core Design Elements\n\n### A. Color Palette\n\n**Primary Brand Colors**\n- **Primary Energy**: 160 85% 45% (Energetic emerald/teal - represents growth, vitality)\n- **Primary Dark**: 160 85% 35% (Darker variant for depth)\n- **Background Dark**: 220 15% 10% (Deep charcoal for main backgrounds)\n- **Surface Dark**: 220 12% 16% (Elevated surfaces, cards)\n\n**Accent & Supporting**\n- **Accent Flame**: 15 90% 55% (Coral/orange for CTAs, premium badges - use sparingly)\n- **Success**: 145 65% 50% (Progress indicators, completed workouts)\n- **Warning**: 35 90% 60% (Rest timers, caution states)\n- **Info**: 210 80% 55% (Informational elements)\n\n**Semantic Colors**\n- **Text Primary**: 0 0% 95% (Main text on dark)\n- **Text Secondary**: 0 0% 65% (Supporting text)\n- **Text Muted**: 0 0% 45% (Labels, metadata)\n- **Borders**: 220 12% 25% (Subtle dividers)\n\n### B. Typography\n\n**Font Stack**\n- **Primary**: Inter (via Google Fonts) - Clean, highly legible for data\n- **Display**: Archivo Black (via Google Fonts) - Bold headlines, hero sections\n- **Monospace**: JetBrains Mono - Workout timers, rep counts\n\n**Type Scale**\n- **Hero Display**: 4xl-6xl, weight-900, tight tracking (landing page heroes)\n- **Section Headers**: 2xl-3xl, weight-700 (dashboard sections)\n- **Card Titles**: xl, weight-600 (exercise names, workout cards)\n- **Body Text**: base, weight-400 (descriptions, instructions)\n- **Metadata**: sm, weight-500 (reps, sets, weight values)\n- **Micro Copy**: xs, weight-400 (labels, helper text)\n\n### C. Layout System\n\n**Spacing Primitives**: Use Tailwind units of **2, 4, 6, 8, 12, 16** for consistent rhythm\n- Micro spacing: `gap-2`, `p-2` (tight elements)\n- Standard spacing: `gap-4`, `p-4`, `m-4` (cards, buttons)\n- Section spacing: `gap-6`, `py-6` (card sections)\n- Major spacing: `gap-8`, `py-8` (between major sections)\n- Page spacing: `py-12`, `py-16` (desktop page sections)\n\n**Grid Patterns**\n- Landing page: 12-column responsive grid\n- Dashboard: 4-column on desktop ‚Üí 2-column tablet ‚Üí 1-column mobile\n- Workout tracker: Full-width single column for focus\n\n**Container Strategy**\n- Landing sections: `max-w-7xl mx-auto px-4`\n- App content: `max-w-6xl mx-auto px-4`\n- Workout tracker: `max-w-2xl mx-auto px-4` (narrower for focus)\n\n### D. Component Library\n\n**Navigation**\n- Top bar: Fixed with blur backdrop, logo left, auth/profile right\n- Dashboard tabs: Pill-style navigation with active state indicator\n- Mobile: Bottom navigation bar for core actions (Dashboard, Workout, Progress, Profile)\n\n**Cards & Containers**\n- Workout cards: Rounded-xl, subtle border, hover elevation on desktop\n- Exercise rows: Clean horizontal layout with exercise name, sets√óreps, weight, rest timer\n- Stats cards: Compact with large numbers, icons, and micro trends\n\n**Forms & Inputs**\n- Input fields: Dark background with subtle border, focus state with primary color ring\n- Buttons Primary: Gradient from primary to primary-dark, white text, rounded-lg\n- Buttons Secondary: Outlined with primary color, transparent background\n- Toggle switches: For premium features, tracking preferences\n\n**Data Display**\n- Progress charts: Minimal line/bar charts with primary color gradient fills\n- Rep counters: Large, tappable buttons with clear visual feedback\n- Timer displays: Monospace font, countdown with color transitions (info ‚Üí warning ‚Üí success)\n\n**Modals & Overlays**\n- Payment modal: Centered card with subtle backdrop blur\n- Workout complete: Full-screen celebration with stats summary\n- Exercise detail: Slide-up panel with technique tips and form cues\n\n**Premium Indicators**\n- Lock icons on premium features with accent flame color\n- \"Premium\" badge with gradient background on locked content\n- Upgrade CTA: Prominent placement with flame accent color\n\n### E. Animations\n\n**Core Principles**: Minimal and purposeful - avoid distracting from workout focus\n\n**Essential Only**\n- Button press: Subtle scale-down (0.98) on active state\n- Card hover: Gentle elevation lift (shadow transition)\n- Tab switching: Fast fade transition (150ms)\n- Timer countdown: Color pulse at final 3 seconds\n- Workout complete: Confetti burst or success checkmark animation (one-time celebration)\n\n**Avoid**: Continuous animations, carousel auto-play, loading spinners (use skeleton screens instead)\n\n---\n\n## Page-Specific Guidelines\n\n### Landing/Marketing Page\n\n**Hero Section** (80vh min-height)\n- **Layout**: Split screen - left 60% content, right 40% hero image\n- **Content**: Bold display headline \"Allenati con Intelligenza\" (or similar), value proposition, dual CTAs (Start Free Trial + Learn More)\n- **Hero Image**: Athletic figure in action shot (deadlift, squat, or training scene) with subtle gradient overlay\n- **Background**: Gradient from background-dark to surface-dark with subtle noise texture\n\n**Features Section** (3-column grid on desktop)\n- Icons: Use Heroicons for feature icons (lightning, chart-bar, shield-check, etc.)\n- Cards: Hover elevation, icon at top, concise benefit copy\n- Features to highlight: AI-powered programs, Progress tracking, Form check quiz, Premium coaching\n\n**Pricing/CTA Section**\n- Two-tier comparison: Free vs Premium (side-by-side cards)\n- Premium card: Flame accent border, feature checklist with checkmarks\n- Prominent PayPal and credit card badges for trust\n\n**Social Proof** (if applicable)\n- User testimonials with before/after stats (not photos - just numbers)\n- \"Join 500+ athletes training smarter\" with subtle counter animation\n\n### Dashboard/App Interface\n\n**Layout**: Sidebar navigation (desktop) with main content area\n- Sidebar: Fixed left, dark surface, icon + label navigation items\n- Main content: Scrollable with generous padding, card-based layout\n\n**Workout Tracking View**\n- Fixed header: Exercise name, current set/rep, progress bar\n- Exercise list: Scrollable, each row showing weight, reps completed, rest timer\n- Bottom bar: Next exercise preview, complete workout button\n\n**Progress Dashboard**\n- Top metrics: 4-stat cards (workouts completed, total volume, PRs, streak)\n- Chart section: Weekly volume or strength progression (simple line chart)\n- Recent workouts: Chronological list with completion badges\n\n---\n\n## Images Section\n\n**Hero Image** (Landing page)\n- Placement: Right side of hero section (40% width on desktop)\n- Style: High-energy training photo, natural lighting, authentic athlete (not stock-looking)\n- Treatment: Subtle gradient overlay (primary color at 10% opacity) blending into background\n\n**Optional Feature Images**\n- Small spot illustrations for empty states (no workouts yet, no data)\n- Icon-based graphics for quiz/assessment screens (avoid photo overload)\n\n**Do Not Use**: Generic stock fitness photos with fake smiles or overly edited bodies\n\n---\n\n## Accessibility & Dark Mode\n\n**Primary Theme**: Dark mode throughout (not a toggle)\n- All text meets WCAG AA contrast (4.5:1 for body, 3:1 for large text)\n- Form inputs: High contrast borders and labels\n- Interactive elements: Clear focus indicators with primary color ring\n\n**Touch Targets**: Minimum 44√ó44px for all tappable elements (critical for workout tracking)\n\n---\n\n## Technical Implementation Notes\n\n**Icons**: Heroicons via CDN (outline style for navigation, solid for status indicators)\n\n**Fonts**: Google Fonts CDN\n```\nInter (weights: 400, 500, 600, 700)\nArchivo Black (weight: 900)\nJetBrains Mono (weight: 500)\n```\n\n**Performance**: \n- Lazy load images below fold\n- Skeleton screens for loading states\n- Optimistic UI updates for workout logging","size_bytes":8152},"client/src/components/Hero.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Zap } from \"lucide-react\";\n\nexport default function Hero() {\n  return (\n    <div className=\"min-h-screen bg-background flex items-center\">\n      <div className=\"max-w-7xl mx-auto px-4 py-16 w-full\">\n        <div className=\"grid md:grid-cols-2 gap-12 items-center\">\n          <div className=\"space-y-8\">\n            <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 border border-primary/20\">\n              <Zap className=\"w-4 h-4 text-primary\" />\n              <span className=\"text-sm font-medium text-primary\">Allenamento Basato sulla Scienza</span>\n            </div>\n            \n            <h1 className=\"font-display text-5xl md:text-6xl lg:text-7xl leading-tight text-foreground\">\n              Allenati con <span className=\"text-primary\">Intelligenza</span>\n            </h1>\n            \n            <p className=\"text-lg text-muted-foreground max-w-lg\">\n              Programmi personalizzati basati sui tuoi dati, progressione scientifica e tracciamento dettagliato per raggiungere i tuoi obiettivi fitness.\n            </p>\n            \n            <div className=\"flex flex-wrap gap-4\">\n              <Button \n                size=\"lg\" \n                className=\"text-base\"\n                asChild\n                data-testid=\"button-start\"\n              >\n                <a href=\"/api/login\">\n                  Inizia Ora\n                </a>\n              </Button>\n              <Button \n                size=\"lg\" \n                variant=\"outline\" \n                className=\"text-base\"\n                onClick={() => document.getElementById('features')?.scrollIntoView({ behavior: 'smooth' })}\n                data-testid=\"button-learn-more\"\n              >\n                Scopri di pi√π\n              </Button>\n            </div>            \n            <div className=\"flex items-center gap-8 pt-4\">\n              <div>\n                <div className=\"text-3xl font-bold text-primary\">500+</div>\n                <div className=\"text-sm text-muted-foreground\">Atleti attivi</div>\n              </div>\n              <div className=\"h-12 w-px bg-border\" />\n              <div>\n                <div className=\"text-3xl font-bold text-primary\">10K+</div>\n                <div className=\"text-sm text-muted-foreground\">Workout completati</div>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"relative hidden md:block\">\n            <div className=\"absolute inset-0 bg-gradient-to-br from-primary/20 to-chart-2/20 rounded-3xl blur-3xl\" />\n            <div className=\"relative bg-gradient-to-br from-card to-card/50 backdrop-blur-sm rounded-3xl p-12 border border-card-border\">\n              <div className=\"space-y-6\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center\">\n                    <Zap className=\"w-8 h-8 text-primary\" />\n                  </div>\n                  <div>\n                    <div className=\"text-2xl font-bold\">TrainSmart</div>\n                    <div className=\"text-sm text-muted-foreground\">Il tuo coach personale</div>\n                  </div>\n                </div>\n                \n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between p-4 bg-background/50 rounded-lg border border-border\">\n                    <span className=\"text-sm\">Progressione Forza</span>\n                    <span className=\"text-lg font-bold text-chart-3\">+12%</span>\n                  </div>\n                  <div className=\"flex items-center justify-between p-4 bg-background/50 rounded-lg border border-border\">\n                    <span className=\"text-sm\">Volume Settimanale</span>\n                    <span className=\"text-lg font-bold text-chart-1\">8.5T</span>\n                  </div>\n                  <div className=\"flex items-center justify-between p-4 bg-background/50 rounded-lg border border-border\">\n                    <span className=\"text-sm\">Serie Completate</span>\n                    <span className=\"text-lg font-bold text-chart-4\">156</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4351},"server/storage.ts":{"content":"import {\n  users,\n  screenings,\n  quizResults,\n  assessments,\n  programs,\n  workouts,\n  workoutSets,\n  weeklyProgress,\n  personalRecords,\n  payments,\n  workoutAdaptations,\n  type User,\n  type UpsertUser,\n  type Screening,\n  type InsertScreening,\n  type QuizResult,\n  type InsertQuizResult,\n  type Assessment,\n  type InsertAssessment,\n  type Program,\n  type InsertProgram,\n  type Workout,\n  type InsertWorkout,\n  type WorkoutSet,\n  type InsertWorkoutSet,\n  type Payment,\n  type InsertPayment,\n  type WorkoutAdaptation,\n  type InsertWorkoutAdaptation,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, and, gte, sql } from \"drizzle-orm\";\n\nexport class DatabaseStorage {\n  // ===== USERS =====\n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const [user] = await db\n      .insert(users)\n      .values(userData)\n      .onConflictDoUpdate({\n        target: users.id,\n        set: {\n          ...userData,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return user;\n  }\n\n  async updateUserPremium(userId: string, isPremium: boolean): Promise<User> {\n    const [user] = await db\n      .update(users)\n      .set({ isPremium, updatedAt: new Date() })\n      .where(eq(users.id, userId))\n      .returning();\n    return user;\n  }\n\n  // ===== SCREENING =====\n  async saveScreening(data: InsertScreening): Promise<Screening> {\n    const [screening] = await db.insert(screenings).values(data).returning();\n    return screening;\n  }\n\n  async getLatestScreening(userId: string): Promise<Screening | undefined> {\n    const [screening] = await db\n      .select()\n      .from(screenings)\n      .where(eq(screenings.userId, userId))\n      .orderBy(desc(screenings.createdAt))\n      .limit(1);\n    return screening;\n  }\n\n  async updateScreeningLevel(\n    screeningId: string,\n    level: string,\n  ): Promise<void> {\n    await db\n      .update(screenings)\n      .set({ level })\n      .where(eq(screenings.id, screeningId));\n  }\n\n  // ===== QUIZ =====\n  async saveQuizResult(data: InsertQuizResult): Promise<QuizResult> {\n    const [result] = await db.insert(quizResults).values(data).returning();\n    return result;\n  }\n\n  async getLatestQuiz(userId: string): Promise<QuizResult | undefined> {\n    const [quiz] = await db\n      .select()\n      .from(quizResults)\n      .where(eq(quizResults.userId, userId))\n      .orderBy(desc(quizResults.createdAt))\n      .limit(1);\n    return quiz;\n  }\n\n  // ===== ASSESSMENTS =====\n  async saveAssessment(data: InsertAssessment): Promise<Assessment> {\n    const [assessment] = await db.insert(assessments).values(data).returning();\n    return assessment;\n  }\n\n  async getLatestAssessments(userId: string): Promise<Assessment[]> {\n    return await db\n      .select()\n      .from(assessments)\n      .where(eq(assessments.userId, userId))\n      .orderBy(desc(assessments.createdAt))\n      .limit(10);\n  }\n\n  // ===== PROGRAMS =====\n  async createProgram(data: InsertProgram): Promise<Program> {\n    // Disattiva programmi precedenti\n    await db\n      .update(programs)\n      .set({ isActive: false, updatedAt: new Date() })\n      .where(\n        and(eq(programs.userId, data.userId), eq(programs.isActive, true)),\n      );\n\n    const [program] = await db.insert(programs).values(data).returning();\n    return program;\n  }\n\n  async getProgram(id: string): Promise<Program | undefined> {\n    const [program] = await db\n      .select()\n      .from(programs)\n      .where(eq(programs.id, id));\n    return program;\n  }\n\n  async getActiveProgram(userId: string): Promise<Program | undefined> {\n    const [program] = await db\n      .select()\n      .from(programs)\n      .where(and(eq(programs.userId, userId), eq(programs.isActive, true)))\n      .orderBy(desc(programs.createdAt))\n      .limit(1);\n    return program;\n  }\n\n  async getUserPrograms(userId: string): Promise<Program[]> {\n    return await db\n      .select()\n      .from(programs)\n      .where(eq(programs.userId, userId))\n      .orderBy(desc(programs.createdAt))\n      .limit(20);\n  }\n\n  async updateProgramStatus(\n    programId: string,\n    isActive: boolean,\n  ): Promise<void> {\n    await db\n      .update(programs)\n      .set({ isActive, updatedAt: new Date() })\n      .where(eq(programs.id, programId));\n  }\n\n  // ===== WORKOUTS =====\n  async createWorkout(data: InsertWorkout): Promise<Workout> {\n    const [workout] = await db.insert(workouts).values(data).returning();\n    return workout;\n  }\n\n  async getWorkout(id: string): Promise<Workout | undefined> {\n    const [workout] = await db\n      .select()\n      .from(workouts)\n      .where(eq(workouts.id, id));\n    return workout;\n  }\n\n  async completeWorkout(\n    workoutId: string,\n    duration: number,\n    totalVolume: number,\n  ): Promise<Workout> {\n    const [workout] = await db\n      .update(workouts)\n      .set({\n        status: \"completed\",\n        completedAt: new Date(),\n        duration,\n        totalVolume: totalVolume.toString(),\n      })\n      .where(eq(workouts.id, workoutId))\n      .returning();\n    return workout;\n  }\n\n  async getUserWorkouts(\n    userId: string,\n    limit: number = 50,\n  ): Promise<Workout[]> {\n    return await db\n      .select()\n      .from(workouts)\n      .where(eq(workouts.userId, userId))\n      .orderBy(desc(workouts.startedAt))\n      .limit(limit);\n  }\n\n  async getRecentWorkoutsWithPain(\n    userId: string,\n    limit: number = 6,\n  ): Promise<Workout[]> {\n    return await db\n      .select()\n      .from(workouts)\n      .where(and(eq(workouts.userId, userId), eq(workouts.status, \"completed\")))\n      .orderBy(desc(workouts.completedAt))\n      .limit(limit);\n  }\n\n  // ===== WORKOUT SETS =====\n  async saveWorkoutSet(data: InsertWorkoutSet): Promise<WorkoutSet> {\n    const [set] = await db.insert(workoutSets).values(data).returning();\n    return set;\n  }\n\n  async getWorkoutSets(workoutId: string): Promise<WorkoutSet[]> {\n    return await db\n      .select()\n      .from(workoutSets)\n      .where(eq(workoutSets.workoutId, workoutId))\n      .orderBy(workoutSets.setNumber);\n  }\n\n  // ===== WEEKLY PROGRESS =====\n  async updateWeeklyProgress(userId: string, weekStart: Date): Promise<void> {\n    const weekEnd = new Date(weekStart);\n    weekEnd.setDate(weekEnd.getDate() + 7);\n\n    const workoutsThisWeek = await db\n      .select()\n      .from(workouts)\n      .where(\n        and(\n          eq(workouts.userId, userId),\n          eq(workouts.status, \"completed\"),\n          gte(workouts.completedAt, weekStart),\n        ),\n      );\n\n    const totalVolume = workoutsThisWeek.reduce(\n      (sum, w) => sum + parseFloat(w.totalVolume || \"0\"),\n      0,\n    );\n\n    const avgPainLevel =\n      workoutsThisWeek.length > 0\n        ? workoutsThisWeek.reduce((sum, w) => sum + (w.painLevel || 0), 0) /\n          workoutsThisWeek.length\n        : 0;\n\n    await db\n      .insert(weeklyProgress)\n      .values({\n        userId,\n        weekStart,\n        workoutsCompleted: workoutsThisWeek.length,\n        totalVolume: totalVolume.toString(),\n        avgPainLevel: avgPainLevel.toFixed(2),\n      })\n      .onConflictDoUpdate({\n        target: [weeklyProgress.userId, weeklyProgress.weekStart],\n        set: {\n          workoutsCompleted: workoutsThisWeek.length,\n          totalVolume: totalVolume.toString(),\n          avgPainLevel: avgPainLevel.toFixed(2),\n          updatedAt: new Date(),\n        },\n      });\n  }\n\n  async getWeeklyProgress(userId: string, weeks: number = 12): Promise<any[]> {\n    return await db\n      .select()\n      .from(weeklyProgress)\n      .where(eq(weeklyProgress.userId, userId))\n      .orderBy(desc(weeklyProgress.weekStart))\n      .limit(weeks);\n  }\n\n  // ===== PERSONAL RECORDS =====\n  async getUserPRs(userId: string): Promise<any[]> {\n    return await db\n      .select()\n      .from(personalRecords)\n      .where(eq(personalRecords.userId, userId))\n      .orderBy(desc(personalRecords.achievedAt))\n      .limit(50);\n  }\n\n  // ===== PAYMENTS =====\n  async createPayment(data: InsertPayment): Promise<Payment> {\n    const [payment] = await db.insert(payments).values(data).returning();\n    return payment;\n  }\n\n  async getPayment(id: string): Promise<Payment | undefined> {\n    const [payment] = await db\n      .select()\n      .from(payments)\n      .where(eq(payments.id, id));\n    return payment;\n  }\n\n  async updatePaymentStatus(\n    paymentId: string,\n    status: string,\n    transactionId?: string,\n  ): Promise<Payment> {\n    const [payment] = await db\n      .update(payments)\n      .set({\n        status,\n        transactionId,\n        updatedAt: new Date(),\n      })\n      .where(eq(payments.id, paymentId))\n      .returning();\n    return payment;\n  }\n\n  // ===== WORKOUT ADAPTATIONS =====\n  async createWorkoutAdaptation(data: InsertWorkoutAdaptation): Promise<WorkoutAdaptation> {\n    // Cancella eventuali adaptation precedenti per lo stesso workout\n    await db\n      .delete(workoutAdaptations)\n      .where(\n        and(\n          eq(workoutAdaptations.userId, data.userId),\n          eq(workoutAdaptations.programId, data.programId),\n          eq(workoutAdaptations.dayName, data.dayName)\n        )\n      );\n\n    const [adaptation] = await db\n      .insert(workoutAdaptations)\n      .values(data)\n      .returning();\n    return adaptation;\n  }\n\n  async getWorkoutAdaptation(\n    userId: string,\n    programId: string,\n    dayName: string\n  ): Promise<WorkoutAdaptation | undefined> {\n    const [adaptation] = await db\n      .select()\n      .from(workoutAdaptations)\n      .where(\n        and(\n          eq(workoutAdaptations.userId, userId),\n          eq(workoutAdaptations.programId, programId),\n          eq(workoutAdaptations.dayName, dayName),\n          eq(workoutAdaptations.used, false)\n        )\n      )\n      .orderBy(desc(workoutAdaptations.createdAt))\n      .limit(1);\n    return adaptation;\n  }\n\n  async markAdaptationAsUsed(adaptationId: string): Promise<void> {\n    await db\n      .update(workoutAdaptations)\n      .set({ used: true })\n      .where(eq(workoutAdaptations.id, adaptationId));\n  }\n\n  async deleteOldAdaptations(): Promise<void> {\n    // Elimina adaptations pi√π vecchie di 24h o gi√† usate\n    await db\n      .delete(workoutAdaptations)\n      .where(\n        sql`${workoutAdaptations.createdAt} < NOW() - INTERVAL '24 hours' OR ${workoutAdaptations.used} = true`\n      );\n  }\n\n  // ===== UTILITIES =====\n  async resetUserData(userId: string): Promise<void> {\n    // Elimina tutti i dati utente (tranne l'account)\n    await db\n      .delete(workoutSets)\n      .where(\n        sql`${workoutSets.workoutId} IN (SELECT id FROM ${workouts} WHERE ${workouts.userId} = ${userId})`,\n      );\n    await db.delete(workouts).where(eq(workouts.userId, userId));\n    await db.delete(programs).where(eq(programs.userId, userId));\n    await db.delete(assessments).where(eq(assessments.userId, userId));\n    await db.delete(quizResults).where(eq(quizResults.userId, userId));\n    await db.delete(screenings).where(eq(screenings.userId, userId));\n    await db.delete(weeklyProgress).where(eq(weeklyProgress.userId, userId));\n    await db.delete(personalRecords).where(eq(personalRecords.userId, userId));\n    await db.delete(workoutAdaptations).where(eq(workoutAdaptations.userId, userId));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","size_bytes":11389},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"PROGETTO_STATO.md":{"content":"# TrainSmart - Stato Progetto\n\n## ‚úÖ Cosa √® stato completato\n\n### 1. Design & UI (100%)\n- ‚úÖ Design system completo in dark mode\n- ‚úÖ Landing page con Hero, Features, Pricing\n- ‚úÖ Componenti UI: Screening, Quiz, Workout Tracker, Dashboard\n- ‚úÖ Header responsive con navigazione\n- ‚úÖ Palette colori: Primary (emerald), Accent (coral), Background dark\n- ‚úÖ Typography: Inter, Archivo Black, JetBrains Mono\n\n### 2. Autenticazione (100%)\n- ‚úÖ Replit Auth integrato (Google, GitHub, Email/Password)\n- ‚úÖ Tabelle database: `users`, `sessions`\n- ‚úÖ Route protette con middleware `isAuthenticated`\n- ‚úÖ Hook `useAuth()` per frontend\n- ‚úÖ Login/Logout funzionanti\n- ‚úÖ Redirect automatico dopo login\n\n### 3. Database (100%)\n- ‚úÖ PostgreSQL configurato\n- ‚úÖ Drizzle ORM setup\n- ‚úÖ Schema users con campi: id, email, firstName, lastName, profileImageUrl, isPremium\n\n---\n\n## ‚ùå Cosa manca da implementare\n\n### 1. Schema Database Fitness\nAggiungi queste tabelle al file `shared/schema.ts`:\n\n```typescript\n// Screening iniziale dell'utente\nexport const screenings = pgTable(\"screenings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  goal: varchar(\"goal\").notNull(), // weight_loss, muscle_gain, strength, etc.\n  level: varchar(\"level\").notNull(), // beginner, intermediate, advanced\n  hasGym: boolean(\"has_gym\").notNull(),\n  frequency: integer(\"frequency\").notNull(), // 2-6 giorni\n  painAreas: jsonb(\"pain_areas\").$type<string[]>().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Risultati quiz tecnico\nexport const quizResults = pgTable(\"quiz_results\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  score: integer(\"score\").notNull(),\n  totalQuestions: integer(\"total_questions\").notNull(),\n  answers: jsonb(\"answers\").$type<number[]>(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Assessment forza (10RM test)\nexport const assessments = pgTable(\"assessments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  weight: integer(\"weight\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Programmi generati\nexport const programs = pgTable(\"programs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  name: varchar(\"name\").notNull(),\n  split: jsonb(\"split\").$type<string[]>(), // [\"Full Body A\", \"Full Body B\", ...]\n  exercises: jsonb(\"exercises\").$type<any[]>(),\n  progression: varchar(\"progression\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Workout completati\nexport const workouts = pgTable(\"workouts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  programId: varchar(\"program_id\").references(() => programs.id),\n  dayName: varchar(\"day_name\").notNull(),\n  completedAt: timestamp(\"completed_at\").defaultNow(),\n});\n\n// Set eseguiti\nexport const workoutSets = pgTable(\"workout_sets\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  workoutId: varchar(\"workout_id\").notNull().references(() => workouts.id),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  setNumber: integer(\"set_number\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  weight: integer(\"weight\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Payments (PayPal/Stripe)\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  amount: integer(\"amount\").notNull(),\n  currency: varchar(\"currency\").default(\"EUR\"),\n  provider: varchar(\"provider\").notNull(), // \"paypal\" | \"stripe\"\n  status: varchar(\"status\").notNull(), // \"pending\" | \"completed\" | \"failed\"\n  transactionId: varchar(\"transaction_id\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n```\n\n### 2. API Routes da implementare\n\nIn `server/routes.ts`, aggiungi:\n\n```typescript\n// Screening\napp.post(\"/api/screening\", isAuthenticated, async (req, res) => {\n  const userId = req.user.claims.sub;\n  // Salva screening in DB\n});\n\n// Quiz\napp.post(\"/api/quiz/submit\", isAuthenticated, async (req, res) => {\n  const userId = req.user.claims.sub;\n  // Salva risultato quiz\n});\n\n// Assessment\napp.post(\"/api/assessment\", isAuthenticated, async (req, res) => {\n  const userId = req.user.claims.sub;\n  // Salva assessment 10RM\n});\n\n// Generazione programma\napp.post(\"/api/program/generate\", isAuthenticated, async (req, res) => {\n  const userId = req.user.claims.sub;\n  // Usa la logica dal file allegato per generare programma\n  // Salva in DB\n});\n\n// Tracciamento workout\napp.post(\"/api/workout/start\", isAuthenticated, async (req, res) => {\n  const userId = req.user.claims.sub;\n  // Crea nuovo workout\n});\n\napp.post(\"/api/workout/:id/set\", isAuthenticated, async (req, res) => {\n  // Salva set completato\n});\n\napp.post(\"/api/workout/:id/complete\", isAuthenticated, async (req, res) => {\n  // Segna workout come completato\n});\n\n// Statistiche\napp.get(\"/api/stats\", isAuthenticated, async (req, res) => {\n  const userId = req.user.claims.sub;\n  // Calcola: workout completati, volume totale, PRs, streak\n});\n```\n\n### 3. Logica Generazione Programma\n\nIl file allegato `Pasted-import-useState-useEffect...txt` contiene tutta la logica:\n- Formule Brzycki per calcolo 1RM\n- Calcolo pesi target per livello\n- Generazione esercizi con sostituzione infortuni\n- Split training (Full Body, Upper/Lower, PPL)\n\n**Porta questa logica nel backend** in `server/programGenerator.ts`:\n```typescript\nexport function generateProgram(screening, assessment, quiz) {\n  // Usa le funzioni dal file allegato\n  // Ritorna: { split, exercises, progression }\n}\n```\n\n### 4. Pagamenti PayPal + Stripe\n\n**Setup:**\n1. Ottieni chiavi API:\n   - PayPal: `PAYPAL_CLIENT_ID`, `PAYPAL_CLIENT_SECRET`\n   - Stripe: `STRIPE_SECRET_KEY`, `VITE_STRIPE_PUBLIC_KEY`\n\n2. Installa SDK (gi√† fatto ma verifica):\n```bash\nnpm list @paypal/paypal-server-sdk stripe\n```\n\n3. Crea route pagamenti:\n```typescript\n// Stripe Checkout\napp.post(\"/api/payment/stripe/checkout\", isAuthenticated, async (req, res) => {\n  const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!);\n  const session = await stripe.checkout.sessions.create({\n    payment_method_types: ['card'],\n    line_items: [{\n      price_data: {\n        currency: 'eur',\n        product_data: { name: 'TrainSmart Premium' },\n        unit_amount: 999, // ‚Ç¨9.99\n      },\n      quantity: 1,\n    }],\n    mode: 'subscription',\n    success_url: `${req.protocol}://${req.hostname}/success`,\n    cancel_url: `${req.protocol}://${req.hostname}/cancel`,\n  });\n  res.json({ url: session.url });\n});\n\n// PayPal\napp.post(\"/api/payment/paypal/create\", isAuthenticated, async (req, res) => {\n  // Usa @paypal/paypal-server-sdk\n});\n```\n\n### 5. Flow Applicazione\n\n**1. Utente nuovo (non loggato):**\n- Landing page ‚Üí Clicca \"Inizia Gratis\" ‚Üí Login Replit Auth\n\n**2. Dopo login (primo accesso):**\n- Screening (5 step) ‚Üí Quiz tecnico ‚Üí Assessment 10RM ‚Üí Genera programma\n\n**3. Utente esistente:**\n- Dashboard ‚Üí Visualizza prossimo workout ‚Üí Traccia allenamento\n\n**4. Upgrade Premium:**\n- Dashboard ‚Üí Badge \"Premium\" ‚Üí Modal pagamento PayPal/Stripe\n\n---\n\n## üìÅ Struttura File Corrente\n\n```\nclient/src/\n‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îú‚îÄ‚îÄ Hero.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ Features.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ Pricing.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ Header.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ ScreeningFlow.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ QuizComponent.tsx\n‚îÇ   ‚îî‚îÄ‚îÄ WorkoutTracker.tsx\n‚îú‚îÄ‚îÄ pages/\n‚îÇ   ‚îú‚îÄ‚îÄ Landing.tsx\n‚îÇ   ‚îú‚îÄ‚îÄ Home.tsx\n‚îÇ   ‚îî‚îÄ‚îÄ not-found.tsx\n‚îú‚îÄ‚îÄ hooks/\n‚îÇ   ‚îî‚îÄ‚îÄ useAuth.ts\n‚îú‚îÄ‚îÄ lib/\n‚îÇ   ‚îú‚îÄ‚îÄ authUtils.ts\n‚îÇ   ‚îî‚îÄ‚îÄ queryClient.ts\n‚îî‚îÄ‚îÄ App.tsx\n\nserver/\n‚îú‚îÄ‚îÄ replitAuth.ts (‚úÖ Replit Auth setup)\n‚îú‚îÄ‚îÄ routes.ts (‚ö†Ô∏è Aggiungi API routes fitness)\n‚îú‚îÄ‚îÄ storage.ts (‚ö†Ô∏è Aggiungi metodi CRUD)\n‚îî‚îÄ‚îÄ db.ts\n\nshared/\n‚îî‚îÄ‚îÄ schema.ts (‚ö†Ô∏è Aggiungi tabelle fitness)\n```\n\n---\n\n## üöÄ Prossimi Step\n\n1. **Aggiungi schema DB fitness** in `shared/schema.ts`\n2. **Run** `npm run db:push --force`\n3. **Aggiungi metodi storage** in `server/storage.ts`\n4. **Implementa API routes** in `server/routes.ts`\n5. **Porta logica generazione programma** dal file allegato\n6. **Configura PayPal/Stripe** con chiavi API\n7. **Testa il flow completo**: Screening ‚Üí Quiz ‚Üí Assessment ‚Üí Programma ‚Üí Workout\n\n---\n\n## üîë Variabili Ambiente\n\n**Gi√† configurate:**\n- ‚úÖ DATABASE_URL\n- ‚úÖ SESSION_SECRET\n- ‚úÖ REPL_ID, REPLIT_DOMAINS, ISSUER_URL (Replit Auth)\n\n**Da configurare quando implementi pagamenti:**\n- ‚ùå PAYPAL_CLIENT_ID\n- ‚ùå PAYPAL_CLIENT_SECRET\n- ‚ùå STRIPE_SECRET_KEY\n- ‚ùå VITE_STRIPE_PUBLIC_KEY\n\n---\n\n## üí° Note Tecniche\n\n- **Dark mode**: Applicato globalmente in `App.tsx` con `document.documentElement.classList.add('dark')`\n- **Auth**: Middleware `isAuthenticated` protegge le route\n- **Database**: Usa Drizzle ORM con PostgreSQL\n- **Frontend**: React + Wouter + TanStack Query + Shadcn UI\n- **Backend**: Express + TypeScript\n\n---\n\n## üìù File da Portare su Claude\n\n**Copia questo intero documento** + il contenuto di questi file chiave:\n\n1. `shared/schema.ts` (schema DB attuale)\n2. `server/routes.ts` (routes attuali)\n3. `server/storage.ts` (storage interface)\n4. File allegato con logica fitness (formule Brzycki, generazione programma)\n\nPoi su Claude puoi chiedere:\n- \"Implementa le tabelle fitness nel schema\"\n- \"Crea le API routes per screening/quiz/assessment\"\n- \"Porta la logica di generazione programma nel backend\"\n- \"Implementa il sistema di pagamento PayPal e Stripe\"\n","size_bytes":10001},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/Header.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Zap, Menu } from \"lucide-react\";\nimport LanguageToggle from \"@/components/LanguageToggle\";\n\nexport default function Header() {\n  return (\n    <header className=\"sticky top-0 z-50 w-full border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n      <div className=\"max-w-7xl mx-auto px-4 h-16 flex items-center justify-between\">\n        <div className=\"flex items-center gap-2\">\n          <div className=\"w-10 h-10 rounded-lg bg-primary flex items-center justify-center\">\n            <Zap className=\"w-6 h-6 text-primary-foreground\" />\n          </div>\n          <span className=\"font-display text-xl text-foreground\">TrainSmart</span>\n        </div>\n\n        <nav className=\"hidden md:flex items-center gap-6\">\n          <a href=\"#features\" className=\"text-sm font-medium hover:text-primary transition-colors\">\n            Funzionalit√†\n          </a>\n          <a href=\"#pricing\" className=\"text-sm font-medium hover:text-primary transition-colors\">\n            Prezzi\n          </a>\n          <a href=\"#about\" className=\"text-sm font-medium hover:text-primary transition-colors\">\n            Chi Siamo\n          </a>\n        </nav>\n\n        <div className=\"flex items-center gap-3\">\n          <LanguageToggle />\n          <Button \n            onClick={() => window.location.href = \"/api/login\"}\n            data-testid=\"button-login\"\n          >\n            Accedi / Registrati\n          </Button>\n          \n          <Button variant=\"ghost\" size=\"icon\" className=\"md:hidden\" data-testid=\"button-menu\">\n            <Menu className=\"w-5 h-5\" />\n          </Button>\n        </div>\n      </div>\n    </header>\n  );\n}\n","size_bytes":1718},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport session from \"express-session\";\nimport pgSession from \"connect-pg-simple\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { pool } from \"./db\";\n\nconst app = express();\napp.set('trust proxy', true);\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n// ===== SESSION MIDDLEWARE (MUST BE BEFORE AUTH) =====\nconst PgSession = pgSession(session);\napp.use(session({\n  store: new PgSession({ \n    pool, \n    createTableIfMissing: true,\n    tableName: 'sessions'\n  }),\n  secret: process.env.SESSION_SECRET || 'dev-secret-CHANGE-IN-PRODUCTION',\n  resave: false,\n  saveUninitialized: false,\n  cookie: { \n    maxAge: 30 * 24 * 60 * 60 * 1000, // 30 giorni\n    secure: process.env.NODE_ENV === 'production',\n    httpOnly: true,\n    sameSite: 'lax'\n  },\n  name: 'trainsmart.sid'\n}));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"‚Ä¶\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  server.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","size_bytes":2756},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"client/src/pages/Landing.tsx":{"content":"import Header from \"@/components/Header\";\nimport Hero from \"@/components/Hero\";\nimport Features from \"@/components/Features\";\nimport Roadmap from \"@/components/Roadmap\";\nimport Pricing from \"@/components/Pricing\";\nimport { Zap } from \"lucide-react\";\n\nexport default function Landing() {\n  return (\n    <div className=\"min-h-screen\">\n      <Header />\n      <Hero />\n      <div id=\"features\">\n        <Features />\n      </div>\n      <div id=\"roadmap\">\n        <Roadmap />\n      </div>\n      <div id=\"pricing\">\n        <Pricing />\n      </div>\n      \n      <footer className=\"border-t border-border bg-card py-12\">\n        <div className=\"max-w-7xl mx-auto px-4\">\n          <div className=\"grid md:grid-cols-4 gap-8\">\n            <div className=\"md:col-span-2\">\n              <div className=\"flex items-center gap-2 mb-4\">\n                <div className=\"w-10 h-10 rounded-lg bg-primary flex items-center justify-center\">\n                  <Zap className=\"w-5 h-5 text-primary-foreground\" />\n                </div>\n                <span className=\"font-display text-xl\">TrainSmart</span>\n              </div>\n              <p className=\"text-sm text-muted-foreground max-w-sm\">\n                Allenamento intelligente basato sulla scienza per raggiungere i tuoi obiettivi fitness in modo sicuro ed efficace.\n              </p>\n            </div>\n            \n            <div>\n              <h4 className=\"font-semibold mb-3\">Prodotto</h4>\n              <ul className=\"space-y-2 text-sm text-muted-foreground\">\n                <li><a href=\"#\" className=\"hover:text-foreground transition-colors\">Funzionalit√†</a></li>\n                <li><a href=\"#\" className=\"hover:text-foreground transition-colors\">Prezzi</a></li>\n                <li><a href=\"#\" className=\"hover:text-foreground transition-colors\">FAQ</a></li>\n              </ul>\n            </div>\n            \n            <div>\n              <h4 className=\"font-semibold mb-3\">Legale</h4>\n              <ul className=\"space-y-2 text-sm text-muted-foreground\">\n                <li><a href=\"#\" className=\"hover:text-foreground transition-colors\">Privacy</a></li>\n                <li><a href=\"#\" className=\"hover:text-foreground transition-colors\">Termini</a></li>\n                <li><a href=\"#\" className=\"hover:text-foreground transition-colors\">Cookie</a></li>\n              </ul>\n            </div>\n          </div>\n          \n          <div className=\"mt-12 pt-8 border-t border-border text-center text-sm text-muted-foreground\">\n            <p>¬© 2025 TrainSmart. Tutti i diritti riservati.</p>\n          </div>\n        </div>\n      </footer>\n    </div>\n  );\n}\n","size_bytes":2620},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":978},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport {\n  pgTable,\n  varchar,\n  timestamp,\n  jsonb,\n  index,\n  boolean,\n  integer,\n  decimal,\n  text,\n} from \"drizzle-orm/pg-core\";\n\n// ===== AUTHENTICATION =====\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  subscriptionTier: varchar(\"subscription_tier\").default(\"base\"), // base, premium, elite\n  subscriptionStartDate: timestamp(\"subscription_start_date\"),\n  subscriptionId: varchar(\"subscription_id\"), // Stripe subscription ID\n  aiCorrectionsUsed: integer(\"ai_corrections_used\").default(0), // per Premium (max 1/settimana)\n  lastAiCorrectionDate: timestamp(\"last_ai_correction_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// ===== FITNESS DATA =====\n\n// Screening (onboarding iniziale)\nexport const screenings = pgTable(\"screenings\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  goal: varchar(\"goal\").notNull(), // weight_loss, muscle_gain, strength, endurance, toning, pregnancy, disability\n  objectiveType: varchar(\"objective_type\"), // fitness, rehab, performance\n  sportType: varchar(\"sport_type\"), // per performance\n  sportRole: varchar(\"sport_role\"), // ruolo specifico per sport (es. portiere, difensore per calcio)\n  specificBodyParts: jsonb(\"specific_body_parts\").$type<string[]>(), // per toning e muscle_gain (chest, arms, shoulders, etc.)\n  disabilityType: varchar(\"disability_type\"), // tipo specifico di disabilit√† motoria (paraplegia, emiplegia, amputazione, etc.)\n  pregnancyWeek: integer(\"pregnancy_week\"), // settimana di gestazione (1-40)\n  pregnancyTrimester: integer(\"pregnancy_trimester\"), // trimestre (1, 2, 3)\n  hasDoctorClearance: boolean(\"has_doctor_clearance\"), // autorizzazione medica per allenarsi\n  pregnancyComplications: jsonb(\"pregnancy_complications\").$type<string[]>(), // complicazioni (pre-eclampsia, diabete gestazionale, etc.)\n  bodyWeight: decimal(\"body_weight\", { precision: 5, scale: 2 }),\n  level: varchar(\"level\").notNull(), // beginner, intermediate, advanced\n  location: varchar(\"location\"), // gym, home, mixed\n  hasGym: boolean(\"has_gym\").notNull(),\n  equipment: jsonb(\"equipment\").$type<{\n    barbell?: boolean;\n    dumbbellMaxKg?: number;\n    kettlebellKg?: number[];\n    bands?: boolean;\n    pullupBar?: boolean;\n    bench?: boolean;\n  }>(),\n  frequency: integer(\"frequency\").notNull(), // giorni/settimana\n  painAreas: jsonb(\"pain_areas\").$type<string[]>().default([]),\n  preferredSplit: varchar(\"preferred_split\"), // full_body, upper_lower, ppl\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Quiz biomeccanico\nexport const quizResults = pgTable(\"quiz_results\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  score: integer(\"score\").notNull(),\n  totalQuestions: integer(\"total_questions\").notNull(),\n  answers: jsonb(\"answers\").$type<Record<string, any>>(),\n  difficulty: varchar(\"difficulty\").notNull(), // beginner, intermediate, advanced\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Assessment (test 10RM)\nexport const assessments = pgTable(\"assessments\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  weight: varchar(\"weight\").notNull(), // stored as string per decimali\n  reps: integer(\"reps\").notNull(),\n  oneRepMax: varchar(\"one_rep_max\").notNull(), // calcolato con Brzycki\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Programmi generati\nexport const programs = pgTable(\"programs\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  name: varchar(\"name\").notNull(),\n  description: text(\"description\"),\n  split: varchar(\"split\").notNull(), // full_body, upper_lower, ppl\n  daysPerWeek: integer(\"days_per_week\").notNull(),\n  weeklySchedule: jsonb(\"weekly_schedule\").$type<any[]>(), // array di giorni allenamento\n  progression: varchar(\"progression\").notNull(), // wave_loading, ondulata, lineare\n  includesDeload: boolean(\"includes_deload\").default(false), // se il programma include settimane di deload\n  deloadFrequency: integer(\"deload_frequency\"), // ogni quante settimane fare deload (es. 4 = deload ogni 4 settimane)\n  totalWeeks: integer(\"total_weeks\"), // durata totale programma in settimane\n  requiresEndCycleTest: boolean(\"requires_end_cycle_test\").default(false), // se richiede test finale a fine ciclo\n  isActive: boolean(\"is_active\").default(true),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Workout sessions\nexport const workouts = pgTable(\"workouts\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  programId: varchar(\"program_id\").references(() => programs.id, {\n    onDelete: \"set null\",\n  }),\n  dayName: varchar(\"day_name\").notNull(),\n  status: varchar(\"status\").notNull().default(\"in_progress\"), // in_progress, completed, skipped\n  startedAt: timestamp(\"started_at\").defaultNow(),\n  completedAt: timestamp(\"completed_at\"),\n  duration: integer(\"duration\"), // minuti\n  totalVolume: decimal(\"total_volume\", { precision: 10, scale: 2 }), // kg totali sollevati\n  sleepHours: varchar(\"sleep_hours\"),\n  energyLevel: integer(\"energy_level\"), // 1-10\n  painLevel: integer(\"pain_level\"), // 0-10\n  painLocation: varchar(\"pain_location\"),\n  preWorkoutNotes: text(\"pre_workout_notes\"),\n  postWorkoutNotes: text(\"post_workout_notes\"),\n});\n\n// Serie allenamento\nexport const workoutSets = pgTable(\"workout_sets\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  workoutId: varchar(\"workout_id\")\n    .notNull()\n    .references(() => workouts.id, { onDelete: \"cascade\" }),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  setNumber: integer(\"set_number\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  weight: varchar(\"weight\").notNull(), // string per decimali\n  rpe: integer(\"rpe\"), // Rate of Perceived Exertion 1-10\n  isWarmup: boolean(\"is_warmup\").default(false),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Adattamenti temporanei workout (per cambiare location al volo)\nexport const workoutAdaptations = pgTable(\"workout_adaptations\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  programId: varchar(\"program_id\")\n    .notNull()\n    .references(() => programs.id, { onDelete: \"cascade\" }),\n  dayName: varchar(\"day_name\").notNull(),\n  location: varchar(\"location\").notNull(), // gym, home\n  equipment: jsonb(\"equipment\").$type<{\n    barbell?: boolean;\n    dumbbellMaxKg?: number;\n    kettlebellKg?: number[];\n    bands?: boolean;\n    pullupBar?: boolean;\n    bench?: boolean;\n  }>(),\n  adaptedExercises: jsonb(\"adapted_exercises\").$type<any[]>(),\n  used: boolean(\"used\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Progressi settimanali\nexport const weeklyProgress = pgTable(\"weekly_progress\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  weekStart: timestamp(\"week_start\").notNull(),\n  workoutsCompleted: integer(\"workouts_completed\").default(0),\n  totalVolume: decimal(\"total_volume\", { precision: 10, scale: 2 }).default(\n    \"0\",\n  ),\n  avgPainLevel: decimal(\"avg_pain_level\", { precision: 3, scale: 2 }),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Personal Records\nexport const personalRecords = pgTable(\"personal_records\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  weight: varchar(\"weight\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  oneRepMax: varchar(\"one_rep_max\").notNull(),\n  achievedAt: timestamp(\"achieved_at\").defaultNow(),\n});\n\n// Pagamenti\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\")\n    .primaryKey()\n    .default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\")\n    .notNull()\n    .references(() => users.id, { onDelete: \"cascade\" }),\n  subscriptionTier: varchar(\"subscription_tier\").notNull(), // base, premium, elite\n  amount: varchar(\"amount\").notNull(),\n  currency: varchar(\"currency\").default(\"EUR\"),\n  provider: varchar(\"provider\").notNull(), // stripe, paypal\n  status: varchar(\"status\").notNull(), // pending, completed, failed, refunded\n  transactionId: varchar(\"transaction_id\"),\n  subscriptionId: varchar(\"subscription_id\"), // Per gestire rinnovi Stripe\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// ===== TYPES =====\nexport type User = typeof users.$inferSelect;\nexport type UpsertUser = typeof users.$inferInsert;\n\nexport type Screening = typeof screenings.$inferSelect;\nexport type InsertScreening = typeof screenings.$inferInsert;\n\nexport type QuizResult = typeof quizResults.$inferSelect;\nexport type InsertQuizResult = typeof quizResults.$inferInsert;\n\nexport type Assessment = typeof assessments.$inferSelect;\nexport type InsertAssessment = typeof assessments.$inferInsert;\n\nexport type Program = typeof programs.$inferSelect;\nexport type InsertProgram = typeof programs.$inferInsert;\n\nexport type Workout = typeof workouts.$inferSelect;\nexport type InsertWorkout = typeof workouts.$inferInsert;\n\nexport type WorkoutSet = typeof workoutSets.$inferSelect;\nexport type InsertWorkoutSet = typeof workoutSets.$inferInsert;\n\nexport type WeeklyProgress = typeof weeklyProgress.$inferSelect;\n\nexport type WorkoutAdaptation = typeof workoutAdaptations.$inferSelect;\nexport type InsertWorkoutAdaptation = typeof workoutAdaptations.$inferInsert;\n\nexport type PersonalRecord = typeof personalRecords.$inferSelect;\n\nexport type Payment = typeof payments.$inferSelect;\nexport type InsertPayment = typeof payments.$inferInsert;\n","size_bytes":11044},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading, error } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n    refetchOnMount: false,\n    refetchOnWindowFocus: false,\n    refetchOnReconnect: false,\n  });\n\n  // Se c'√® un errore di rate limit, assumiamo non autenticato\n  if (error) {\n    return {\n      user: null,\n      isLoading: false,\n      isAuthenticated: false,\n    };\n  }\n\n  return {\n    user: user || null,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}\n","size_bytes":595},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/PaymentModal.tsx":{"content":"import { useState } from \"react\";\nimport { X, CreditCard, Loader2, Check, Crown, Sparkles, Zap } from \"lucide-react\";\nimport type { SubscriptionTier } from \"@shared/pricingUtils\";\nimport { getPlan } from \"@shared/pricingUtils\";\n\ninterface PaymentModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  onSuccess?: () => void;\n  tier: SubscriptionTier;\n}\n\nexport default function PaymentModal({ isOpen, onClose, onSuccess, tier }: PaymentModalProps) {\n  const [selectedMethod, setSelectedMethod] = useState<\"stripe\" | \"paypal\" | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n\n  const plan = getPlan(tier);\n\n  if (!isOpen) return null;\n\n  const handleStripeCheckout = async () => {\n    setLoading(true);\n    setError(\"\");\n\n    try {\n      const res = await fetch(\"/api/payment/stripe/checkout\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ tier }),\n      });\n\n      if (!res.ok) throw new Error(\"Failed to create checkout session\");\n\n      const { url } = await res.json();\n\n      // Redirect to Stripe Checkout\n      window.location.href = url;\n    } catch (err) {\n      setError(\"Errore nella creazione del pagamento. Riprova.\");\n      setLoading(false);\n    }\n  };\n\n  const handlePayPalCheckout = async () => {\n    setLoading(true);\n    setError(\"\");\n\n    try {\n      const res = await fetch(\"/api/payment/paypal/create\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ tier }),\n      });\n\n      if (!res.ok) throw new Error(\"Failed to create PayPal order\");\n\n      const { approvalUrl } = await res.json();\n\n      // Redirect to PayPal\n      window.location.href = approvalUrl;\n    } catch (err) {\n      setError(\"Errore nella creazione del pagamento PayPal. Riprova.\");\n      setLoading(false);\n    }\n  };\n\n  const handlePayment = () => {\n    if (selectedMethod === \"stripe\") {\n      handleStripeCheckout();\n    } else if (selectedMethod === \"paypal\") {\n      handlePayPalCheckout();\n    }\n  };\n\n  const tierIcon = {\n    base: Crown,\n    premium: Sparkles,\n    elite: Zap,\n  }[tier];\n\n  const TierIcon = tierIcon;\n\n  return (\n    <div className=\"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4\">\n      <div className=\"bg-card rounded-2xl max-w-md w-full max-h-[90vh] overflow-y-auto my-8 relative border\">\n        <div className=\"p-6 pb-8\">\n          {/* Close Button */}\n          <button\n            onClick={onClose}\n            className=\"absolute top-4 right-4 text-muted-foreground hover:text-foreground z-10\"\n            data-testid=\"button-close-payment\"\n          >\n            <X className=\"w-6 h-6\" />\n          </button>\n\n          {/* Header */}\n          <div className=\"text-center mb-6\">\n            <div className=\"w-16 h-16 bg-primary rounded-2xl flex items-center justify-center mx-auto mb-4\">\n              <TierIcon className=\"w-8 h-8 text-primary-foreground\" />\n            </div>\n            <h2 className=\"text-2xl font-bold mb-2\">Abbonamento {plan.name}</h2>\n            <p className=\"text-muted-foreground text-sm\">\n              {plan.description}\n            </p>\n          </div>\n\n          {/* Features */}\n          <div className=\"bg-muted/50 rounded-xl p-4 mb-6\">\n            <h3 className=\"font-semibold mb-3 flex items-center gap-2\">\n              <Check className=\"w-5 h-5 text-chart-3\" />\n              Cosa ottieni\n            </h3>\n            <ul className=\"space-y-2 text-sm text-muted-foreground\">\n              {plan.features.slice(0, 5).map((feature, idx) => (\n                <li key={idx} className=\"flex items-start gap-2\">\n                  <Check className=\"w-4 h-4 text-chart-3 flex-shrink-0 mt-0.5\" />\n                  <span>{feature}</span>\n                </li>\n              ))}\n            </ul>\n          </div>\n\n          {/* Price */}\n          <div className=\"text-center mb-6\">\n            <p className=\"text-4xl font-bold mb-1\">‚Ç¨{plan.basePrice.toFixed(2)}</p>\n            <p className=\"text-muted-foreground text-sm\">\n              /mese\n            </p>\n            <p className=\"text-xs text-muted-foreground mt-1\">\n              Primi 6 mesi: ‚Ç¨{plan.basePrice.toFixed(2)}/mese, poi ‚Ç¨{plan.increasedPrice.toFixed(2)}/mese\n            </p>\n          </div>\n\n          {/* Payment Methods */}\n          <div className=\"space-y-3 mb-6\">\n            <button\n              onClick={() => setSelectedMethod(\"stripe\")}\n              className={`w-full p-4 rounded-xl border-2 transition-all hover-elevate ${\n                selectedMethod === \"stripe\"\n                  ? \"border-primary bg-primary/10\"\n                  : \"border-border\"\n              }`}\n              data-testid=\"button-payment-stripe\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 bg-primary rounded-lg flex items-center justify-center\">\n                  <CreditCard className=\"w-5 h-5 text-primary-foreground\" />\n                </div>\n                <div className=\"text-left flex-1\">\n                  <p className=\"font-semibold\">Carta di Credito/Debito</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Pagamento sicuro con Stripe\n                  </p>\n                </div>\n                {selectedMethod === \"stripe\" && (\n                  <Check className=\"w-5 h-5 text-chart-3\" />\n                )}\n              </div>\n            </button>\n\n            <button\n              onClick={() => setSelectedMethod(\"paypal\")}\n              className={`w-full p-4 rounded-xl border-2 transition-all hover-elevate ${\n                selectedMethod === \"paypal\"\n                  ? \"border-primary bg-primary/10\"\n                  : \"border-border\"\n              }`}\n              data-testid=\"button-payment-paypal\"\n            >\n              <div className=\"flex items-center gap-3\">\n                <div className=\"w-10 h-10 bg-[#0070ba] rounded-lg flex items-center justify-center\">\n                  <svg\n                    className=\"w-6 h-6 text-white\"\n                    viewBox=\"0 0 24 24\"\n                    fill=\"currentColor\"\n                  >\n                    <path d=\"M7.076 21.337H2.47a.641.641 0 0 1-.633-.74L4.944 2.84a.77.77 0 0 1 .759-.64h8.936c2.886 0 4.935 2.092 4.535 4.633-.485 3.087-2.837 5.184-5.723 5.184h-3.51a.77.77 0 0 0-.758.64l-1.107 7.04z\" />\n                  </svg>\n                </div>\n                <div className=\"text-left flex-1\">\n                  <p className=\"font-semibold\">PayPal</p>\n                  <p className=\"text-xs text-muted-foreground\">\n                    Pagamento rapido e sicuro\n                  </p>\n                </div>\n                {selectedMethod === \"paypal\" && (\n                  <Check className=\"w-5 h-5 text-chart-3\" />\n                )}\n              </div>\n            </button>\n          </div>\n\n          {/* Error Message */}\n          {error && (\n            <div className=\"bg-destructive/10 border border-destructive/30 rounded-lg p-3 mb-4 text-sm text-destructive\">\n              {error}\n            </div>\n          )}\n\n          {/* Checkout Button */}\n          <button\n            onClick={handlePayment}\n            disabled={!selectedMethod || loading}\n            className=\"w-full py-4 bg-primary hover:bg-primary/90 disabled:bg-muted disabled:cursor-not-allowed rounded-xl font-semibold text-lg transition-colors flex items-center justify-center gap-2 text-primary-foreground\"\n            data-testid=\"button-proceed-payment\"\n          >\n            {loading ? (\n              <>\n                <Loader2 className=\"w-5 h-5 animate-spin\" />\n                Reindirizzamento...\n              </>\n            ) : (\n              <>\n                <TierIcon className=\"w-5 h-5\" />\n                Procedi al Pagamento\n              </>\n            )}\n          </button>\n\n          {/* Security Note */}\n          <p className=\"text-center text-xs text-muted-foreground mt-4\">\n            üîí Pagamenti sicuri ‚Ä¢ Nessun dato salvato sui nostri server\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8183},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"server/db.ts":{"content":"import { Pool, neonConfig } from \"@neondatabase/serverless\";\nimport { drizzle } from \"drizzle-orm/neon-serverless\";\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","size_bytes":483},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/components/examples/WorkoutTracker.tsx":{"content":"import WorkoutTracker from '../WorkoutTracker';\n\nexport default function WorkoutTrackerExample() {\n  return <WorkoutTracker />;\n}\n","size_bytes":130},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/components/examples/Features.tsx":{"content":"import Features from '../Features';\n\nexport default function FeaturesExample() {\n  return <Features />;\n}\n","size_bytes":106},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 0 0% 98%;\n\n  --foreground: 0 0% 12%;\n\n  --border: 0 0% 88%;\n\n  --card: 0 0% 96%;\n\n  --card-foreground: 0 0% 12%;\n\n  --card-border: 0 0% 90%;\n\n  --sidebar: 0 0% 94%;\n\n  --sidebar-foreground: 0 0% 12%;\n\n  --sidebar-border: 0 0% 88%;\n\n  --sidebar-primary: 160 85% 45%;\n\n  --sidebar-primary-foreground: 160 85% 98%;\n\n  --sidebar-accent: 160 8% 88%;\n\n  --sidebar-accent-foreground: 160 8% 20%;\n\n  --sidebar-ring: 160 85% 45%;\n\n  --popover: 0 0% 92%;\n\n  --popover-foreground: 0 0% 12%;\n\n  --popover-border: 0 0% 86%;\n\n  --primary: 160 85% 45%;\n\n  --primary-foreground: 160 85% 98%;\n\n  --secondary: 0 0% 88%;\n\n  --secondary-foreground: 0 0% 12%;\n\n  --muted: 160 6% 90%;\n\n  --muted-foreground: 160 6% 35%;\n\n  --accent: 160 12% 88%;\n\n  --accent-foreground: 160 12% 20%;\n\n  --destructive: 0 84% 48%;\n\n  --destructive-foreground: 0 84% 98%;\n\n  --input: 0 0% 65%;\n  --ring: 160 85% 45%;\n  --chart-1: 160 85% 35%;\n  --chart-2: 15 90% 48%;\n  --chart-3: 145 65% 42%;\n  --chart-4: 210 80% 48%;\n  --chart-5: 35 90% 52%;\n\n  --font-sans: Inter, -apple-system, BlinkMacSystemFont, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: JetBrains Mono, Menlo, monospace;\n  --font-display: Archivo Black, sans-serif;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 1px 2px 0px hsl(0 0% 0% / 0.05);\n  --shadow-xs: 0px 1px 3px 0px hsl(0 0% 0% / 0.08);\n  --shadow-sm: 0px 2px 4px 0px hsl(0 0% 0% / 0.06), 0px 1px 2px -1px hsl(0 0% 0% / 0.04);\n  --shadow: 0px 4px 6px -1px hsl(0 0% 0% / 0.08), 0px 2px 4px -2px hsl(0 0% 0% / 0.05);\n  --shadow-md: 0px 6px 8px -1px hsl(0 0% 0% / 0.10), 0px 2px 4px -2px hsl(0 0% 0% / 0.06);\n  --shadow-lg: 0px 10px 15px -3px hsl(0 0% 0% / 0.12), 0px 4px 6px -4px hsl(0 0% 0% / 0.08);\n  --shadow-xl: 0px 20px 25px -5px hsl(0 0% 0% / 0.14), 0px 8px 10px -6px hsl(0 0% 0% / 0.10);\n  --shadow-2xl: 0px 25px 50px -12px hsl(0 0% 0% / 0.20);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 220 15% 10%;\n\n  --foreground: 0 0% 95%;\n\n  --border: 220 12% 22%;\n\n  --card: 220 12% 16%;\n\n  --card-foreground: 0 0% 95%;\n\n  --card-border: 220 12% 20%;\n\n  --sidebar: 220 12% 14%;\n\n  --sidebar-foreground: 0 0% 95%;\n\n  --sidebar-border: 220 12% 18%;\n\n  --sidebar-primary: 160 85% 45%;\n\n  --sidebar-primary-foreground: 160 85% 98%;\n\n  --sidebar-accent: 220 10% 20%;\n\n  --sidebar-accent-foreground: 0 0% 95%;\n\n  --sidebar-ring: 160 85% 45%;\n\n  --popover: 220 12% 18%;\n\n  --popover-foreground: 0 0% 95%;\n\n  --popover-border: 220 12% 24%;\n\n  --primary: 160 85% 45%;\n\n  --primary-foreground: 160 85% 98%;\n\n  --secondary: 220 10% 22%;\n\n  --secondary-foreground: 0 0% 95%;\n\n  --muted: 220 8% 20%;\n\n  --muted-foreground: 0 0% 88%;\n\n  --accent: 220 8% 18%;\n\n  --accent-foreground: 0 0% 95%;\n\n  --destructive: 0 84% 48%;\n\n  --destructive-foreground: 0 84% 98%;\n\n  --input: 220 12% 35%;\n  --ring: 160 85% 45%;\n  --chart-1: 160 85% 55%;\n  --chart-2: 15 90% 65%;\n  --chart-3: 145 65% 58%;\n  --chart-4: 210 80% 62%;\n  --chart-5: 35 90% 68%;\n\n  --shadow-2xs: 0px 1px 2px 0px hsl(0 0% 0% / 0.40);\n  --shadow-xs: 0px 1px 3px 0px hsl(0 0% 0% / 0.45);\n  --shadow-sm: 0px 2px 4px 0px hsl(0 0% 0% / 0.42), 0px 1px 2px -1px hsl(0 0% 0% / 0.38);\n  --shadow: 0px 4px 6px -1px hsl(0 0% 0% / 0.48), 0px 2px 4px -2px hsl(0 0% 0% / 0.42);\n  --shadow-md: 0px 6px 8px -1px hsl(0 0% 0% / 0.52), 0px 2px 4px -2px hsl(0 0% 0% / 0.45);\n  --shadow-lg: 0px 10px 15px -3px hsl(0 0% 0% / 0.58), 0px 4px 6px -4px hsl(0 0% 0% / 0.50);\n  --shadow-xl: 0px 20px 25px -5px hsl(0 0% 0% / 0.65), 0px 8px 10px -6px hsl(0 0% 0% / 0.55);\n  --shadow-2xl: 0px 25px 50px -12px hsl(0 0% 0% / 0.75);\n\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}","size_bytes":9808},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/examples/Dashboard.tsx":{"content":"import Dashboard from '../Dashboard';\n\nexport default function DashboardExample() {\n  return <Dashboard />;\n}\n","size_bytes":110},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/examples/Header.tsx":{"content":"import Header from '../Header';\n\nexport default function HeaderExample() {\n  return <Header />;\n}\n","size_bytes":98},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/examples/QuizComponent.tsx":{"content":"import QuizComponent from '../QuizComponent';\n\nexport default function QuizComponentExample() {\n  return <QuizComponent />;\n}\n","size_bytes":126},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/PreWorkoutCheck.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Slider } from \"@/components/ui/slider\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { Moon, Battery, AlertCircle, ChevronRight, Info, TrendingUp, CheckCircle, RefreshCw } from \"lucide-react\";\n\n// Distretti muscolari disponibili\nconst MUSCLE_DISTRICTS = [\n  { value: \"spalla_dx\", label: \"Spalla Destra\", affectedExercises: [\"bench\", \"press\", \"row\"] },\n  { value: \"spalla_sx\", label: \"Spalla Sinistra\", affectedExercises: [\"bench\", \"press\", \"row\"] },\n  { value: \"gomito_dx\", label: \"Gomito Destro\", affectedExercises: [\"bench\", \"press\", \"row\"] },\n  { value: \"gomito_sx\", label: \"Gomito Sinistro\", affectedExercises: [\"bench\", \"press\", \"row\"] },\n  { value: \"polso_dx\", label: \"Polso Destro\", affectedExercises: [\"bench\", \"press\"] },\n  { value: \"polso_sx\", label: \"Polso Sinistro\", affectedExercises: [\"bench\", \"press\"] },\n  { value: \"schiena_alta\", label: \"Schiena Alta\", affectedExercises: [\"row\", \"deadlift\", \"squat\"] },\n  { value: \"schiena_bassa\", label: \"Schiena Bassa\", affectedExercises: [\"deadlift\", \"squat\"] },\n  { value: \"anca_dx\", label: \"Anca Destra\", affectedExercises: [\"squat\", \"deadlift\"] },\n  { value: \"anca_sx\", label: \"Anca Sinistra\", affectedExercises: [\"squat\", \"deadlift\"] },\n  { value: \"ginocchio_dx\", label: \"Ginocchio Destro\", affectedExercises: [\"squat\"] },\n  { value: \"ginocchio_sx\", label: \"Ginocchio Sinistro\", affectedExercises: [\"squat\"] },\n  { value: \"caviglia_dx\", label: \"Caviglia Destra\", affectedExercises: [\"squat\"] },\n  { value: \"caviglia_sx\", label: \"Caviglia Sinistra\", affectedExercises: [\"squat\"] },\n];\n\ninterface PreWorkoutCheckProps {\n  workout: any; // Il workout corrente con esercizi\n  onComplete: (data: PreWorkoutData) => void;\n  onSkip: () => void;\n}\n\nexport interface PreWorkoutData {\n  sleepHours: number;\n  energyLevel: number;\n  painLevel: number;\n  painLocation?: string;\n  notes?: string;\n  loadReduction?: number;\n  affectedExercises?: string[];\n  availableWeights?: Record<string, { planned: number; available: number }>;\n}\n\nexport default function PreWorkoutCheck({ workout, onComplete, onSkip }: PreWorkoutCheckProps) {\n  const [sleepHours, setSleepHours] = useState<number>(7);\n  const [energyLevel, setEnergyLevel] = useState<number[]>([7]);\n  const [painLevel, setPainLevel] = useState<number[]>([1]);\n  const [painLocation, setPainLocation] = useState(\"\");\n  const [notes, setNotes] = useState(\"\");\n  const [availableWeights, setAvailableWeights] = useState<Record<string, { planned: number; available: number }>>({});\n\n  const { toast } = useToast();\n\n  // Recupera analisi dolore persistente\n  const { data: painAnalysisData } = useQuery({\n    queryKey: [\"/api/workout/pain-analysis\"]\n  });\n\n  // Mutazione per ricalibrazione programma\n  const recalibrateMutation = useMutation({\n    mutationFn: () => apiRequest(\"/api/program/recalibrate\", {\n      method: \"POST\"\n    }),\n    onSuccess: (data: any) => {\n      toast({\n        title: \"Programma ricalibrato!\",\n        description: data.message,\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/program/active\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/workout/pain-analysis\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"Errore\",\n        description: error.message || \"Impossibile ricalibra il programma\",\n        variant: \"destructive\",\n      });\n    }\n  });\n\n  const handleSubmit = () => {\n    onComplete({\n      sleepHours,\n      energyLevel: energyLevel[0],\n      painLevel: painLevel[0],\n      painLocation: painLevel[0] > 0 ? painLocation : undefined,\n      notes: notes || undefined,\n      loadReduction: suggestion.loadReduction,\n      affectedExercises: suggestion.affectedExercises,\n      availableWeights: Object.keys(availableWeights).length > 0 ? availableWeights : undefined\n    });\n  };\n\n  const getEnergyLabel = (value: number) => {\n    if (value <= 3) return \"Molto stanco\";\n    if (value <= 5) return \"Poco riposato\";\n    if (value <= 7) return \"Discreto\";\n    if (value <= 9) return \"Bene\";\n    return \"Ottimo!\";\n  };\n\n  const getPainLabel = (value: number) => {\n    if (value === 1) return \"Nessun dolore\";\n    if (value <= 3) return \"Leggero fastidio\";\n    if (value <= 5) return \"Dolore moderato\";\n    if (value <= 7) return \"Dolore importante\";\n    return \"Dolore significativo\";\n  };\n\n  const getWorkoutSuggestion = () => {\n    const energy = energyLevel[0];\n    const pain = painLevel[0];\n    const sleep = sleepHours;\n\n    // Calcola riduzione carico basata su dolore e distretto\n    const selectedDistrict = MUSCLE_DISTRICTS.find(d => d.value === painLocation);\n    let loadReduction = 0;\n    let affectedExercisesList = \"\";\n\n    if (pain > 0 && selectedDistrict) {\n      // Calcola riduzione percentuale basata sul livello di dolore\n      if (pain >= 8) {\n        loadReduction = 40;\n      } else if (pain >= 6) {\n        loadReduction = 30;\n      } else if (pain >= 4) {\n        loadReduction = 20;\n      } else if (pain >= 2) {\n        loadReduction = 10;\n      }\n\n      // Lista esercizi interessati\n      const exerciseNames = selectedDistrict.affectedExercises.map(ex => {\n        switch(ex) {\n          case \"bench\": return \"Panca\";\n          case \"squat\": return \"Squat\";\n          case \"deadlift\": return \"Stacco\";\n          case \"row\": return \"Rematore/Pulley\";\n          case \"press\": return \"Military Press\";\n          default: return ex;\n        }\n      });\n      affectedExercisesList = exerciseNames.join(\", \");\n    }\n\n    if (pain >= 7) {\n      return {\n        type: \"warning\",\n        message: `Dolore significativo a ${selectedDistrict?.label || 'distretto selezionato'}. Ridurremo automaticamente il carico del ${loadReduction}% per gli esercizi: ${affectedExercisesList}. Procedi con cautela.`,\n        adjustment: `Riduzione carico ${loadReduction}% su: ${affectedExercisesList}`,\n        loadReduction,\n        affectedExercises: selectedDistrict?.affectedExercises || []\n      };\n    }\n\n    if (energy <= 4 || sleep < 5) {\n      return {\n        type: \"warning\",\n        message: \"Recupero insufficiente. Ti consiglio di ridurre il volume del 20-30% per evitare sovrallenamento.\",\n        adjustment: \"Riduzione volume 20-30%\",\n        loadReduction: 0,\n        affectedExercises: []\n      };\n    }\n\n    if (pain >= 4 && selectedDistrict) {\n      return {\n        type: \"caution\",\n        message: `Dolore moderato a ${selectedDistrict.label}. Ridurremo il carico del ${loadReduction}% per: ${affectedExercisesList}. Monitora attentamente.`,\n        adjustment: `Riduzione carico ${loadReduction}% su: ${affectedExercisesList}`,\n        loadReduction,\n        affectedExercises: selectedDistrict.affectedExercises\n      };\n    }\n\n    if (pain >= 2 && selectedDistrict) {\n      return {\n        type: \"caution\",\n        message: `Leggero fastidio a ${selectedDistrict.label}. Per sicurezza ridurremo il carico del ${loadReduction}% per: ${affectedExercisesList}.`,\n        adjustment: `Riduzione carico ${loadReduction}% su: ${affectedExercisesList}`,\n        loadReduction,\n        affectedExercises: selectedDistrict.affectedExercises\n      };\n    }\n\n    return {\n      type: \"success\",\n      message: \"Ottime condizioni! Sei pronto per un allenamento produttivo.\",\n      adjustment: \"Nessuna modifica necessaria\",\n      loadReduction: 0,\n      affectedExercises: []\n    };\n  };\n\n  const suggestion = getWorkoutSuggestion();\n\n  // Filtra esercizi con peso dal workout\n  const exercisesWithWeight = workout?.exercises?.filter((ex: any) => ex.weight && ex.weight > 0) || [];\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center py-12\">\n      <div className=\"max-w-2xl mx-auto px-4 w-full\">\n        <Card>\n          <CardHeader className=\"text-center\">\n            <CardTitle className=\"text-2xl\">Check Pre-Allenamento</CardTitle>\n            <CardDescription>\n              Rispondi a queste domande per ottimizzare la tua sessione\n            </CardDescription>\n          </CardHeader>\n\n          <CardContent className=\"space-y-6\">\n            {/* Ore di sonno */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <Moon className=\"w-5 h-5 text-primary\" />\n                <Label className=\"text-base font-semibold\">Quante ore hai dormito?</Label>\n              </div>\n              <div className=\"flex items-center gap-4\">\n                <Input\n                  type=\"number\"\n                  min={0}\n                  max={12}\n                  step={0.5}\n                  value={sleepHours}\n                  onChange={(e) => setSleepHours(parseFloat(e.target.value) || 0)}\n                  className=\"w-24\"\n                  data-testid=\"input-sleep-hours\"\n                />\n                <span className=\"text-sm text-muted-foreground\">ore</span>\n              </div>\n            </div>\n\n            {/* Livello energia */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <Battery className=\"w-5 h-5 text-primary\" />\n                <Label className=\"text-base font-semibold\">Come ti senti riposato?</Label>\n              </div>\n              <div className=\"space-y-2\">\n                <Slider\n                  value={energyLevel}\n                  onValueChange={setEnergyLevel}\n                  min={1}\n                  max={10}\n                  step={1}\n                  className=\"w-full\"\n                  data-testid=\"slider-energy\"\n                />\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\n                  <span>1 - Stanchissimo</span>\n                  <span className=\"font-semibold text-primary\">{energyLevel[0]} - {getEnergyLabel(energyLevel[0])}</span>\n                  <span>10 - Perfetto</span>\n                </div>\n              </div>\n            </div>\n\n            {/* Livello dolore */}\n            <div className=\"space-y-3\">\n              <div className=\"flex items-center gap-2\">\n                <AlertCircle className=\"w-5 h-5 text-primary\" />\n                <Label className=\"text-base font-semibold\">Hai qualche dolore?</Label>\n              </div>\n              <div className=\"space-y-2\">\n                <Slider\n                  value={painLevel}\n                  onValueChange={setPainLevel}\n                  min={1}\n                  max={10}\n                  step={1}\n                  className=\"w-full\"\n                  data-testid=\"slider-pain\"\n                />\n                <div className=\"flex justify-between text-xs text-muted-foreground\">\n                  <span>1 - Nessuno</span>\n                  <span className=\"font-semibold text-primary\">{painLevel[0]} - {getPainLabel(painLevel[0])}</span>\n                  <span>10 - Molto forte</span>\n                </div>\n              </div>\n\n              {painLevel[0] > 1 && (\n                <div className=\"mt-3\">\n                  <Label className=\"text-sm font-semibold\">Seleziona il distretto dolorante</Label>\n                  <Select value={painLocation} onValueChange={setPainLocation}>\n                    <SelectTrigger className=\"mt-1\" data-testid=\"select-pain-location\">\n                      <SelectValue placeholder=\"Scegli dove senti dolore...\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {MUSCLE_DISTRICTS.map((district) => (\n                        <SelectItem key={district.value} value={district.value}>\n                          {district.label}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n              )}\n            </div>\n\n            {/* Note opzionali */}\n            <div className=\"space-y-2\">\n              <Label className=\"text-sm\">Note aggiuntive (opzionale)</Label>\n              <Textarea\n                value={notes}\n                onChange={(e) => setNotes(e.target.value)}\n                placeholder=\"Qualsiasi altra cosa che vuoi annotare...\"\n                rows={2}\n                data-testid=\"input-notes\"\n              />\n            </div>\n\n            {/* Analisi dolore persistente */}\n            {painAnalysisData?.recoveryCheck?.canReturnToNormal && (\n              <div className=\"rounded-lg p-4 bg-emerald-500/10 border border-emerald-500/20\">\n                <div className=\"flex items-start gap-3\">\n                  <CheckCircle className=\"w-5 h-5 flex-shrink-0 mt-0.5 text-emerald-500\" />\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-semibold text-emerald-600 dark:text-emerald-400\">\n                      Recupero completato!\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-1 mb-3\">\n                      {painAnalysisData.recoveryCheck.message}\n                    </p>\n                    <Button\n                      size=\"sm\"\n                      variant=\"outline\"\n                      onClick={() => recalibrateMutation.mutate()}\n                      disabled={recalibrateMutation.isPending}\n                      className=\"gap-2\"\n                      data-testid=\"button-recalibrate\"\n                    >\n                      <RefreshCw className={`w-4 h-4 ${recalibrateMutation.isPending ? 'animate-spin' : ''}`} />\n                      {recalibrateMutation.isPending ? 'Ricalibrazione...' : 'Ricalibra Programma'}\n                    </Button>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {painAnalysisData?.painAnalysis?.isPersistent && !painAnalysisData?.recoveryCheck?.canReturnToNormal && (\n              <div className=\"rounded-lg p-4 bg-red-500/10 border border-red-500/20\">\n                <div className=\"flex items-start gap-3\">\n                  <TrendingUp className=\"w-5 h-5 flex-shrink-0 mt-0.5 text-red-500\" />\n                  <div className=\"flex-1\">\n                    <p className=\"text-sm font-semibold text-red-600 dark:text-red-400\">\n                      Attenzione: Dolore persistente rilevato\n                    </p>\n                    <p className=\"text-xs text-muted-foreground mt-1\">\n                      {painAnalysisData.painAnalysis.message}\n                    </p>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            {/* Suggerimento automatico */}\n            <div className={`rounded-lg p-4 ${\n              suggestion.type === 'warning' ? 'bg-amber-500/10 border border-amber-500/20' :\n              suggestion.type === 'caution' ? 'bg-blue-500/10 border border-blue-500/20' :\n              'bg-emerald-500/10 border border-emerald-500/20'\n            }`}>\n              <div className=\"flex items-start gap-3\">\n                <Info className={`w-5 h-5 flex-shrink-0 mt-0.5 ${\n                  suggestion.type === 'warning' ? 'text-amber-500' :\n                  suggestion.type === 'caution' ? 'text-blue-500' :\n                  'text-emerald-500'\n                }`} />\n                <div className=\"flex-1\">\n                  <p className={`text-sm ${\n                    suggestion.type === 'warning' ? 'text-amber-600 dark:text-amber-400' :\n                    suggestion.type === 'caution' ? 'text-blue-600 dark:text-blue-400' :\n                    'text-emerald-600 dark:text-emerald-400'\n                  }`}>\n                    {suggestion.message}\n                  </p>\n                  <p className=\"text-xs text-muted-foreground mt-1\">\n                    <strong>Modifica suggerita:</strong> {suggestion.adjustment}\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Pesi disponibili oggi */}\n            {exercisesWithWeight.length > 0 && (\n              <div className=\"space-y-3\">\n                <Label className=\"text-base font-semibold\">Peso disponibile oggi (opzionale)</Label>\n                <p className=\"text-xs text-muted-foreground\">\n                  Se hai meno peso del previsto, il sistema ricalcoler√† automaticamente serie/reps/tempo\n                </p>\n                \n                <div className=\"space-y-3\">\n                  {exercisesWithWeight.map((ex: any, idx: number) => {\n                    const planned = ex.weight || 0;\n                    const available = availableWeights[ex.name]?.available;\n                    const hasInput = available !== undefined && available !== '';\n                    const ratio = hasInput ? (Number(available) / planned) : 1;\n                    const needsCalibration = hasInput && ratio < 0.9;\n\n                    return (\n                      <div key={idx} className=\"bg-muted/50 p-3 rounded-lg space-y-2\">\n                        <div className=\"flex justify-between items-center\">\n                          <span className=\"text-sm font-semibold\">{ex.name}</span>\n                          <span className=\"text-xs text-primary\">Programmato: {planned}kg</span>\n                        </div>\n                        \n                        <Input\n                          type=\"number\"\n                          min={0}\n                          step={2.5}\n                          placeholder={`Peso disponibile (kg)`}\n                          value={availableWeights[ex.name]?.available || ''}\n                          onChange={(e) => {\n                            const val = parseFloat(e.target.value) || 0;\n                            setAvailableWeights(prev => ({\n                              ...prev,\n                              [ex.name]: { planned, available: val }\n                            }));\n                          }}\n                          className=\"w-full\"\n                          data-testid={`input-weight-${ex.name.toLowerCase().replace(/\\s/g, '-')}`}\n                        />\n\n                        {needsCalibration && (\n                          <div className=\"mt-2 p-2 bg-orange-500/10 border border-orange-500/30 rounded text-xs text-orange-600 dark:text-orange-400\">\n                            Peso ridotto del {Math.round((1 - ratio) * 100)}% ‚Üí Il sistema adatter√† automaticamente l'allenamento\n                          </div>\n                        )}\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            )}\n\n            {/* Actions */}\n            <div className=\"flex gap-3 pt-4\">\n              <Button\n                variant=\"outline\"\n                onClick={onSkip}\n                className=\"flex-1\"\n                data-testid=\"button-skip-check\"\n              >\n                Salta\n              </Button>\n              <Button\n                onClick={handleSubmit}\n                className=\"flex-1\"\n                data-testid=\"button-start-workout\"\n              >\n                Inizia Allenamento\n                <ChevronRight className=\"w-4 h-4 ml-2\" />\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":19561},"CODICE_COMPLETO.md":{"content":"# TrainSmart - Codice Completo Applicazione\n\n## üìÅ Struttura Progetto\n\n```\nTrainSmart/\n‚îú‚îÄ‚îÄ client/                    # Frontend React + TypeScript\n‚îÇ   ‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/       # Componenti React\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/           # Pagine dell'app\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ hooks/           # Custom hooks\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lib/             # Utilities\n‚îú‚îÄ‚îÄ server/                   # Backend Express + TypeScript\n‚îÇ   ‚îú‚îÄ‚îÄ routes.ts            # API Routes\n‚îÇ   ‚îú‚îÄ‚îÄ storage.ts           # Database layer\n‚îÇ   ‚îú‚îÄ‚îÄ programGenerator.ts  # Logica allenamenti\n‚îÇ   ‚îî‚îÄ‚îÄ replitAuth.ts        # Autenticazione\n‚îú‚îÄ‚îÄ shared/                   # Codice condiviso\n‚îÇ   ‚îî‚îÄ‚îÄ schema.ts            # Schema database + types\n‚îî‚îÄ‚îÄ package.json\n```\n\n---\n\n## üóÑÔ∏è DATABASE SCHEMA\n\n**File: `shared/schema.ts`**\n\n```typescript\nimport { sql } from \"drizzle-orm\";\nimport { pgTable, varchar, timestamp, jsonb, index, boolean, integer, decimal, text } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\n\n// ===== AUTENTICAZIONE =====\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  isPremium: boolean(\"is_premium\").default(false).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// ===== FITNESS DATA =====\n\n// Screening iniziale (obiettivi e disponibilit√†)\nexport const screenings = pgTable(\"screenings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  goal: varchar(\"goal\").notNull(), // weight_loss, muscle_gain, strength, endurance\n  objectiveType: varchar(\"objective_type\"), // toning, performance\n  sportType: varchar(\"sport_type\"), // calcio, basket, tennis, etc.\n  bodyWeight: decimal(\"body_weight\", { precision: 5, scale: 1 }), // peso corporeo in kg\n  level: varchar(\"level\").notNull(), // beginner, intermediate, advanced\n  hasGym: boolean(\"has_gym\").notNull(),\n  frequency: integer(\"frequency\").notNull(), // 2-6 giorni/settimana\n  painAreas: jsonb(\"pain_areas\").$type<string[]>().default([]),\n  preferredSplit: varchar(\"preferred_split\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// Quiz tecnico (conoscenza esercizi)\nexport const quizResults = pgTable(\"quiz_results\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  score: integer(\"score\").notNull(),\n  totalQuestions: integer(\"total_questions\").notNull(),\n  answers: jsonb(\"answers\").$type<{questionId: number, answer: number, correct: boolean}[]>(),\n  difficulty: varchar(\"difficulty\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Assessment forza (10RM test)\nexport const assessments = pgTable(\"assessments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  weight: decimal(\"weight\", { precision: 6, scale: 2 }).notNull(),\n  reps: integer(\"reps\").notNull(),\n  oneRepMax: decimal(\"one_rep_max\", { precision: 6, scale: 2 }).notNull(),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Programmi di allenamento\nexport const programs = pgTable(\"programs\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  name: varchar(\"name\").notNull(),\n  description: text(\"description\"),\n  split: varchar(\"split\").notNull(),\n  daysPerWeek: integer(\"days_per_week\").notNull(),\n  weeklySchedule: jsonb(\"weekly_schedule\").$type<{\n    day: string,\n    name: string,\n    exercises: {\n      name: string,\n      sets: number,\n      reps: string,\n      rest: number,\n      weight?: number,\n      alternatives?: string[]\n    }[]\n  }[]>(),\n  progression: varchar(\"progression\").notNull(),\n  isActive: boolean(\"is_active\").default(true).notNull(),\n  startDate: timestamp(\"start_date\").defaultNow(),\n  endDate: timestamp(\"end_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Workout session\nexport const workouts = pgTable(\"workouts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  programId: varchar(\"program_id\").references(() => programs.id, { onDelete: \"set null\" }),\n  dayName: varchar(\"day_name\").notNull(),\n  status: varchar(\"status\").notNull().default(\"in_progress\"),\n  \n  // Pre-workout check data\n  sleepHours: decimal(\"sleep_hours\", { precision: 3, scale: 1 }),\n  energyLevel: integer(\"energy_level\"),\n  painLevel: integer(\"pain_level\"),\n  painLocation: varchar(\"pain_location\"),\n  preWorkoutNotes: text(\"pre_workout_notes\"),\n  \n  startedAt: timestamp(\"started_at\").defaultNow(),\n  completedAt: timestamp(\"completed_at\"),\n  duration: integer(\"duration\"),\n  notes: text(\"notes\"),\n  totalVolume: decimal(\"total_volume\", { precision: 10, scale: 2 }),\n});\n\n// Singoli set\nexport const workoutSets = pgTable(\"workout_sets\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  workoutId: varchar(\"workout_id\").notNull().references(() => workouts.id, { onDelete: \"cascade\" }),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  setNumber: integer(\"set_number\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  weight: decimal(\"weight\", { precision: 6, scale: 2 }).notNull(),\n  rpe: integer(\"rpe\"),\n  isWarmup: boolean(\"is_warmup\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Personal Records\nexport const personalRecords = pgTable(\"personal_records\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  exerciseName: varchar(\"exercise_name\").notNull(),\n  recordType: varchar(\"record_type\").notNull(),\n  value: decimal(\"value\", { precision: 10, scale: 2 }).notNull(),\n  workoutId: varchar(\"workout_id\").references(() => workouts.id, { onDelete: \"set null\" }),\n  achievedAt: timestamp(\"achieved_at\").defaultNow(),\n});\n\n// Progressioni settimanali\nexport const weeklyProgress = pgTable(\"weekly_progress\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  weekStart: timestamp(\"week_start\").notNull(),\n  totalWorkouts: integer(\"total_workouts\").default(0),\n  totalVolume: decimal(\"total_volume\", { precision: 10, scale: 2 }).default(\"0\"),\n  totalSets: integer(\"total_sets\").default(0),\n  totalReps: integer(\"total_reps\").default(0),\n  averageIntensity: decimal(\"average_intensity\", { precision: 5, scale: 2 }),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\n// Pagamenti\nexport const payments = pgTable(\"payments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  amount: integer(\"amount\").notNull(),\n  currency: varchar(\"currency\").default(\"EUR\").notNull(),\n  provider: varchar(\"provider\").notNull(),\n  status: varchar(\"status\").notNull(),\n  transactionId: varchar(\"transaction_id\").unique(),\n  subscriptionId: varchar(\"subscription_id\"),\n  metadata: jsonb(\"metadata\").$type<any>(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\n// ===== TYPES =====\nexport type User = typeof users.$inferSelect;\nexport type Screening = typeof screenings.$inferSelect;\nexport type InsertScreening = typeof screenings.$inferInsert;\nexport type QuizResult = typeof quizResults.$inferSelect;\nexport type InsertQuizResult = typeof quizResults.$inferInsert;\nexport type Assessment = typeof assessments.$inferSelect;\nexport type InsertAssessment = typeof assessments.$inferInsert;\nexport type Program = typeof programs.$inferSelect;\nexport type InsertProgram = typeof programs.$inferInsert;\nexport type Workout = typeof workouts.$inferSelect;\nexport type InsertWorkout = typeof workouts.$inferInsert;\nexport type WorkoutSet = typeof workoutSets.$inferSelect;\nexport type InsertWorkoutSet = typeof workoutSets.$inferInsert;\nexport type PersonalRecord = typeof personalRecords.$inferSelect;\nexport type WeeklyProgress = typeof weeklyProgress.$inferSelect;\nexport type Payment = typeof payments.$inferSelect;\nexport type InsertPayment = typeof payments.$inferInsert;\n```\n\n---\n\n## üîß BACKEND - API ROUTES\n\n**File: `server/routes.ts`**\n\n```typescript\nimport type { Express, Response } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated } from \"./replitAuth\";\nimport { generateProgram, calculateOneRepMax } from \"./programGenerator\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  await setupAuth(app);\n\n  // ===== AUTH =====\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    const userId = req.user.claims.sub;\n    const user = await storage.getUser(userId);\n    res.json(user);\n  });\n\n  // ===== SCREENING =====\n  app.post(\"/api/screening\", isAuthenticated, async (req: any, res: Response) => {\n    const userId = req.user.claims.sub;\n    const { goal, objectiveType, sportType, bodyWeight, level, hasGym, frequency, painAreas, preferredSplit } = req.body;\n\n    const screening = await storage.saveScreening({\n      userId, goal, objectiveType, sportType, bodyWeight,\n      level, hasGym, frequency, painAreas: painAreas || [], preferredSplit,\n    });\n    res.json(screening);\n  });\n\n  app.get(\"/api/screening\", isAuthenticated, async (req: any, res: Response) => {\n    const userId = req.user.claims.sub;\n    const screening = await storage.getLatestScreening(userId);\n    res.json(screening || null);\n  });\n\n  // ===== QUIZ =====\n  app.post(\"/api/quiz/submit\", isAuthenticated, async (req: any, res: Response) => {\n    const userId = req.user.claims.sub;\n    const { score, totalQuestions, answers, difficulty } = req.body;\n    const result = await storage.saveQuizResult({ userId, score, totalQuestions, answers, difficulty });\n    res.json(result);\n  });\n\n  // ===== ASSESSMENT =====\n  app.post(\"/api/assessment\", isAuthenticated, async (req: any, res: Response) => {\n    const userId = req.user.claims.sub;\n    const { exerciseName, weight, reps, notes } = req.body;\n    const oneRepMax = calculateOneRepMax(parseFloat(weight), parseInt(reps));\n    \n    const assessment = await storage.saveAssessment({\n      userId, exerciseName,\n      weight: weight.toString(),\n      reps: parseInt(reps),\n      oneRepMax: oneRepMax.toFixed(2),\n      notes,\n    });\n    res.json(assessment);\n  });\n\n  // ===== PROGRAM GENERATION =====\n  app.post(\"/api/program/generate\", isAuthenticated, async (req: any, res: Response) => {\n    const userId = req.user.claims.sub;\n    const screening = await storage.getLatestScreening(userId);\n    const assessments = await storage.getLatestAssessments(userId);\n\n    if (!screening) {\n      return res.status(400).json({ error: \"Complete screening first\" });\n    }\n\n    const programData = generateProgram({\n      level: screening.level,\n      frequency: screening.frequency,\n      hasGym: screening.hasGym,\n      painAreas: screening.painAreas as string[],\n      assessments: assessments.map(a => ({\n        exerciseName: a.exerciseName,\n        oneRepMax: parseFloat(a.oneRepMax)\n      })),\n      goal: screening.goal\n    });\n\n    const program = await storage.createProgram({\n      userId,\n      name: programData.name,\n      description: programData.description,\n      split: programData.split,\n      daysPerWeek: programData.daysPerWeek,\n      weeklySchedule: programData.weeklySchedule,\n      progression: programData.progression,\n      isActive: true\n    });\n    res.json(program);\n  });\n\n  // ===== WORKOUTS =====\n  app.post(\"/api/workout/start\", isAuthenticated, async (req: any, res: Response) => {\n    const userId = req.user.claims.sub;\n    const { programId, dayName, sleepHours, energyLevel, painLevel, painLocation, preWorkoutNotes } = req.body;\n\n    const workout = await storage.createWorkout({\n      userId, programId, dayName, status: \"in_progress\",\n      sleepHours: sleepHours?.toString(), energyLevel, painLevel, painLocation, preWorkoutNotes\n    });\n    res.json(workout);\n  });\n\n  app.post(\"/api/workout/:id/complete\", isAuthenticated, async (req: any, res: Response) => {\n    const workoutId = req.params.id;\n    const { duration } = req.body;\n\n    const sets = await storage.getWorkoutSets(workoutId);\n    const totalVolume = sets\n      .filter(s => !s.isWarmup)\n      .reduce((sum, s) => sum + (s.reps * parseFloat(s.weight)), 0);\n\n    const workout = await storage.completeWorkout(workoutId, duration, totalVolume);\n    \n    const weekStart = new Date(workout.startedAt);\n    weekStart.setDate(weekStart.getDate() - weekStart.getDay());\n    await storage.updateWeeklyProgress(workout.userId, weekStart);\n\n    res.json(workout);\n  });\n\n  // ===== RESET USER DATA =====\n  app.delete(\"/api/user/reset\", isAuthenticated, async (req: any, res: Response) => {\n    const userId = req.user.claims.sub;\n    await storage.resetUserData(userId);\n    res.json({ success: true, message: \"Tutti i dati sono stati cancellati!\" });\n  });\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n```\n\n---\n\n## üíæ STORAGE LAYER\n\n**File: `server/storage.ts`** (estratto principale)\n\n```typescript\nimport { db } from \"./db\";\nimport {\n  users, screenings, quizResults, assessments, programs,\n  workouts, workoutSets, personalRecords, weeklyProgress, payments,\n  type User, type Screening, type InsertScreening, // ... altri types\n} from \"@shared/schema\";\nimport { eq, desc } from \"drizzle-orm\";\n\nexport class DatabaseStorage {\n  // ===== SCREENING =====\n  async saveScreening(data: InsertScreening): Promise<Screening> {\n    const [screening] = await db.insert(screenings).values(data).returning();\n    return screening;\n  }\n\n  async getLatestScreening(userId: string): Promise<Screening | undefined> {\n    const [screening] = await db.select()\n      .from(screenings)\n      .where(eq(screenings.userId, userId))\n      .orderBy(desc(screenings.createdAt))\n      .limit(1);\n    return screening;\n  }\n\n  // ===== ASSESSMENT =====\n  async saveAssessment(data: InsertAssessment): Promise<Assessment> {\n    const [assessment] = await db.insert(assessments).values(data).returning();\n    return assessment;\n  }\n\n  async getLatestAssessments(userId: string): Promise<Assessment[]> {\n    const latestAssessments = await db.select()\n      .from(assessments)\n      .where(eq(assessments.userId, userId))\n      .orderBy(desc(assessments.createdAt));\n    \n    // Group by exercise, take most recent\n    const grouped = new Map<string, Assessment>();\n    for (const assessment of latestAssessments) {\n      if (!grouped.has(assessment.exerciseName)) {\n        grouped.set(assessment.exerciseName, assessment);\n      }\n    }\n    return Array.from(grouped.values());\n  }\n\n  // ===== PROGRAMS =====\n  async createProgram(data: InsertProgram): Promise<Program> {\n    // Deactivate all other programs\n    await db.update(programs)\n      .set({ isActive: false })\n      .where(eq(programs.userId, data.userId));\n    \n    const [program] = await db.insert(programs).values(data).returning();\n    return program;\n  }\n\n  // ===== RESET USER DATA =====\n  async resetUserData(userId: string): Promise<void> {\n    // Delete in correct order for foreign key constraints\n    const userWorkouts = await db.select().from(workouts).where(eq(workouts.userId, userId));\n    for (const workout of userWorkouts) {\n      await db.delete(workoutSets).where(eq(workoutSets.workoutId, workout.id));\n    }\n    \n    await db.delete(workouts).where(eq(workouts.userId, userId));\n    await db.delete(personalRecords).where(eq(personalRecords.userId, userId));\n    await db.delete(weeklyProgress).where(eq(weeklyProgress.userId, userId));\n    await db.delete(programs).where(eq(programs.userId, userId));\n    await db.delete(assessments).where(eq(assessments.userId, userId));\n    await db.delete(quizResults).where(eq(quizResults.userId, userId));\n    await db.delete(screenings).where(eq(screenings.userId, userId));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n```\n\n---\n\n## üèãÔ∏è PROGRAM GENERATOR\n\n**File: `server/programGenerator.ts`** (funzioni chiave)\n\n```typescript\n// Formula Brzycki per 1RM\nexport function calculateOneRepMax(weight: number, reps: number): number {\n  if (reps === 1) return weight;\n  return weight / (1.0278 - 0.0278 * reps);\n}\n\n// Analisi dolore persistente\nexport function analyzePainPersistence(recentWorkouts: WorkoutPainData[]) {\n  const workoutsWithPain = recentWorkouts.filter(w => w.painLevel && w.painLevel > 0);\n  \n  if (workoutsWithPain.length === 0) {\n    return {\n      isPersistent: false,\n      recommendation: \"none\",\n      message: \"Nessun dolore rilevato\"\n    };\n  }\n\n  const avgPain = workoutsWithPain.reduce((sum, w) => sum + (w.painLevel || 0), 0) / workoutsWithPain.length;\n  \n  if (workoutsWithPain.length >= 2 && avgPain >= 7) {\n    return {\n      isPersistent: true,\n      recommendation: \"reduce_intensity_40_volume_30\",\n      message: `Dolore persistente (${avgPain.toFixed(1)}). Riduzione necessaria.`\n    };\n  }\n  \n  return { isPersistent: true, recommendation: \"monitor\" };\n}\n\n// Generazione programma principale\nexport function generateProgram(input: ProgramInput) {\n  const { level, frequency, goal, assessments, hasGym, painAreas } = input;\n\n  // Logica di selezione programma\n  if (goal === \"endurance\") {\n    return generateEnduranceProgram(input);\n  }\n  \n  if (goal === \"general\") {\n    return generateGeneralFitnessProgram(input);\n  }\n\n  // Programmi di forza standard\n  const split = determineSplit(frequency, level);\n  const progression = getProgressionScheme(level);\n  \n  // Genera schedule settimanale...\n  const weeklySchedule = buildWeeklySchedule(split, frequency, assessments, hasGym, painAreas);\n\n  return {\n    name: `${goal} - ${frequency}x/settimana`,\n    split,\n    daysPerWeek: frequency,\n    weeklySchedule,\n    progression: progression.type,\n    description: progression.description\n  };\n}\n\n// Programma Endurance con Concurrent Training\nfunction generateEnduranceProgram(input: ProgramInput) {\n  const weeklySchedule: any[] = [];\n  \n  // Mix forza + cardio basato su frequenza\n  if (input.frequency === 4) {\n    weeklySchedule.push(\n      { day: \"Giorno 1\", name: \"Forza Upper\", exercises: generateEnduranceStrengthDay(input, \"upper\") },\n      { day: \"Giorno 2\", name: \"Cardio Steady-State\", exercises: [{ name: \"Corsa 45-60 min Zona 2\" }] },\n      { day: \"Giorno 3\", name: \"Forza Lower\", exercises: generateEnduranceStrengthDay(input, \"lower\") },\n      { day: \"Giorno 4\", name: \"HIIT Intervals\", exercises: [{ name: \"10x 1min max / 1min rec\" }] }\n    );\n  }\n\n  return {\n    name: `Endurance Training - ${input.frequency}x/settimana`,\n    split: \"concurrent_training\",\n    daysPerWeek: input.frequency,\n    weeklySchedule,\n    progression: \"volume_based\"\n  };\n}\n```\n\n---\n\n## ‚öõÔ∏è FRONTEND - COMPONENTI PRINCIPALI\n\n### ScreeningFlow Component\n\n**File: `client/src/components/ScreeningFlow.tsx`** (estratto)\n\n```typescript\nconst GOALS = [\n  { id: \"weight_loss\", label: \"Perdita Peso\", emoji: \"üî•\" },\n  { id: \"muscle_gain\", label: \"Massa Muscolare\", emoji: \"üí™\" },\n  { id: \"strength\", label: \"Forza\", emoji: \"‚ö°\" },\n  { id: \"toning\", label: \"Tonificazione\", emoji: \"‚ú®\" },\n  { id: \"performance\", label: \"Prestazioni Sportive\", emoji: \"üèÜ\" },\n  { id: \"endurance\", label: \"Resistenza\", emoji: \"üèÉ\" },\n  { id: \"general\", label: \"Fitness Generale\", emoji: \"üéØ\" },\n];\n\nconst SPORTS = [\n  { id: \"calcio\", label: \"Calcio\", emoji: \"‚öΩ\" },\n  { id: \"basket\", label: \"Basket\", emoji: \"üèÄ\" },\n  { id: \"tennis\", label: \"Tennis\", emoji: \"üéæ\" },\n  // ... altri sport\n];\n\nexport default function ScreeningFlow({ onComplete }: ScreeningFlowProps) {\n  const [data, setData] = useState({\n    goal: \"\",\n    sportType: \"\",\n    bodyWeight: 70,\n    level: \"beginner\",\n    frequency: 3,\n    hasGym: null,\n    painAreas: [],\n  });\n\n  const handleSubmit = async () => {\n    const objectiveType = data.goal === \"toning\" ? \"toning\" : \n                         data.goal === \"performance\" ? \"performance\" : null;\n\n    await fetch(\"/api/screening\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ ...data, objectiveType }),\n    });\n\n    window.location.href = \"/quiz\";\n  };\n\n  // Render step by step UI...\n}\n```\n\n### Quiz Component\n\n**File: `client/src/components/QuizComponent.tsx`** (estratto)\n\n```typescript\nconst TECHNICAL_QUESTIONS = [\n  {\n    question: \"Durante lo squat, dove deve passare la linea del bilanciere?\",\n    options: [\n      \"Dietro i talloni\",\n      \"Davanti alle punte dei piedi\",\n      \"Sul centro del piede, in linea con le caviglie\", // ‚úì\n      \"Non importa, basta scendere parallelo\"\n    ],\n    correctAnswer: 2,\n    type: \"technical\"\n  },\n  // ... altre 6 domande tecniche con risposte randomizzate\n];\n\nexport default function QuizComponent() {\n  const [technicalScore, setTechnicalScore] = useState(0);\n  const [performanceScore, setPerformanceScore] = useState(0);\n\n  // Logica determinazione livello\n  if (technicalPercentage < 50) {\n    level = \"beginner\"; // Tecnica insufficiente\n  } else if (performancePercentage < 40) {\n    level = \"intermediate\"; // Tecnica OK, carichi bassi\n  } else {\n    level = \"advanced\"; // Tecnica OK, carichi buoni\n  }\n\n  // Submit e aggiorna screening con livello determinato\n  await fetch(\"/api/screening/update-level\", {\n    method: \"POST\",\n    body: JSON.stringify({ level })\n  });\n}\n```\n\n### Assessment Flow Component\n\n**File: `client/src/components/AssessmentFlow.tsx`** (estratto)\n\n```typescript\nconst MAIN_EXERCISES = [\n  { name: \"Squat\", description: \"Squat con bilanciere\" },\n  { name: \"Panca Piana\", description: \"Panca piana con bilanciere\" },\n  { name: \"Stacco\", description: \"Stacco da terra\" },\n  { name: \"Military Press\", description: \"Shoulder press in piedi\" },\n  { name: \"Pulley\", description: \"Lat pulldown\" }\n];\n\nexport default function AssessmentFlow() {\n  const [bodyWeight, setBodyWeight] = useState<number | null>(null);\n\n  // Carica peso corporeo dallo screening\n  useEffect(() => {\n    fetch(\"/api/screening\")\n      .then(res => res.json())\n      .then(data => {\n        if (data?.bodyWeight) {\n          setBodyWeight(parseFloat(data.bodyWeight));\n        }\n      });\n  }, []);\n\n  // Calcola carico suggerito basato su peso corporeo\n  const getSuggestedWeight = (exerciseName: string, bw: number) => {\n    const multipliers = {\n      \"Squat\": 0.75,         // ~1.0x BW 1RM\n      \"Panca Piana\": 0.65,   // ~0.85x BW 1RM\n      \"Stacco\": 1.0,         // ~1.3x BW 1RM\n      \"Military Press\": 0.4, // ~0.5x BW 1RM\n      \"Pulley\": 0.65,        // ~0.85x BW 1RM\n    };\n    \n    return Math.round(bw * multipliers[exerciseName] / 2.5) * 2.5;\n  };\n\n  const calculateBrzycki = (w: number, r: number) => {\n    return w / (1.0278 - 0.0278 * r);\n  };\n\n  // UI mostra suggerimento e permette calcolo 1RM\n}\n```\n\n### Dashboard Component\n\n**File: `client/src/components/Dashboard.tsx`** (estratto)\n\n```typescript\nexport default function Dashboard() {\n  const { user } = useAuth();\n  const [activeProgram, setActiveProgram] = useState(null);\n  const [activeView, setActiveView] = useState(\"overview\");\n\n  const handleResetData = async () => {\n    await apiRequest(\"DELETE\", \"/api/user/reset\");\n    toast({ title: \"Dati cancellati!\", description: \"Ricarica per ricominciare.\" });\n    setTimeout(() => window.location.reload(), 2000);\n  };\n\n  // Views: overview, pre-check, workout, progress\n  if (activeView === \"workout\") {\n    return <WorkoutTracker programDay={nextWorkout} onComplete={onWorkoutComplete} />;\n  }\n\n  if (activeView === \"progress\") {\n    return <ProgressCharts />;\n  }\n\n  // Dashboard overview con stats, prossimo workout, reset button\n}\n```\n\n---\n\n## üé® DESIGN SYSTEM\n\n**File: `client/src/index.css`** (estratto colori)\n\n```css\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  :root {\n    /* Primary: Emerald/Teal */\n    --primary: 160 85% 45%;\n    --primary-foreground: 0 0% 100%;\n    \n    /* Accent: Coral */\n    --accent: 15 90% 55%;\n    --accent-foreground: 0 0% 100%;\n    \n    /* Dark mode backgrounds */\n    --background: 222 47% 11%;\n    --foreground: 210 40% 98%;\n    --card: 217 33% 17%;\n    --muted: 217 33% 17%;\n  }\n}\n```\n\n---\n\n## üì¶ PACKAGE.JSON\n\n```json\n{\n  \"name\": \"trainsmart\",\n  \"version\": \"1.0.0\",\n  \"scripts\": {\n    \"dev\": \"tsx server/index.ts\",\n    \"db:push\": \"drizzle-kit push\",\n    \"db:studio\": \"drizzle-kit studio\"\n  },\n  \"dependencies\": {\n    \"@neondatabase/serverless\": \"^0.9.0\",\n    \"drizzle-orm\": \"^0.30.0\",\n    \"express\": \"^4.18.2\",\n    \"express-session\": \"^1.17.3\",\n    \"passport\": \"^0.6.0\",\n    \"react\": \"^18.2.0\",\n    \"react-dom\": \"^18.2.0\",\n    \"wouter\": \"^3.0.0\",\n    \"@tanstack/react-query\": \"^5.0.0\",\n    \"tailwindcss\": \"^3.4.0\",\n    \"@radix-ui/react-*\": \"latest\"\n  },\n  \"devDependencies\": {\n    \"typescript\": \"^5.3.0\",\n    \"tsx\": \"^4.7.0\",\n    \"@types/react\": \"^18.2.0\",\n    \"vite\": \"^5.0.0\",\n    \"drizzle-kit\": \"^0.20.0\"\n  }\n}\n```\n\n---\n\n## üîë FEATURES IMPLEMENTATE\n\n### ‚úÖ Sistema Completo\n- **Autenticazione**: Replit Auth (Google, GitHub, Email)\n- **Database**: PostgreSQL con Drizzle ORM\n- **Onboarding**: Screening ‚Üí Quiz ‚Üí Assessment ‚Üí Programma\n- **Allenamenti**: Tracking real-time, timer, RPE, note\n- **Progressione**: PRs, stats settimanali, grafici\n- **Dolore**: Pre-workout check, adattamento automatico carichi\n- **Reset**: Cancellazione dati con conferma\n\n### üèãÔ∏è Generazione Programmi\n- **Forza**: Wave loading, double progression, linear\n- **Endurance**: Concurrent training (forza + cardio)\n- **General Fitness**: Mix Yoga/Pilates/Forza\n- **Sport-specific**: 7 sport disponibili\n\n### üßÆ Calcoli Scientifici\n- **Brzycki Formula**: `1RM = weight / (1.0278 - 0.0278 * reps)`\n- **Suggerimenti Carico**: Basati su peso corporeo e moltiplicatori 10RM\n- **Deallenamento**: Fattore riduzione dopo dolore persistente\n- **Ricalibrazione**: Automatica dopo 3 sedute pain-free\n\n### üéØ Quiz Randomizzato\n- 7 domande tecniche + 3 performance\n- Risposte in posizioni casuali (0, 2, 3, etc.)\n- Determinazione livello automatica\n\n---\n\n## üöÄ COMANDI UTILI\n\n```bash\n# Sviluppo\nnpm run dev\n\n# Database\nnpm run db:push       # Sync schema\nnpm run db:push --force  # Force sync\nnpm run db:studio     # GUI database\n\n# Deploy\n# Usa il pulsante \"Publish\" su Replit\n```\n\n---\n\n## üìù NOTE TECNICHE\n\n### Formula Brzycki\n```\n1RM = peso / (1.0278 - 0.0278 √ó reps)\n\nEsempio: 80kg √ó 10 reps\n1RM = 80 / (1.0278 - 0.0278 √ó 10)\n1RM = 80 / 0.75 = 106.67kg\n```\n\n### Moltiplicatori Peso Corporeo (10RM)\n- **Squat**: 0.75x ‚Üí 1.0x BW (1RM)\n- **Panca**: 0.65x ‚Üí 0.85x BW (1RM)\n- **Stacco**: 1.0x ‚Üí 1.3x BW (1RM)\n- **Military**: 0.4x ‚Üí 0.5x BW (1RM)\n- **Pulley**: 0.65x ‚Üí 0.85x BW (1RM)\n\n### Concurrent Training (Endurance)\n- **Forza**: 3 sets √ó 10-12 reps @ 65% 1RM, rest 60-90s\n- **Cardio Mix**: 80% steady-state, 20% HIIT\n- **Frequenza**: 2-6 giorni/settimana con ratio strength:cardio appropriato\n\n---\n\n*File generato: 13 Ottobre 2025*\n*TrainSmart v1.0 - Intelligent Fitness Training App*\n","size_bytes":27989},"server/exerciseDatabase.ts":{"content":"// ===== ADAPTFLOW 2.0 - EXERCISE DATABASE =====\n// Sistema intelligente di selezione esercizi basato su location, equipment e peso disponibile\n\nexport type Goal = 'strength' | 'muscle_gain' | 'weight_loss' | 'endurance' | 'performance' | 'general_fitness' | 'toning' | 'disability' | 'pregnancy';\nexport type Location = 'gym' | 'home' | 'mixed';\nexport type EquipmentType = 'barbell' | 'dumbbell' | 'kettlebell' | 'band' | 'pullup_bar' | 'bench' | 'none';\n\nexport interface UserEquipment {\n  barbell?: boolean;\n  dumbbellMaxKg?: number;\n  kettlebellKg?: number[];\n  bands?: boolean;\n  pullupBar?: boolean;\n  bench?: boolean;\n}\n\nexport interface ExerciseVariant {\n  gym: {\n    name: string;\n    equipment: EquipmentType[][]; // Array di gruppi: ogni gruppo √® AND, tra gruppi √® OR\n    weightMultiplier: number;\n  };\n  homeWithEquipment: {\n    name: string;\n    equipment: EquipmentType[][]; // Array di gruppi: ogni gruppo √® AND, tra gruppi √® OR\n    weightMultiplier: number;\n    minWeightKg?: number;\n  };\n  homeBodyweight: {\n    name: string;\n    isGiantSet?: boolean;\n  };\n}\n\n// ===== DATABASE ESERCIZI COMPLETO =====\n\nexport const EXERCISE_DATABASE: Record<string, ExerciseVariant> = {\n  \n  // GAMBE - SQUAT\n  'Squat': {\n    gym: {\n      name: \"Squat Bilanciere\",\n      equipment: [['barbell']],\n      weightMultiplier: 0.7\n    },\n    homeWithEquipment: {\n      name: \"Goblet Squat\",\n      equipment: [['dumbbell'], ['kettlebell']], // dumbbell OR kettlebell\n      weightMultiplier: 0.4,\n      minWeightKg: 12\n    },\n    homeBodyweight: {\n      name: \"Squat a Corpo Libero\",\n      isGiantSet: false\n    }\n  },\n\n  'Front Squat': {\n    gym: {\n      name: \"Front Squat\",\n      equipment: [['barbell']],\n      weightMultiplier: 0.6\n    },\n    homeWithEquipment: {\n      name: \"Goblet Squat\",\n      equipment: [['dumbbell'], ['kettlebell']], // dumbbell OR kettlebell\n      weightMultiplier: 0.4,\n      minWeightKg: 12\n    },\n    homeBodyweight: {\n      name: \"Squat Jump + Pause Squat\",\n      isGiantSet: false\n    }\n  },\n\n  // GAMBE - STACCO\n  'Stacco': {\n    gym: {\n      name: \"Stacco da Terra\",\n      equipment: [['barbell']],\n      weightMultiplier: 0.7\n    },\n    homeWithEquipment: {\n      name: \"Stacco Rumeno Manubri\",\n      equipment: [['dumbbell']], // solo dumbbell\n      weightMultiplier: 0.5,\n      minWeightKg: 20\n    },\n    homeBodyweight: {\n      name: \"GIANT_SET_DEADLIFT\",\n      isGiantSet: true\n    }\n  },\n\n  'Stacco Rumeno': {\n    gym: {\n      name: \"Stacco Rumeno Bilanciere\",\n      equipment: [['barbell']],\n      weightMultiplier: 0.6\n    },\n    homeWithEquipment: {\n      name: \"Stacco Rumeno Manubri\",\n      equipment: [['dumbbell']], // solo dumbbell\n      weightMultiplier: 0.5,\n      minWeightKg: 15\n    },\n    homeBodyweight: {\n      name: \"Single Leg RDL\",\n      isGiantSet: false\n    }\n  },\n\n  // PETTO\n  'Panca Piana': {\n    gym: {\n      name: \"Panca Piana Bilanciere\",\n      equipment: [['barbell', 'bench']], // barbell AND bench\n      weightMultiplier: 0.7\n    },\n    homeWithEquipment: {\n      name: \"Panca Manubri\",\n      equipment: [['dumbbell', 'bench']], // dumbbell AND bench\n      weightMultiplier: 0.6,\n      minWeightKg: 15\n    },\n    homeBodyweight: {\n      name: \"Push-up\",\n      isGiantSet: false\n    }\n  },\n\n  'Panca Inclinata': {\n    gym: {\n      name: \"Panca Inclinata\",\n      equipment: [['barbell', 'bench']], // barbell AND bench\n      weightMultiplier: 0.6\n    },\n    homeWithEquipment: {\n      name: \"Panca Inclinata Manubri\",\n      equipment: [['dumbbell', 'bench']], // dumbbell AND bench\n      weightMultiplier: 0.5,\n      minWeightKg: 12\n    },\n    homeBodyweight: {\n      name: \"Pike Push-up\",\n      isGiantSet: false\n    }\n  },\n\n  'Dips': {\n    gym: {\n      name: \"Dips\",\n      equipment: [['none']], // bodyweight\n      weightMultiplier: 0\n    },\n    homeWithEquipment: {\n      name: \"Dips (tra sedie)\",\n      equipment: [['none']], // bodyweight\n      weightMultiplier: 0\n    },\n    homeBodyweight: {\n      name: \"Diamond Push-up\",\n      isGiantSet: false\n    }\n  },\n\n  // DORSO - VERTICALE\n  'Trazioni': {\n    gym: {\n      name: \"Trazioni\",\n      equipment: [['pullup_bar']],\n      weightMultiplier: 0\n    },\n    homeWithEquipment: {\n      name: \"Trazioni\",\n      equipment: [['pullup_bar']],\n      weightMultiplier: 0\n    },\n    homeBodyweight: {\n      name: \"GIANT_SET_PULLUP\",\n      isGiantSet: true\n    }\n  },\n\n  'Pulley': {\n    gym: {\n      name: \"Lat Machine\",\n      equipment: [['none']], // macchina da palestra\n      weightMultiplier: 0.7\n    },\n    homeWithEquipment: {\n      name: \"Band Pull-down\",\n      equipment: [['band']],\n      weightMultiplier: 0\n    },\n    homeBodyweight: {\n      name: \"GIANT_SET_PULLUP\",\n      isGiantSet: true\n    }\n  },\n\n  // DORSO - ORIZZONTALE\n  'Rematore Bilanciere': {\n    gym: {\n      name: \"Rematore Bilanciere\",\n      equipment: [['barbell']],\n      weightMultiplier: 0.6\n    },\n    homeWithEquipment: {\n      name: \"Rematore Manubrio\",\n      equipment: [['dumbbell']],\n      weightMultiplier: 0.5,\n      minWeightKg: 12\n    },\n    homeBodyweight: {\n      name: \"Inverted Row\",\n      isGiantSet: false\n    }\n  },\n\n  'Rematore Manubrio': {\n    gym: {\n      name: \"Rematore Manubrio\",\n      equipment: [['dumbbell']],\n      weightMultiplier: 0.5\n    },\n    homeWithEquipment: {\n      name: \"Rematore Manubrio\",\n      equipment: [['dumbbell']],\n      weightMultiplier: 0.5,\n      minWeightKg: 10\n    },\n    homeBodyweight: {\n      name: \"Plank Row\",\n      isGiantSet: false\n    }\n  },\n\n  // SPALLE\n  'Military Press': {\n    gym: {\n      name: \"Military Press Bilanciere\",\n      equipment: [['barbell']],\n      weightMultiplier: 0.5\n    },\n    homeWithEquipment: {\n      name: \"Military Press Manubri\",\n      equipment: [['dumbbell']],\n      weightMultiplier: 0.45,\n      minWeightKg: 10\n    },\n    homeBodyweight: {\n      name: \"Pike Push-up\",\n      isGiantSet: false\n    }\n  },\n\n  'Alzate Laterali': {\n    gym: {\n      name: \"Alzate Laterali\",\n      equipment: [['dumbbell']],\n      weightMultiplier: 0.15\n    },\n    homeWithEquipment: {\n      name: \"Alzate Laterali Manubri\",\n      equipment: [['dumbbell']],\n      weightMultiplier: 0.15,\n      minWeightKg: 5\n    },\n    homeBodyweight: {\n      name: \"Band Lateral Raise\",\n      isGiantSet: false\n    }\n  },\n\n  'Croci Cavi': {\n    gym: {\n      name: \"Croci ai Cavi\",\n      equipment: [['none']], // cavi da palestra\n      weightMultiplier: 0.3\n    },\n    homeWithEquipment: {\n      name: \"Croci con Elastici\",\n      equipment: [['band']],\n      weightMultiplier: 0\n    },\n    homeBodyweight: {\n      name: \"Wide Push-up\",\n      isGiantSet: false\n    }\n  }\n};\n\n// ===== UTILITY FUNCTIONS =====\n\n/**\n * Verifica se l'equipment √® disponibile.\n * Struttura: Array di gruppi AND, tra gruppi √® OR\n * Esempio: [['dumbbell', 'bench']] = dumbbell AND bench (required)\n * Esempio: [['dumbbell'], ['kettlebell']] = dumbbell OR kettlebell\n */\nexport function checkEquipment(required: EquipmentType[][], available: UserEquipment): boolean {\n  // Se non c'√® equipment richiesto, ritorna true\n  if (required.length === 0) {\n    return true;\n  }\n  \n  // Controlla se almeno UN gruppo √® soddisfatto (OR tra gruppi)\n  for (const group of required) {\n    // Controlla se TUTTI gli attrezzi del gruppo sono disponibili (AND nel gruppo)\n    const groupSatisfied = group.every(item => {\n      if (item === 'none') return true;\n      \n      switch(item) {\n        case 'barbell':\n          return available.barbell === true;\n        case 'dumbbell':\n          return !!(available.dumbbellMaxKg && available.dumbbellMaxKg > 0);\n        case 'kettlebell':\n          return !!(available.kettlebellKg && available.kettlebellKg.length > 0);\n        case 'band':\n          return available.bands === true;\n        case 'pullup_bar':\n          return available.pullupBar === true;\n        case 'bench':\n          return available.bench === true;\n        default:\n          return false;\n      }\n    });\n    \n    // Se questo gruppo √® soddisfatto, ritorna true\n    if (groupSatisfied) {\n      return true;\n    }\n  }\n  \n  // Nessun gruppo soddisfatto\n  return false;\n}\n\nexport function getDefaultSets(goal: Goal, isBodyweight: boolean = false): number {\n  const base: Record<Goal, number> = {\n    strength: 5,\n    muscle_gain: 4,\n    weight_loss: 4,\n    endurance: 3,\n    performance: 4,\n    general_fitness: 3,\n    toning: 4,\n    disability: 3, // Volume moderato per disabilit√†\n    pregnancy: 3 // Volume controllato per gravidanza\n  };\n  \n  return base[goal] + (isBodyweight ? 1 : 0);\n}\n\nexport function getDefaultReps(goal: Goal, isBodyweight: boolean = false): string {\n  const base: Record<Goal, string> = {\n    strength: isBodyweight ? \"8-10\" : \"3-6\",\n    muscle_gain: isBodyweight ? \"15-20\" : \"8-12\",\n    weight_loss: isBodyweight ? \"20-25\" : \"12-15\",\n    endurance: isBodyweight ? \"20-30\" : \"15-20\",\n    performance: isBodyweight ? \"10-15\" : \"6-10\",\n    general_fitness: isBodyweight ? \"12-15\" : \"10-12\",\n    toning: isBodyweight ? \"15-20\" : \"12-15\",\n    disability: isBodyweight ? \"10-12\" : \"8-10\", // Reps moderate, focus su tecnica\n    pregnancy: isBodyweight ? \"12-15\" : \"10-12\" // Reps moderate, evitare sfinimento\n  };\n  \n  return base[goal];\n}\n\nexport function getDefaultRest(goal: Goal, category: 'compound' | 'isolation' = 'compound'): number {\n  const base: Record<Goal, number> = {\n    strength: category === 'compound' ? 240 : 120,\n    muscle_gain: category === 'compound' ? 120 : 60,\n    weight_loss: category === 'compound' ? 90 : 45,\n    endurance: category === 'compound' ? 60 : 30,\n    performance: category === 'compound' ? 180 : 90,\n    general_fitness: category === 'compound' ? 90 : 60,\n    toning: category === 'compound' ? 60 : 45,\n    disability: category === 'compound' ? 120 : 90, // Recupero generoso\n    pregnancy: category === 'compound' ? 90 : 60 // Recupero adeguato\n  };\n  \n  return base[goal];\n}\n","size_bytes":9876},"replit.md":{"content":"# TrainSmart - Intelligent Fitness Training App\n\n## Overview\n\nTrainSmart is a comprehensive fitness application designed to provide personalized workout programs based on scientific principles. It caters to a wide range of users by offering customized training plans tailored to their goals, experience level, available equipment, and even specific conditions like disability or pregnancy. The app aims to make intelligent fitness accessible, tracking progress, managing potential injury areas, and adapting dynamically to user input and progress. Key capabilities include 1RM calculations, adaptive exercise selection, sport-specific training, endurance program integration, and robust progress tracking. The project's ambition is to be a leading platform for science-backed, personalized fitness.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\nThe frontend is built with **React 18** and **TypeScript**, using **Vite** for tooling, **Wouter** for routing, and **TanStack Query** for server state management. It employs a **dark mode-first design** with **Tailwind CSS** and **shadcn/ui** components, drawing inspiration from leading fitness apps. State management primarily relies on React Query for API data and React hooks for local component state.\n\n### Backend Architecture\nThe backend is an **Express.js** server with **TypeScript**. It uses **Replit Auth** for authentication, integrated with `express-session` and a PostgreSQL store. The API follows a RESTful design, with protected routes managed by middleware. A core component is the `programGenerator.ts`, which leverages the **Brzycki Formula** for 1RM calculation, dynamically adjusts loads based on pre-workout checks, and implements various progression schemes (Wave, Weekly Undulation, Daily Undulation). It supports complex exercise selection with ADAPTFLOW‚Ñ¢ 2.0, allowing for `gym`, `homeWithEquipment`, and `homeBodyweight` variants with intelligent fallback logic, and incorporates specialized safety rules for disability and pregnancy. Endurance and sport-specific training models are also integrated, based on scientific research. Data access is abstracted via an `IStorage` interface, handling CRUD operations for all fitness data.\n\n### Data Storage\nThe application uses a **PostgreSQL** database, provisioned via Replit, with **Drizzle ORM** for type-safe schema definitions and migration management. Key tables include `users`, `screenings`, `quizResults`, `assessments`, `programs`, `workouts`, `workoutSets`, `personalRecords`, `weeklyProgress`, and `payments`, all designed with appropriate relationships and cascade deletion.\n\n### System Design Choices\n- **Personalization**: Dynamic program generation based on user screenings, assessments, and real-time workout feedback (e.g., pain levels, available equipment).\n- **Adaptability**: ADAPTFLOW‚Ñ¢ 2.0 intelligently selects exercise variants and suggests compensations based on user's location, available equipment, and even insufficient weight. It also includes specific safety adaptations for conditions like pregnancy and disability.\n- **Scientific Basis**: Utilizes the Brzycki formula for 1RM, concurrent training models for endurance, and progression schemes tailored to user experience levels.\n- **Robustness**: Features like data reset functionality and quiz answer randomization enhance system integrity and user experience.\n- **Scalability**: Designed with a clear separation of concerns between frontend, backend, and data layers, using modern frameworks and ORM.\n\n## External Dependencies\n\n- **Authentication**: Replit Auth (Google, GitHub, Email/Password)\n- **Database**: Neon Database (via `@neondatabase/serverless` for PostgreSQL)\n- **Payment Processing (Planned)**: Stripe (`@stripe/stripe-js`, `@stripe/react-stripe-js`) and PayPal (`@paypal/paypal-server-sdk`)\n- **UI Components**: Radix UI Primitives, shadcn/ui, cmdk\n- **Charting**: Recharts\n- **Fonts**: Google Fonts (Inter, Archivo Black, JetBrains Mono)\n- **Icons**: lucide-react\n- **Date Utility**: date-fns\n\n## Recent Changes\n\n- **Transparency & Legal Compliance Update (October 2025)**:\n  - Created IMPLEMENTATION_STATUS.md with honest code audit (44% live, 12% beta, 44% not implemented)\n  - Fixed payment endpoint documentation (frontend/backend mismatch identified)\n  - Reclassified pregnancy/disability as BETA (needs medical/physio validation) not \"Live\"\n  - Moved deload cycles to \"Coming Soon\" (schema exists but no reduced-volume generation)\n  - Updated roadmap: pregnancy/disability to Beta, deload/payments/AI to Coming Soon\n  - Removed unjustified \"ADAPTFLOW 2.0\" branding (now just \"ADAPTFLOW\")\n  - Legal disclaimers fully implemented: hasReadPregnancyDisclaimer, hasReadDisabilityDisclaimer with validation enforcement\n  - Added \"Opzionale\" badges to optional screening steps (specific_goals, equipment, injuries)\n  - Progressive disclosure partial: badges help but full 5-step core flow not implemented\n\n- **Workout Location Adaptation System (October 2025)**:\n  - Added workoutAdaptations table for temporary workout modifications\n  - Users can adapt any workout on-the-fly from gym to home (bodyweight or with equipment)\n  - POST /api/program/:programId/day/:dayName/adapt endpoint to regenerate exercises\n  - AdaptLocationDialog component with equipment selection UI\n  - WorkoutTracker integrated with \"Adatta\" button for mid-session location changes\n  - Adaptations expire after 24h or first use to keep data clean\n  - Exercise regeneration maintains sets/reps while substituting for available equipment\n\n- **Payment Modal UX Improvement (October 2025)**:\n  - Fixed scroll behavior in PaymentModal to ensure checkout button always visible\n  - Added max-h-[90vh] and overflow-y-auto for proper scrolling on small screens\n  - Improved mobile checkout experience with proper padding\n\n- **Three-Tier Subscription System with Dynamic Pricing (October 2025)**:\n  - Implemented 3-tier subscription model: Base (‚Ç¨19.90), Premium (‚Ç¨29.90), Elite (‚Ç¨39.90)\n  - Automatic price escalation: +‚Ç¨10 increase after exactly 6 months for all tiers\n  - Premium tier: Includes 1 AI form correction per week\n  - Elite tier: Unlimited AI form corrections\n  - Technical: `addMonths()` with day-clamping prevents overflow (31 Aug ‚Üí 28 Feb, not 3 Mar)\n  - Database: Added subscriptionTier, subscriptionStartDate, subscriptionId, aiCorrectionsUsed, lastAiCorrectionDate to users table\n  - UI: Dynamic pricing cards show current price with clear \"Primi 6 mesi\" messaging\n  - Integration: Stripe and PayPal payment methods ready (requires API keys)\n  - File: shared/pricingUtils.ts centralizes all pricing logic and feature access control\n\n- **Body Part Targeting for Toning/Ipertrofia (October 2025)**: \n  - Added \"Obiettivi Specifici\" step in screening for toning and muscle_gain goals\n  - Users can select multiple body parts to focus on (chest, arms, shoulders, back_width, back_thickness, legs, glutes, abs, calves)\n  - Changed \"Petto Alto\" (upper_chest) to just \"Petto\" (chest) with üõ°Ô∏è shield emoji\n  - Backward compatibility: legacy upper_chest values automatically normalized to chest at runtime\n  - Program generator automatically adds targeted isolation exercises based on selections\n  - All extra exercises pass through safety filters (pregnancy, disability, pain areas)\n  - Deduplication system prevents duplicate exercises in generated programs\n  - Technical implementation: BODY_PART_EXERCISES mapping in programGenerator.ts with Set-based deduplication\n\n- **Pregnancy Program Enhancement (October 2025)**:\n  - Added pregnancy-specific fields to screenings table: pregnancyWeek (1-40), pregnancyTrimester (1-3), hasDoctorClearance (required), pregnancyComplications (optional array)\n  - ScreeningFlow now includes dedicated \"Info Gravidanza\" step with:\n    - Slider for gestational week (auto-calculates trimester)\n    - Required medical clearance checkbox\n    - Optional pregnancy complications selection (pre-eclampsia, gestational diabetes, placenta previa, etc.)\n  - PREGNANCY_SAFE_EXERCISES_BY_TRIMESTER mapping in programGenerator.ts with trimester-specific exercises and modifications\n  - Trimester 1: Moderate loads (50-60% 1RM), includes light squats and incline presses\n  - Trimester 2: Reduced loads (40-50% 1RM), NO supine exercises, focus on stability\n  - Trimester 3: Minimal loads (30-40% 1RM), mobility/breathing priority, preparation for delivery\n  - Enhanced safety rules: supine exercises contraindicated post-1st trimester, all exercises filtered by trimester appropriateness\n  - CRITICAL FIX: Added pregnancy fields to screeningSchema in routes.ts to prevent Zod from stripping them from requests\n  \n- **Deload Cycles & End-Cycle Testing (October 2025)**:\n  - Added deload management to programs table: includesDeload, deloadFrequency, totalWeeks, requiresEndCycleTest\n  - Automatic deload scheduling: intermediate and advanced programs include deload every 4 weeks\n  - Program duration varies by goal:\n    - Strength: 8 weeks with end-cycle testing\n    - Muscle gain (ipertrofia): 12 weeks with end-cycle testing\n    - Performance: 8 weeks with end-cycle testing\n    - Pregnancy: 4 weeks (short cycles for close monitoring)\n    - Disability: 6 weeks (progressive adaptation)\n    - General fitness/toning: 4 weeks\n  - End-cycle testing flag: requiresEndCycleTest set for strength, muscle_gain, and performance goals\n  - Program descriptions now show deload info: \"4x/settimana, progressione ondulata (con deload ogni 4 settimane)\"\n  - Technical: generateProgram() determines deload based on user level, goal-specific durations ensure optimal programming\n  \n- **Safety System**: Comprehensive safety checks for pregnancy and disability goals with automatic exercise substitution\n- **Giant Sets Bug Fix**: System bypasses Giant Sets for pregnancy/disability, using single safe alternatives instead","size_bytes":9928},"ADAPTFLOW_SYSTEM.md":{"content":"# ADAPTFLOW‚Ñ¢ System - Equipment-Aware Training & Effort Calibration\n\n## üéØ Overview\n\nADAPTFLOW √® il sistema intelligente di TrainSmart che adatta automaticamente i programmi di allenamento in base a:\n- **Location** (Palestra, Casa, Misto)\n- **Equipment disponibile** (bilanciere, manubri, elastici, sbarra, panca)\n- **Peso effettivamente disponibile** nel momento dell'allenamento\n\nIl sistema garantisce che l'**effort rimanga costante** anche quando l'attrezzatura √® limitata o assente.\n\n---\n\n## üèóÔ∏è Architettura Implementata\n\n### 1. Database Schema (shared/schema.ts)\n\n```typescript\n// Tabella screenings - Aggiunto tracking location ed equipment\nscreenings: {\n  location: varchar(\"location\"), // 'gym' | 'home' | 'mixed'\n  equipment: jsonb(\"equipment\").$type<{\n    barbell?: boolean;\n    dumbbellMaxKg?: number;\n    kettlebellKg?: number[];\n    bands?: boolean;\n    pullupBar?: boolean;\n    bench?: boolean;\n  }>(),\n  sportRole: varchar(\"sport_role\"), // Ruolo sport-specifico (futuro)\n  bodyWeight: decimal(\"body_weight\", { precision: 5, scale: 2 }),\n  // ... altri campi\n}\n```\n\n### 2. Exercise Substitutions Database (server/exerciseSubstitutions.ts)\n\n#### HOME_ALTERNATIVES - Mappatura Palestra ‚Üí Casa\n\n```typescript\nexport const HOME_ALTERNATIVES: Record<string, string> = {\n  'Squat': 'Squat a Corpo Libero',\n  'Front Squat': 'Goblet Squat',\n  'Panca piana': 'Push-up',\n  'Panca Piana': 'Push-up',\n  'Panca inclinata': 'Pike Push-up',\n  'Stacco': 'GIANT_SET_DEADLIFT',           // ‚Üê Sostituito con Giant Set\n  'Stacco rumeno': 'Single Leg RDL',\n  'Trazioni': 'GIANT_SET_PULLUP',           // ‚Üê Sostituito con Giant Set\n  'Lat Machine': 'GIANT_SET_PULLUP',\n  'Pulley': 'GIANT_SET_PULLUP',\n  'Rematore bilanciere': 'Inverted Row',\n  'Rematore manubrio': 'Plank Row',\n  'Military Press': 'Pike Push-up',\n  'Alzate laterali': 'Band Lateral Raise',\n  'Leg Press': 'Bulgarian Split Squat',\n  'Leg Curl': 'Nordic Curl',\n  'Dips': 'Diamond Push-up',\n};\n```\n\n#### Giant Sets - Esercizi Insostituibili\n\n**STACCO ‚Üí Giant Set Catena Posteriore**\n\n```typescript\nfunction createDeadliftGiantSet(goal: string, level: string): GiantSet {\n  // Configurazioni per obiettivo\n  const configs = {\n    strength: { rounds: 4, rest: 240, reps: { jump: \"8\", nordic: \"5-6\", gm: \"10-12\", hang: \"30-45s\" } },\n    muscle_gain: { rounds: 4, rest: 150, reps: { jump: \"12\", nordic: \"8-10\", gm: \"15-18\", hang: \"45-60s\" } },\n    weight_loss: { rounds: 5, rest: 120, reps: { jump: \"15\", nordic: \"10\", gm: \"20\", hang: \"30s\" } },\n    // ...\n  };\n\n  return {\n    id: `giant_deadlift_${goal}`,\n    name: `Giant Set Stacco (Catena Posteriore)`,\n    type: 'giant_set',\n    rounds: config.rounds,\n    restBetweenRounds: config.rest,\n    exercises: [\n      { name: \"Squat Jump\", muscleGroup: \"Quads + Esplosivit√†\", reps: config.reps.jump, ... },\n      { name: \"Nordic Curl\", muscleGroup: \"Femorali\", reps: config.reps.nordic, tempo: \"4s eccentrica\", ... },\n      { name: \"Good Morning\", muscleGroup: \"Erettori + Glutei\", reps: config.reps.gm, ... },\n      { name: \"Dead Hang\", muscleGroup: \"Grip + Trap\", reps: config.reps.hang, ... }\n    ],\n    totalNotes: \"‚ö†Ô∏è LO STACCO √à INSOSTITUIBILE. Questo giant set simula la fatica sistemica e l'effort.\"\n  };\n}\n```\n\n**TRAZIONI ‚Üí Giant Set Floor Work**\n\n```typescript\nfunction createPullupGiantSet(goal: string, level: string): GiantSet {\n  return {\n    id: 'giant_pullup_floor',\n    name: 'Giant Set Dorsale (Floor Work)',\n    type: 'giant_set',\n    rounds: /* dinamico per obiettivo */,\n    restBetweenRounds: /* dinamico per obiettivo */,\n    exercises: [\n      { name: \"Floor Slide Rows\", muscleGroup: \"Dorsali + Scapole\", reps: \"12-15\", tempo: \"3s eccentrica\", \n        notes: \"Prono, mani avanti, 'scivola' indietro con dorsali (passo giaguaro a 2 braccia)\" },\n      { name: \"Scapular Push-up\", muscleGroup: \"Scapole\", reps: \"15\", notes: \"Retrazione/protrazione in plank\" },\n      { name: \"Superman Hold\", muscleGroup: \"Erettori + Dorsali\", reps: \"30-45s\", notes: \"Isometrica dorsale\" },\n      { name: \"Hollow Body\", muscleGroup: \"Core\", reps: \"30s\", notes: \"Recupero attivo\" }\n    ],\n    totalNotes: \"‚ö†Ô∏è LE TRAZIONI sono insostituibili per sviluppo dorsale. Giant set allena attivazione scapolare.\"\n  };\n}\n```\n\n### 3. Effort Calibration Logic (server/exerciseSubstitutions.ts)\n\n```typescript\nexport function calibrateEffort(plannedWeight: number, availableWeight: number, goal: string) {\n  const ratio = availableWeight / plannedWeight;\n  \n  // Se peso disponibile >= 90% del programmato ‚Üí Nessuna modifica\n  if (ratio >= 0.9) {\n    return { setsMultiplier: 1, repsMultiplier: 1, tempo: \"Standard\", notes: \"\" };\n  }\n  \n  // Se peso < 70% del programmato ‚Üí Modifica sostanziale\n  if (ratio < 0.7) {\n    switch(goal) {\n      case 'strength':\n      case 'performance':\n        return { \n          setsMultiplier: 1.5,        // +50% serie\n          repsMultiplier: 1, \n          tempo: \"4-0-1-0\",            // Eccentrico lento\n          notes: \"‚ö° Peso ridotto: +50% serie, tempo eccentrico lento\" \n        };\n        \n      case 'muscle_gain':\n      case 'toning':\n        return { \n          setsMultiplier: 1, \n          repsMultiplier: 1.5,         // +50% ripetizioni\n          tempo: \"3-1-1-0\",            // TUT elevato\n          notes: \"‚ö° Peso ridotto: +50% reps, TUT elevato\" \n        };\n        \n      case 'weight_loss':\n        return { \n          setsMultiplier: 1.3,         // +30% serie\n          repsMultiplier: 1.2,         // +20% ripetizioni\n          tempo: \"Esplosivo\", \n          notes: \"‚ö° Peso ridotto: +30% serie, +20% reps, -20s riposo\" \n        };\n    }\n  }\n  \n  // Se peso 70-90% del programmato ‚Üí Lieve aumento reps\n  return { \n    setsMultiplier: 1, \n    repsMultiplier: 1.2,               // +20% ripetizioni\n    tempo: \"Standard\", \n    notes: \"‚ö° Peso ridotto: +20% reps\" \n  };\n}\n```\n\n### 4. Program Generator Integration (server/programGenerator.ts)\n\nIl ProgramGenerator ora:\n\n1. **Riceve location ed equipment** dallo screening\n2. **Determina la fonte degli esercizi**:\n   - `location === 'gym'` ‚Üí Esercizi standard palestra\n   - `location === 'home' || 'mixed'` ‚Üí Applica sostituzioni da HOME_ALTERNATIVES\n3. **Sostituisce esercizi insostituibili** con Giant Sets:\n   - Se `'Stacco'` ‚Üí `createDeadliftGiantSet(goal, level)`\n   - Se `'Trazioni'` ‚Üí `createPullupGiantSet(goal, level)`\n4. **Genera programma location-aware** con esercizi corretti\n\n### 5. Screening Flow - Location & Equipment (client/src/components/ScreeningFlow.tsx)\n\n#### Step 3: Location Selection\n\n```typescript\n// Opzioni location\nconst locations = [\n  { value: 'gym', label: 'üè¢ Palestra', desc: 'Accesso completo attrezzature' },\n  { value: 'home', label: 'üè† Casa', desc: 'Corpo libero e attrezzatura minima' },\n  { value: 'mixed', label: 'üîÄ Misto', desc: 'Alcuni giorni casa, altri palestra' }\n];\n\n// Equipment form (condizionale - appare solo se home/mixed)\n{(location === 'home' || location === 'mixed') && (\n  <div className=\"equipment-form\">\n    <Checkbox name=\"barbell\" label=\"Bilanciere\" />\n    <Input type=\"number\" name=\"dumbbellMaxKg\" label=\"Manubri fino a (kg)\" />\n    <Checkbox name=\"bands\" label=\"Elastici\" />\n    <Checkbox name=\"pullupBar\" label=\"Sbarra per trazioni\" />\n    <Checkbox name=\"bench\" label=\"Panca\" />\n  </div>\n)}\n```\n\n### 6. PreWorkout Check - Available Weights Input (client/src/components/PreWorkoutCheck.tsx)\n\n#### Props Interface\n\n```typescript\ninterface PreWorkoutCheckProps {\n  workout: any;                    // Workout corrente con esercizi\n  onComplete: (data: PreWorkoutData) => void;\n  onSkip: () => void;\n}\n\nexport interface PreWorkoutData {\n  sleepHours: number;\n  energyLevel: number;\n  painLevel: number;\n  painLocation?: string;\n  notes?: string;\n  loadReduction?: number;\n  affectedExercises?: string[];\n  availableWeights?: Record<string, { planned: number; available: number }>;  // ‚Üê NUOVO\n}\n```\n\n#### UI - Input Pesi Disponibili\n\n```typescript\n// Filtra esercizi con peso dal workout\nconst exercisesWithWeight = workout?.exercises?.filter((ex: any) => ex.weight && ex.weight > 0) || [];\n\n// Per ogni esercizio con peso\n{exercisesWithWeight.map((ex: any) => {\n  const planned = ex.weight || 0;\n  const available = availableWeights[ex.name]?.available;\n  const hasInput = available !== undefined && available !== '';\n  const ratio = hasInput ? (Number(available) / planned) : 1;\n  const needsCalibration = hasInput && ratio < 0.9;  // Alert se < 90%\n\n  return (\n    <div>\n      <Label>{ex.name}</Label>\n      <span>Programmato: {planned}kg</span>\n      \n      <Input\n        type=\"number\"\n        placeholder=\"Peso disponibile (kg)\"\n        value={availableWeights[ex.name]?.available || ''}\n        onChange={(e) => setAvailableWeights({\n          ...prev,\n          [ex.name]: { planned, available: parseFloat(e.target.value) || 0 }\n        })}\n      />\n\n      {needsCalibration && (\n        <Alert variant=\"warning\">\n          ‚ö° Peso ridotto del {Math.round((1 - ratio) * 100)}% \n          ‚Üí Il sistema adatter√† automaticamente l'allenamento\n        </Alert>\n      )}\n    </div>\n  );\n})}\n```\n\n#### Bug Fix Critico - Gestione 0 kg\n\n**PROBLEMA INIZIALE:**\n```typescript\n// ‚ùå SBAGLIATO: Se available = 0, ratio = 1 (nessun alert!)\nconst ratio = available > 0 ? available / planned : 1;\nconst needsCalibration = available > 0 && ratio < 0.9;\n```\n\n**SOLUZIONE:**\n```typescript\n// ‚úÖ CORRETTO: Se available = 0, ratio = 0 (alert corretto!)\nconst available = availableWeights[ex.name]?.available;\nconst hasInput = available !== undefined && available !== '';\nconst ratio = hasInput ? (Number(available) / planned) : 1;\nconst needsCalibration = hasInput && ratio < 0.9;\n```\n\n---\n\n## üîÑ Flusso Completo ADAPTFLOW\n\n### 1. **Screening**\n```\nUser ‚Üí Seleziona Location (Gym/Casa/Misto)\n     ‚Üí Se Casa/Misto: Specifica Equipment disponibile\n     ‚Üí Sistema salva: location, equipment in DB\n```\n\n### 2. **Program Generation**\n```\nProgramGenerator legge: location, equipment, goal, level\n                ‚Üì\nDetermina esercizi:\n  - location = 'gym' ‚Üí Esercizi standard\n  - location = 'home'/'mixed' ‚Üí Applica HOME_ALTERNATIVES\n                ‚Üì\nSostituisce esercizi insostituibili:\n  - 'Stacco' ‚Üí Giant Set Deadlift (4 esercizi)\n  - 'Trazioni' ‚Üí Giant Set Pullup (4 esercizi)\n                ‚Üì\nGenera programma equipment-aware\n```\n\n### 3. **Pre-Workout Check** (ADAPTFLOW in azione)\n```\nUser ‚Üí Visualizza workout del giorno\n     ‚Üí PreWorkoutCheck mostra esercizi con peso\n     ‚Üí User inserisce peso effettivamente disponibile oggi\n                ‚Üì\nSistema calcola ratio = available / planned\n                ‚Üì\nSe ratio < 0.9:\n  - Mostra alert \"Peso ridotto del X%\"\n  - Passa availableWeights al workout tracker\n```\n\n### 4. **Workout Tracker** (Calibrazione Effort)\n```\nWorkoutTracker riceve: preWorkoutData.availableWeights\n                ‚Üì\nPer ogni esercizio con peso ridotto:\n  - Calcola ratio = available / planned\n  - Applica calibrateEffort(planned, available, goal)\n                ‚Üì\nAggiusta automaticamente:\n  - Serie (setsMultiplier)\n  - Ripetizioni (repsMultiplier)\n  - Tempo esecuzione (tempo)\n                ‚Üì\nUser esegue workout adattato, effort rimane costante\n```\n\n---\n\n## üìä Esempi Pratici\n\n### Esempio 1: Utente Casa con Manubri Limitati\n\n**Screening:**\n- Location: Casa\n- Equipment: Manubri 20kg, Sbarra trazioni\n\n**Programma Generato:**\n- Squat ‚Üí Goblet Squat (manubri)\n- Panca ‚Üí Push-up\n- Stacco ‚Üí Giant Set (Squat Jump + Nordic + Good Morning + Dead Hang)\n- Trazioni ‚Üí Trazioni (ha sbarra!) ‚úÖ\n\n**Pre-Workout Check (giorno allenamento):**\n- Goblet Squat programmato: 18kg\n- User inserisce: 15kg disponibile (ratio = 0.83 = 83%)\n- **Alert**: \"‚ö° Peso ridotto del 17% ‚Üí Sistema adatter√† automaticamente\"\n\n**Workout Tracker (calibrazione):**\n- Goal: Hypertrophy\n- calibrateEffort(18, 15, 'muscle_gain')\n  - repsMultiplier: 1.2 ‚Üí +20% reps\n  - Risultato: 3 serie x 14 reps invece di 3 x 12\n\n### Esempio 2: Utente Palestra, Peso Insufficiente\n\n**Screening:**\n- Location: Gym\n\n**Programma Generato:**\n- Squat: 80kg x 5 reps x 4 serie\n- Panca: 70kg x 6 reps x 4 serie\n- Stacco: 100kg x 5 reps x 3 serie\n\n**Pre-Workout Check:**\n- Squat programmato: 80kg\n- User inserisce: 50kg disponibile (ratio = 0.625 = 62.5%)\n- **Alert**: \"‚ö° Peso ridotto del 38% ‚Üí Sistema adatter√†\"\n\n**Workout Tracker (calibrazione):**\n- Goal: Strength\n- calibrateEffort(80, 50, 'strength')\n  - ratio < 0.7 ‚Üí Modifica sostanziale\n  - setsMultiplier: 1.5 ‚Üí +50% serie\n  - tempo: \"4-0-1-0\" ‚Üí Eccentrico lento\n  - Risultato: 6 serie x 5 reps (4s eccentrica) con 50kg\n\n---\n\n## üõ†Ô∏è File Modificati\n\n### Backend\n- `shared/schema.ts` - Aggiunto location, equipment, sportRole\n- `server/exerciseSubstitutions.ts` - HOME_ALTERNATIVES, Giant Sets, calibrateEffort\n- `server/programGenerator.ts` - Integrato location/equipment logic\n- `server/routes.ts` - Validazione screening con location/equipment\n\n### Frontend\n- `client/src/components/ScreeningFlow.tsx` - Step location + equipment form\n- `client/src/components/PreWorkoutCheck.tsx` - Input pesi disponibili + alert\n- `client/src/components/Dashboard.tsx` - Passa workout a PreWorkoutCheck\n\n### Database\n- Migration: `npm run db:push --force` (aggiunto location, equipment, sportRole)\n\n---\n\n## ‚úÖ Status Implementazione\n\n- [x] Database schema (location, equipment, sportRole)\n- [x] HOME_ALTERNATIVES database (15+ sostituzioni)\n- [x] Giant Sets (Deadlift, Pullup) con varianti per goal\n- [x] calibrateEffort function (logica ratio-based)\n- [x] ProgramGenerator equipment-aware\n- [x] ScreeningFlow location step + equipment form\n- [x] PreWorkoutCheck available weights input\n- [x] Alert calibrazione quando peso < 90%\n- [x] Bug fix: gestione 0 kg (ratio corretto)\n- [x] Architect review: Pass ‚úÖ\n- [x] replit.md aggiornato\n\n---\n\n## üöÄ Prossimi Step (Futuri)\n\n1. **Sport Roles Implementation**\n   - Campo `sportRole` gi√† in DB\n   - Implementare logica ruoli calcio (portiere, difensore, centrocampista, attaccante)\n   - Adattare programmi per ruolo\n\n2. **Calibrazione Effort nel Workout Tracker**\n   - Ricevere `availableWeights` da PreWorkoutCheck\n   - Applicare `calibrateEffort()` in real-time durante workout\n   - Mostrare esercizi adattati con note\n\n3. **Test End-to-End ADAPTFLOW**\n   - Flusso completo: Screening ‚Üí Assessment ‚Üí PreWorkout ‚Üí Calibrazione\n   - Verifica alert e ricalcoli automatici\n\n---\n\n## üìù Note Tecniche\n\n### Perch√© Giant Sets?\nEsercizi come **Stacco** e **Trazioni** sono biomeccanicamente insostituibili:\n- Stacco: Unico movimento che allena tutta la catena posteriore in sinergia\n- Trazioni: Impossibile replicare la trazione verticale a corpo libero senza sbarra\n\nI Giant Sets non replicano la biomeccanica, ma **simulano la fatica sistemica e l'effort** attraverso un circuito di 4 esercizi complementari.\n\n### Principio ADAPTFLOW\n> **\"L'effort deve rimanere costante, indipendentemente dall'attrezzatura disponibile.\"**\n\nSe manca il peso, aumentiamo:\n- Volume (serie/reps) per obiettivi ipertrofia/dimagrimento\n- Densit√† (tempo eccentrico) per obiettivi forza\n\n---\n\n**ADAPTFLOW‚Ñ¢** - Il programma si adatta a te, sempre. üí™\n","size_bytes":15191},"server/exerciseSubstitutions.ts":{"content":"// ===== ADAPTFLOW 2.0 - EXERCISE SUBSTITUTIONS & GIANT SETS =====\n// Sistema migliorato con selezione intelligente basata su equipment disponibile\n\nimport { \n  EXERCISE_DATABASE, \n  UserEquipment as Equipment, \n  checkEquipment,\n  getDefaultSets,\n  getDefaultReps,\n  getDefaultRest,\n  type Goal\n} from './exerciseDatabase';\n\nexport type { Equipment };\n\nexport interface GiantSetExercise {\n  name: string;\n  muscleGroup: string;\n  reps: string;\n  rest: number;\n  tempo?: string;\n  notes: string;\n}\n\nexport interface GiantSet {\n  id: string;\n  name: string;\n  type: 'giant_set';\n  rounds: number;\n  restBetweenRounds: number;\n  exercises: GiantSetExercise[];\n  totalNotes: string;\n}\n\n// Backward compatibility con HOME_ALTERNATIVES (deprecato, usare selectExerciseVariant)\nexport const HOME_ALTERNATIVES: Record<string, string> = {\n  'Squat': 'Squat a Corpo Libero',\n  'Front Squat': 'Goblet Squat',\n  'Panca Piana': 'Push-up',\n  'Panca Inclinata': 'Pike Push-up',\n  'Stacco': 'GIANT_SET_DEADLIFT',\n  'Stacco Rumeno': 'Single Leg RDL',\n  'Trazioni': 'GIANT_SET_PULLUP',\n  'Lat Machine': 'GIANT_SET_PULLUP',\n  'Pulley': 'GIANT_SET_PULLUP',\n  'Rematore Bilanciere': 'Inverted Row',\n  'Rematore Manubrio': 'Plank Row',\n  'Military Press': 'Pike Push-up',\n  'Alzate Laterali': 'Band Lateral Raise',\n  'Leg Press': 'Bulgarian Split Squat',\n  'Leg Curl': 'Nordic Curl',\n  'Dips': 'Diamond Push-up',\n  'Croci Cavi': 'Wide Push-up',\n};\n\n// ===== GIANT SETS MIGLIORATI =====\n\nexport function createDeadliftGiantSet(goal: string, level: string = 'intermediate'): GiantSet {\n  const goalType = goal as Goal;\n  \n  const configs: Record<string, { rounds: number; rest: number; reps: any }> = {\n    strength: { rounds: 4, rest: 240, reps: { jump: \"6-8\", nordic: \"4-6\", gm: \"8-10\", hang: \"30s\" } },\n    muscle_gain: { rounds: 4, rest: 150, reps: { jump: \"10-12\", nordic: \"8-10\", gm: \"12-15\", hang: \"45s\" } },\n    weight_loss: { rounds: 5, rest: 90, reps: { jump: \"15\", nordic: \"10\", gm: \"20\", hang: \"30s\" } },\n    toning: { rounds: 4, rest: 150, reps: { jump: \"12\", nordic: \"8-10\", gm: \"15\", hang: \"45s\" } },\n    performance: { rounds: 4, rest: 180, reps: { jump: \"8-10\", nordic: \"6-8\", gm: \"10-12\", hang: \"40s\" } },\n    endurance: { rounds: 5, rest: 60, reps: { jump: \"15-20\", nordic: \"12\", gm: \"20-25\", hang: \"45s\" } },\n    general_fitness: { rounds: 3, rest: 120, reps: { jump: \"10\", nordic: \"8\", gm: \"12\", hang: \"30s\" } },\n    disability: { rounds: 3, rest: 180, reps: { jump: \"Skip\", nordic: \"6-8 assistiti\", gm: \"10\", hang: \"20s\" } },\n    pregnancy: { rounds: 2, rest: 120, reps: { jump: \"Skip\", nordic: \"Skip\", gm: \"10-12\", hang: \"20s\" } }\n  };\n\n  const config = configs[goal] || configs['muscle_gain'];\n\n  return {\n    id: `giant_deadlift_${goal}`,\n    name: `Giant Set Stacco - ${goal === 'strength' ? 'Forza' : goal === 'muscle_gain' ? 'Massa' : goal === 'performance' ? 'Performance' : 'Dimagrimento'}`,\n    type: 'giant_set',\n    rounds: config.rounds,\n    restBetweenRounds: config.rest,\n    exercises: [\n      { \n        name: \"Squat Jump\", \n        muscleGroup: \"Quads + Esplosivit√†\", \n        reps: config.reps.jump, \n        rest: 0, \n        tempo: \"Esplosivo\",\n        notes: \"Simula la fase di strappo dello stacco - quadricipiti e potenza\" \n      },\n      { \n        name: \"Nordic Curl\", \n        muscleGroup: \"Femorali\", \n        reps: config.reps.nordic, \n        rest: 0, \n        tempo: \"4-5s eccentrica\", \n        notes: \"Femorali - eccentrico controllato, massima tensione\" \n      },\n      { \n        name: \"Good Morning\", \n        muscleGroup: \"Erettori + Glutei\", \n        reps: config.reps.gm, \n        rest: 0, \n        tempo: \"Controllato\",\n        notes: \"Erettori spinali + glutei - cerniera anca. Usa zaino carico se disponibile\" \n      },\n      { \n        name: \"Dead Hang\", \n        muscleGroup: \"Grip + Trap\", \n        reps: config.reps.hang, \n        rest: 0, \n        notes: \"Grip e trapezi - presa massimale, scapole attive\" \n      }\n    ],\n    totalNotes: `‚ö†Ô∏è LO STACCO CON BILANCIERE √à INSOSTITUIBILE. Questo giant set simula la fatica sistemica e l'effort tramite lavoro ad alta densit√† (ZERO pause tra esercizi), ma NON pu√≤ replicare la biomeccanica e il carico massimale dello stacco tradizionale. ${config.rounds} giri totali con ${config.rest}s di recupero TRA i giri.`\n  };\n}\n\nexport function createPullupGiantSet(goal: string, level: string = 'intermediate'): GiantSet {\n  const rounds = goal === 'weight_loss' ? 5 : goal === 'muscle_gain' || goal === 'toning' ? 4 : 3;\n  const rest = goal === 'weight_loss' ? 90 : goal === 'strength' || goal === 'performance' ? 180 : 120;\n  const repsMultiplier = goal === 'muscle_gain' || goal === 'toning' ? 1.3 : goal === 'weight_loss' ? 1.5 : 1;\n\n  return {\n    id: 'giant_pullup_floor',\n    name: 'Giant Set Dorsale (Floor Work)',\n    type: 'giant_set',\n    rounds,\n    restBetweenRounds: rest,\n    exercises: [\n      { \n        name: \"Floor Slide Rows\", \n        muscleGroup: \"Dorsali + Scapole\", \n        reps: `${Math.round(12 * repsMultiplier)}-${Math.round(15 * repsMultiplier)}`, \n        rest: 0, \n        tempo: \"3s eccentrica\", \n        notes: \"Sdraiato prono, mani avanti, 'scivola' indietro trascinandoti con dorsali (come passo giaguaro ma con DUE BRACCIA INSIEME)\" \n      },\n      { \n        name: \"Scapular Push-up\", \n        muscleGroup: \"Scapole\", \n        reps: `${Math.round(15 * repsMultiplier)}`, \n        rest: 0,\n        tempo: \"Controllato\", \n        notes: \"In posizione plank, retrai/protrarre scapole - attivazione scapolare pura\" \n      },\n      { \n        name: \"Superman Hold\", \n        muscleGroup: \"Erettori + Dorsali\", \n        reps: `${Math.round(30 * repsMultiplier)}s`, \n        rest: 0, \n        notes: \"Isometrica: braccia estese avanti, tieni in alto - dorsali + erettori\" \n      },\n      { \n        name: \"Hollow Body Hold\", \n        muscleGroup: \"Core\", \n        reps: \"30s\", \n        rest: 0, \n        notes: \"Posizione antagonista - recupero attivo per core anteriore\" \n      }\n    ],\n    totalNotes: `‚ö†Ô∏è LE TRAZIONI sono insostituibili per sviluppo dorsale width. Questo giant set allena attivazione scapolare, dorsali e core senza sbarra, ma non pu√≤ sostituire il pattern di trazione verticale con carico del corpo. Se possibile, installa una sbarra! ${rounds} giri con ${rest}s recupero.`\n  };\n}\n\n// ===== MOTORE SELEZIONE INTELLIGENTE =====\n\nexport interface ExerciseResult {\n  id: string;\n  name: string;\n  sets: number;\n  reps: string;\n  rest: number;\n  weight?: number;\n  tempo?: string;\n  notes?: string;\n  category?: string;\n}\n\n/**\n * Seleziona la variante corretta dell'esercizio basandosi su:\n * - Location (gym/home)\n * - Equipment disponibile\n * - Peso minimo richiesto\n * - Goal dell'utente\n */\nexport function selectExerciseVariant(\n  exerciseName: string,\n  location: 'gym' | 'home' | 'mixed',\n  equipment: Equipment,\n  goal: string,\n  assessmentWeight?: number\n): ExerciseResult | GiantSet {\n  \n  const goalType = goal as Goal;\n  const variants = EXERCISE_DATABASE[exerciseName];\n  \n  if (!variants) {\n    // Fallback: esercizio non trovato, restituisci versione base\n    return {\n      id: exerciseName.toLowerCase().replace(/\\s/g, '_'),\n      name: exerciseName,\n      sets: getDefaultSets(goalType),\n      reps: getDefaultReps(goalType),\n      rest: getDefaultRest(goalType),\n      category: 'compound'\n    };\n  }\n\n  // CASO 1: PALESTRA (o mixed che equivale a gym per selezione)\n  if (location === 'gym' || location === 'mixed') {\n    const gymVariant = variants.gym;\n    return {\n      id: exerciseName.toLowerCase().replace(/\\s/g, '_'),\n      name: gymVariant.name,\n      sets: getDefaultSets(goalType),\n      reps: getDefaultReps(goalType),\n      rest: getDefaultRest(goalType),\n      weight: assessmentWeight ? Math.round(assessmentWeight * gymVariant.weightMultiplier * 10) / 10 : undefined,\n      category: 'compound'\n    };\n  }\n\n  // CASO 2: CASA - verifica equipment disponibile\n  const homeWithEq = variants.homeWithEquipment;\n  const homeBodyweight = variants.homeBodyweight;\n\n  // Controlla se ha equipment necessario (AND+OR logic)\n  const hasRequiredEquipment = checkEquipment(homeWithEq.equipment, equipment);\n  \n  // Identifica quale attrezzo √® effettivamente disponibile e il suo peso max\n  let maxAvailableWeight = 0;\n  let equipmentType = '';\n  \n  // Trova il gruppo soddisfatto e identifica l'attrezzo disponibile\n  for (const group of homeWithEq.equipment) {\n    // Controlla se questo gruppo √® soddisfatto\n    const groupSatisfied = group.every(item => {\n      switch(item) {\n        case 'barbell': return equipment.barbell === true;\n        case 'dumbbell': return !!(equipment.dumbbellMaxKg && equipment.dumbbellMaxKg > 0);\n        case 'kettlebell': return !!(equipment.kettlebellKg && equipment.kettlebellKg.length > 0);\n        case 'band': return equipment.bands === true;\n        case 'pullup_bar': return equipment.pullupBar === true;\n        case 'bench': return equipment.bench === true;\n        case 'none': return true;\n        default: return false;\n      }\n    });\n    \n    if (groupSatisfied) {\n      // Identifica quale attrezzo con peso √® disponibile in questo gruppo\n      if (group.includes('dumbbell') && equipment.dumbbellMaxKg && equipment.dumbbellMaxKg > 0) {\n        maxAvailableWeight = equipment.dumbbellMaxKg;\n        equipmentType = 'dumbbells';\n        break;\n      } else if (group.includes('kettlebell') && equipment.kettlebellKg && equipment.kettlebellKg.length > 0) {\n        maxAvailableWeight = Math.max(...equipment.kettlebellKg);\n        equipmentType = 'kettlebells';\n        break;\n      } else if (group.includes('barbell') && equipment.barbell) {\n        maxAvailableWeight = 100; // Assume 100kg disponibili con barbell\n        equipmentType = 'barbell';\n        break;\n      } else if (group.includes('band') || group.includes('pullup_bar') || group.includes('none')) {\n        // Attrezzi bodyweight/band - nessun peso\n        maxAvailableWeight = 0;\n        equipmentType = group.includes('band') ? 'bands' : group.includes('pullup_bar') ? 'pullup_bar' : 'bodyweight';\n        break;\n      }\n    }\n  }\n  \n  const hasMinWeight = maxAvailableWeight >= (homeWithEq.minWeightKg || 0);\n\n  // CASO 2A: Ha attrezzatura adeguata\n  if (hasRequiredEquipment && hasMinWeight) {\n    const plannedWeight = assessmentWeight ? assessmentWeight * homeWithEq.weightMultiplier : maxAvailableWeight;\n    const availableWeight = Math.min(maxAvailableWeight, plannedWeight);\n    \n    return {\n      id: exerciseName.toLowerCase().replace(/\\s/g, '_'),\n      name: homeWithEq.name,\n      sets: getDefaultSets(goalType),\n      reps: getDefaultReps(goalType),\n      rest: getDefaultRest(goalType),\n      weight: Math.round(availableWeight * 10) / 10,\n      category: 'compound',\n      notes: availableWeight < plannedWeight * 0.9 ? \n        `‚ö†Ô∏è Peso disponibile ridotto: ${availableWeight}kg ${equipmentType} vs ${Math.round(plannedWeight)}kg pianificato` : \n        undefined\n    };\n  }\n\n  // CASO 2B: NO attrezzatura - bodyweight o giant set\n  if (homeBodyweight.isGiantSet) {\n    if (homeBodyweight.name === 'GIANT_SET_DEADLIFT') {\n      return createDeadliftGiantSet(goal, 'intermediate');\n    }\n    if (homeBodyweight.name === 'GIANT_SET_PULLUP') {\n      return createPullupGiantSet(goal, 'intermediate');\n    }\n  }\n\n  // Esercizio bodyweight normale\n  return {\n    id: exerciseName.toLowerCase().replace(/\\s/g, '_'),\n    name: homeBodyweight.name,\n    sets: getDefaultSets(goalType, true), // bodyweight = pi√π sets\n    reps: getDefaultReps(goalType, true), // bodyweight = pi√π reps\n    rest: getDefaultRest(goalType) - 20, // meno riposo\n    category: 'compound',\n    notes: 'Esercizio a corpo libero - compensato con volume aumentato'\n  };\n}\n\n// ===== COMPATIBILIT√Ä PROGRAMGENERATOR =====\n\n/**\n * Funzione di compatibilit√† per ProgramGenerator\n * Restituisce esercizio adattato o GiantSet\n */\nexport function getExerciseForLocation(\n  exerciseName: string,\n  location: 'gym' | 'home' | 'mixed',\n  equipment: Equipment | undefined,\n  goal: string,\n  level: string\n): string | GiantSet {\n  \n  const eq = equipment || { barbell: false, dumbbellMaxKg: 0, kettlebellKg: [], bands: false, pullupBar: false, bench: false };\n  const result = selectExerciseVariant(exerciseName, location, eq, goal);\n  \n  // Se √® GiantSet, restituiscilo\n  if ('rounds' in result) {\n    return result as GiantSet;\n  }\n  \n  // Altrimenti restituisci il nome dell'esercizio\n  return result.name;\n}\n\n// ===== CALIBRAZIONE EFFORT MIGLIORATA =====\n\nexport interface EffortCalibration {\n  setsMultiplier: number;\n  repsMultiplier: number;\n  restAdjustment?: number;\n  tempo?: string;\n  notes: string;\n}\n\n/**\n * Calibra l'effort quando il peso disponibile √® inferiore al pianificato\n * MIGLIORAMENTO: Aggiunto warning per peso < 50%\n */\nexport function calibrateEffort(\n  plannedWeight: number,\n  availableWeight: number,\n  goal: string\n): EffortCalibration {\n  \n  const ratio = availableWeight / plannedWeight;\n\n  // Peso OK (90%+)\n  if (ratio >= 0.9) {\n    return {\n      setsMultiplier: 1,\n      repsMultiplier: 1,\n      restAdjustment: 0,\n      notes: ''\n    };\n  }\n\n  // NUOVO: Peso molto ridotto (<50%) - WARNING\n  if (ratio < 0.5) {\n    return {\n      setsMultiplier: 1,\n      repsMultiplier: 1,\n      restAdjustment: 0,\n      notes: `‚ö†Ô∏è ATTENZIONE: Peso disponibile troppo basso (${availableWeight}kg vs ${plannedWeight}kg = ${Math.round(ratio * 100)}%). Considera di cambiare esercizio o utilizzare tecniche avanzate (rest-pause, drop sets, super slow).`\n    };\n  }\n\n  // Peso ridotto (50-90%) - calibrazione per obiettivo\n  switch(goal) {\n    case 'strength':\n    case 'performance':\n      return {\n        setsMultiplier: 1.5,\n        repsMultiplier: 1,\n        restAdjustment: 30,\n        tempo: \"4-0-1-0\",\n        notes: `‚ö° Compensazione FORZA: +50% serie, tempo eccentrico lento (4s), recupero maggiore (+30s). Peso: ${availableWeight}kg disponibile vs ${plannedWeight}kg pianificato.`\n      };\n\n    case 'muscle_gain':\n    case 'toning':\n      return {\n        setsMultiplier: 1,\n        repsMultiplier: 1.5,\n        restAdjustment: 0,\n        tempo: \"3-1-1-0\",\n        notes: `‚ö° Compensazione MASSA: +50% ripetizioni, TUT elevato (3s eccentrica, 1s pausa), stesso recupero. Peso: ${availableWeight}kg disponibile vs ${plannedWeight}kg pianificato.`\n      };\n\n    case 'weight_loss':\n      return {\n        setsMultiplier: 1.3,\n        repsMultiplier: 1.2,\n        restAdjustment: -20,\n        tempo: \"Esplosivo dove possibile\",\n        notes: `‚ö° Compensazione DIMAGRIMENTO: +30% serie, +20% reps, recupero ridotto (-20s) per aumentare densit√† metabolica. Peso: ${availableWeight}kg disponibile vs ${plannedWeight}kg pianificato.`\n      };\n\n    case 'disability':\n      return {\n        setsMultiplier: 1,\n        repsMultiplier: 1.2,\n        restAdjustment: 30,\n        tempo: \"Controllato\",\n        notes: `‚ö° Compensazione DISABILIT√Ä: +20% reps con tempo controllato, +30s recupero per sicurezza. Focus su tecnica perfetta. Peso: ${availableWeight}kg disponibile vs ${plannedWeight}kg pianificato.`\n      };\n\n    case 'pregnancy':\n      return {\n        setsMultiplier: 1,\n        repsMultiplier: 1.1,\n        restAdjustment: 20,\n        tempo: \"Moderato\",\n        notes: `‚ö° Compensazione GRAVIDANZA: +10% reps moderate, +20s recupero. Evitare sforzi eccessivi. Peso: ${availableWeight}kg disponibile vs ${plannedWeight}kg pianificato.`\n      };\n\n    default:\n      return {\n        setsMultiplier: 1.2,\n        repsMultiplier: 1.2,\n        restAdjustment: 0,\n        notes: `‚ö° Peso ridotto: compensato con +20% volume. ${availableWeight}kg disponibile vs ${plannedWeight}kg pianificato.`\n      };\n  }\n}\n","size_bytes":15717},"build.sh":{"content":"#!/bin/bash\nset -e\n\necho \"üî® Building the application...\"\nnpm run build\n\necho \"üì¶ Setting up build files for server...\"\nnode setup-build.js\n\necho \"‚úÖ Build completed successfully!\"\necho \"Files are ready in server/public/\"\n","size_bytes":227},"shared/pricingUtils.ts":{"content":"// Pricing utilities for TrainSmart\n\nexport type SubscriptionTier = 'base' | 'premium' | 'elite';\n\nexport interface PricingPlan {\n  tier: SubscriptionTier;\n  name: string;\n  basePrice: number; // Prezzo iniziale\n  increasedPrice: number; // Prezzo dopo 6 mesi\n  features: string[];\n  lockedFeatures?: string[];\n  description: string;\n  stripePriceId?: string; // Da configurare in Stripe\n}\n\n// Prezzi base (primi 6 mesi)\nexport const BASE_PRICES = {\n  base: 19.90,\n  premium: 29.90,\n  elite: 39.90,\n} as const;\n\n// Prezzi aumentati (dopo 6 mesi)\nexport const INCREASED_PRICES = {\n  base: 29.90,\n  premium: 39.90,\n  elite: 49.90,\n} as const;\n\n// Calcola il prezzo attuale in base alla data di inizio abbonamento\nexport function getCurrentPrice(\n  tier: SubscriptionTier, \n  subscriptionStartDate: Date | null\n): number {\n  if (!subscriptionStartDate) {\n    return BASE_PRICES[tier];\n  }\n\n  const monthsSinceStart = getMonthsSinceStart(subscriptionStartDate);\n  \n  // Dopo 6 mesi, prezzo aumentato\n  if (monthsSinceStart >= 6) {\n    return INCREASED_PRICES[tier];\n  }\n  \n  return BASE_PRICES[tier];\n}\n\n// Aggiunge N mesi a una data, gestendo correttamente overflow giorni\nfunction addMonths(date: Date, months: number): Date {\n  const result = new Date(date);\n  const originalDay = result.getDate();\n  \n  // Imposta giorno a 1 per evitare overflow\n  result.setDate(1);\n  result.setMonth(result.getMonth() + months);\n  \n  // Trova ultimo giorno valido del mese target\n  const lastDayOfMonth = new Date(result.getFullYear(), result.getMonth() + 1, 0).getDate();\n  \n  // Usa il giorno originale o l'ultimo giorno del mese (il minore)\n  result.setDate(Math.min(originalDay, lastDayOfMonth));\n  \n  return result;\n}\n\n// Verifica se sono passati almeno 6 mesi dalla data di inizio\nfunction getMonthsSinceStart(startDate: Date): number {\n  const now = new Date();\n  const sixMonthsLater = addMonths(new Date(startDate), 6);\n  \n  // Se ora >= data + 6 mesi, ritorna 6+, altrimenti meno di 6\n  return now >= sixMonthsLater ? 6 : 0;\n}\n\n// Verifica se l'utente pu√≤ usare la correzione AI video\nexport function canUseAiCorrection(\n  tier: SubscriptionTier,\n  lastAiCorrectionDate: Date | null,\n  aiCorrectionsUsed: number\n): boolean {\n  // Elite: illimitato\n  if (tier === 'elite') {\n    return true;\n  }\n\n  // Premium: 1/settimana\n  if (tier === 'premium') {\n    // Se non ha mai usato la correzione, pu√≤ usarla\n    if (!lastAiCorrectionDate) {\n      return true;\n    }\n\n    // Verifica se √® passata almeno una settimana dall'ultima correzione\n    const daysSinceLastCorrection = getDaysSince(lastAiCorrectionDate);\n    return daysSinceLastCorrection >= 7;\n  }\n\n  // Base: no access\n  return false;\n}\n\n// Calcola i giorni trascorsi da una data\nfunction getDaysSince(date: Date): number {\n  const now = new Date();\n  const past = new Date(date);\n  const diffTime = Math.abs(now.getTime() - past.getTime());\n  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  return diffDays;\n}\n\n// Configurazione dei piani\nexport const PRICING_PLANS: PricingPlan[] = [\n  {\n    tier: 'base',\n    name: 'Base',\n    basePrice: BASE_PRICES.base,\n    increasedPrice: INCREASED_PRICES.base,\n    description: 'Tutto ci√≤ che serve per iniziare',\n    features: [\n      'Screening iniziale completo',\n      'Quiz tecnico sugli esercizi',\n      'Programmi di allenamento personalizzati',\n      'Targeting obiettivi specifici (toning/massa)',\n      'Tracciamento workout completo',\n      'Gestione zone doloranti',\n      'Adattamento automatico carichi',\n      'Storico progressi',\n    ],\n    lockedFeatures: [\n      'Supporto prioritario (Elite)',\n      'Accesso anticipato nuove funzionalit√† (Elite)',\n    ],\n  },\n  {\n    tier: 'premium',\n    name: 'Premium',\n    basePrice: BASE_PRICES.premium,\n    increasedPrice: INCREASED_PRICES.premium,\n    description: 'Tutto quello che serve per eccellere',\n    features: [\n      'Tutto del piano Base',\n      'Analisi approfondita progressi',\n      'Suggerimenti avanzati allenamento',\n      'Report settimanali personalizzati',\n    ],\n    lockedFeatures: [\n      'Supporto prioritario 24/7 (Elite)',\n      'Accesso anticipato funzionalit√† (Elite)',\n    ],\n  },\n  {\n    tier: 'elite',\n    name: 'Elite',\n    basePrice: BASE_PRICES.elite,\n    increasedPrice: INCREASED_PRICES.elite,\n    description: 'Il massimo livello di personalizzazione',\n    features: [\n      'Tutto del piano Premium',\n      'Supporto prioritario 24/7',\n      'Accesso anticipato nuove funzionalit√†',\n      'Consultazioni mensili personalizzate',\n      'Report analitici avanzati',\n    ],\n    lockedFeatures: [],\n  },\n];\n\n// Helper per ottenere il piano dall'abbonamento tier\nexport function getPlan(tier: SubscriptionTier): PricingPlan {\n  return PRICING_PLANS.find(p => p.tier === tier) || PRICING_PLANS[0];\n}\n\n// Verifica se un tier ha accesso a una feature\nexport function hasFeatureAccess(userTier: SubscriptionTier, featureTier: SubscriptionTier): boolean {\n  const tierOrder: SubscriptionTier[] = ['base', 'premium', 'elite'];\n  const userIndex = tierOrder.indexOf(userTier);\n  const featureIndex = tierOrder.indexOf(featureTier);\n  \n  return userIndex >= featureIndex;\n}\n","size_bytes":5173},"scripts/postbuild.js":{"content":"import { copyFileSync, mkdirSync, readdirSync, statSync } from 'fs';\nimport { join } from 'path';\n\nfunction copyRecursive(src, dest) {\n  try {\n    mkdirSync(dest, { recursive: true });\n  } catch (err) {\n    // Directory might already exist\n  }\n\n  const entries = readdirSync(src, { withFileTypes: true });\n\n  for (const entry of entries) {\n    const srcPath = join(src, entry.name);\n    const destPath = join(dest, entry.name);\n\n    if (entry.isDirectory()) {\n      copyRecursive(srcPath, destPath);\n    } else {\n      copyFileSync(srcPath, destPath);\n    }\n  }\n}\n\nconsole.log('Copying build files from dist/public to server/public...');\ncopyRecursive('dist/public', 'server/public');\nconsole.log('Build files copied successfully!');\n","size_bytes":734},"setup-build.js":{"content":"import { existsSync, symlinkSync, unlinkSync, mkdirSync } from 'fs';\nimport { resolve, dirname } from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __dirname = dirname(fileURLToPath(import.meta.url));\n\n// Ensure server directory exists\nconst serverDir = resolve(__dirname, 'server');\nif (!existsSync(serverDir)) {\n  mkdirSync(serverDir, { recursive: true });\n}\n\n// Path where server expects to find files\nconst serverPublicPath = resolve(__dirname, 'server', 'public');\n\n// Path where vite builds files\nconst distPublicPath = resolve(__dirname, 'dist', 'public');\n\ntry {\n  // Remove existing symlink or directory if it exists\n  if (existsSync(serverPublicPath)) {\n    try {\n      unlinkSync(serverPublicPath);\n    } catch (err) {\n      console.log('No symlink to remove, continuing...');\n    }\n  }\n\n  // Create symlink from server/public -> ../dist/public\n  const relativePath = '../dist/public';\n  symlinkSync(relativePath, serverPublicPath, 'dir');\n  console.log('‚úÖ Created symlink: server/public -> dist/public');\n} catch (err) {\n  console.error('‚ùå Error creating symlink:', err.message);\n  console.log('Falling back to directory copy method...');\n  \n  // Fallback: copy files if symlink fails\n  const { copyFileSync, readdirSync, statSync } = await import('fs');\n  const { join } = await import('path');\n  \n  function copyRecursive(src, dest) {\n    try {\n      mkdirSync(dest, { recursive: true });\n    } catch (err) {\n      // Directory might already exist\n    }\n\n    if (!existsSync(src)) {\n      console.log(`Source directory ${src} does not exist yet, skipping copy...`);\n      return;\n    }\n\n    const entries = readdirSync(src, { withFileTypes: true });\n\n    for (const entry of entries) {\n      const srcPath = join(src, entry.name);\n      const destPath = join(dest, entry.name);\n\n      if (entry.isDirectory()) {\n        copyRecursive(srcPath, destPath);\n      } else {\n        copyFileSync(srcPath, destPath);\n      }\n    }\n  }\n\n  if (existsSync(distPublicPath)) {\n    copyRecursive(distPublicPath, serverPublicPath);\n    console.log('‚úÖ Copied files from dist/public to server/public');\n  }\n}\n","size_bytes":2119},"AGGIORNAMENTI_OTTOBRE_2024.md":{"content":"# TrainSmart - Aggiornamenti Ottobre 2024\n\n## üìã Riepilogo Modifiche\n\n### 1. ‚úÖ Sistema di Targeting Parti del Corpo (Body Part Targeting)\n\n**Obiettivo**: Permettere agli utenti con obiettivi \"Tonificazione\" o \"Ipertrofia\" di selezionare parti del corpo specifiche su cui concentrarsi.\n\n#### Implementazione\n\n**Database Schema** (`shared/schema.ts`):\n- Aggiunto campo `specificBodyParts` alla tabella `screenings`\n- Tipo: `jsonb` array di stringhe\n- Valori possibili: `upper_chest`, `arms`, `shoulders`, `back_width`, `back_thickness`, `legs`, `glutes`, `abs`, `calves`\n\n**Frontend** (`client/src/components/ScreeningFlow.tsx`):\n- Aggiunto step \"Obiettivi Specifici\" dopo la selezione del goal\n- Visibile SOLO per goal \"toning\" e \"muscle_gain\"\n- UI multi-select con pulsanti visivi per ogni parte del corpo\n- 9 opzioni disponibili: Petto Alto, Braccia, Spalle, Schiena Larga, Schiena Spessa, Gambe, Glutei, Addome, Polpacci\n\n**Backend** (`server/programGenerator.ts`):\n- Creata funzione `getExercisesForBodyPart()` con mapping esercizi per ogni parte del corpo\n- Sistema di arricchimento programma che aggiunge max 2 esercizi per parte selezionata\n- **Triple Safety System**:\n  1. **Dedupplicazione**: Set-based per evitare esercizi duplicati\n  2. **Safety Filter**: Controllo pregnancy/disability con sostituzioni automatiche\n  3. **Pain Areas Check**: Verifica compatibilit√† con zone doloranti dell'utente\n\n**Esempio Mapping Esercizi**:\n```typescript\nconst BODY_PART_EXERCISES = {\n  arms: {\n    beginner: [\"Curl bilanciere\", \"French press\"],\n    intermediate: [\"Curl manubri\", \"Skull crusher\", \"Hammer curl\"],\n    advanced: [\"Curl bilanciere\", \"Curl Scott\", \"Dips strette\", \"Pushdown\"]\n  },\n  upper_chest: {\n    beginner: [\"Panca inclinata\"],\n    intermediate: [\"Panca inclinata bilanciere\", \"Croci manubri inclinata\"],\n    advanced: [\"Panca inclinata\", \"Croci cavi alta-bassa\"]\n  },\n  // ... altri 7 gruppi\n}\n```\n\n#### Risultato\n- Gli utenti possono ora focalizzarsi su parti specifiche del corpo\n- Il programma viene automaticamente arricchito con esercizi di isolamento\n- Massima sicurezza: tutti gli esercizi extra passano attraverso i filtri di sicurezza\n- **BUG FIX**: Applicato controllo pain areas anche a generatePullDay (era mancante)\n\n---\n\n### 2. üí∞ Nuovo Sistema di Pricing a Tre Livelli\n\n**Obiettivo**: Implementare tre piani di abbonamento (Base, Premium, Elite) con aumento automatico del prezzo dopo 6 mesi.\n\n#### Piani di Abbonamento\n\n**1. Piano Base - ‚Ç¨19.90/mese**\n- Primi 6 mesi: ‚Ç¨19.90\n- Dopo 6 mesi: ‚Ç¨29.90\n- Features:\n  - Screening iniziale completo\n  - Quiz tecnico sugli esercizi\n  - Programmi di allenamento personalizzati\n  - Targeting obiettivi specifici (toning/massa)\n  - Tracciamento workout completo\n  - Gestione zone doloranti\n  - Adattamento automatico carichi\n  - Storico progressi\n\n**2. Piano Premium - ‚Ç¨29.90/mese** üåü\n- Primi 6 mesi: ‚Ç¨29.90\n- Dopo 6 mesi: ‚Ç¨39.90\n- Features Base +\n  - **Correzione AI esercizi (1/settimana)**\n  - Suggerimenti tecnici personalizzati\n  - Analisi automatica errori comuni\n  - Feedback su form e postura\n\n**3. Piano Elite - ‚Ç¨39.90/mese** ‚ö°\n- Primi 6 mesi: ‚Ç¨39.90\n- Dopo 6 mesi: ‚Ç¨49.90\n- Features Premium +\n  - Correzioni AI illimitate\n  - Analisi video forma\n  - Consulenze personalizzate mensili\n  - Supporto prioritario 24/7\n  - Accesso beta nuove funzionalit√†\n\n#### Implementazione Tecnica\n\n**Database Schema** (`shared/schema.ts`):\n```typescript\n// Tabella users aggiornata\n{\n  subscriptionTier: varchar(\"subscription_tier\").default(\"base\"), // base, premium, elite\n  subscriptionStartDate: timestamp(\"subscription_start_date\"),\n  subscriptionId: varchar(\"subscription_id\"), // Stripe subscription ID\n  aiCorrectionsUsed: integer(\"ai_corrections_used\").default(0),\n  lastAiCorrectionDate: timestamp(\"last_ai_correction_date\"),\n}\n\n// Tabella payments aggiornata\n{\n  subscriptionTier: varchar(\"subscription_tier\").notNull(),\n  subscriptionId: varchar(\"subscription_id\"),\n  // ... altri campi\n}\n```\n\n**Logica Pricing** (`shared/pricingUtils.ts`):\n- Funzione `getCurrentPrice()`: calcola prezzo attuale in base a data inizio abbonamento\n- Funzione `canUseAiCorrection()`: verifica se utente Premium pu√≤ usare correzione AI (max 1/settimana)\n- Funzione `hasFeatureAccess()`: verifica accesso a feature in base al tier\n- Costanti `BASE_PRICES` e `INCREASED_PRICES` per gestione prezzi\n\n**Frontend**:\n- `Pricing.tsx`: Griglia responsive 3 colonne con i piani\n- `PaymentModal.tsx`: Modal unificato per tutti e tre i tier con selezione metodo pagamento (Stripe/PayPal)\n- Icone dinamiche per tier: Crown (Base), Sparkles (Premium), Zap (Elite)\n- Badge \"Pi√π Popolare\" sul piano Premium\n- Indicazione chiara aumento prezzo dopo 6 mesi\n\n**Backend** (in preparazione):\n- Endpoints Stripe per checkout con tier specifico\n- Gestione webhook Stripe per aggiornamento stato abbonamento\n- Validazione accesso feature in base a tier utente\n\n#### Dipendenze Installate\n- `stripe` (npm package) per integrazione pagamenti\n\n---\n\n### 3. üßπ Miglioramenti UI e Testi\n\n**Modifiche apportate**:\n\n1. ‚úÖ **Rimossa sezione obsoleta** \"Accesso Semplificato\" da `Features.tsx`\n   - La frase era generica e non necessaria (autenticazione standard)\n\n2. ‚úÖ **Aggiornata descrizione Quiz Tecnico**\n   - PRIMA: \"Valuta le tue conoscenze sulla tecnica degli esercizi fondamentali\"\n   - DOPO: \"Quiz iniziale per stabilire il tuo livello di conoscenza degli esercizi\"\n   - Motivo: Evitare che gli utenti pensino sia un'app di quiz\n\n3. ‚úÖ **Rimosso riferimento a formula Brzycki**\n   - PRIMA: \"Calcolo automatico dei pesi usando formule validate (Brzycki)\"\n   - DOPO: \"Calcolo automatico dei pesi usando formule validate scientificamente\"\n   - Motivo: Non citare formule specifiche pubblicamente\n\n---\n\n## üóÇÔ∏è File Modificati\n\n### Schema & Database\n- ‚úÖ `shared/schema.ts` - Aggiunto `specificBodyParts`, aggiornato `users` e `payments` per subscription tiers\n- ‚úÖ Database migrato con `npm run db:push --force`\n\n### Backend\n- ‚úÖ `server/programGenerator.ts` - Sistema body part targeting con triple safety + bug fix pain areas su Pull Day\n- ‚úÖ `shared/pricingUtils.ts` - **NUOVO** - Logica pricing e calcolo prezzi dinamici\n\n### Frontend\n- ‚úÖ `client/src/components/ScreeningFlow.tsx` - Aggiunto step \"Obiettivi Specifici\"\n- ‚úÖ `client/src/components/Pricing.tsx` - **AGGIORNATO** - 3 piani con prezzi dinamici\n- ‚úÖ `client/src/components/PaymentModal.tsx` - **AGGIORNATO** - Supporto 3 tier\n- ‚úÖ `client/src/components/Features.tsx` - Rimossa sezione obsoleta + testi migliorati\n\n### Documentazione\n- ‚úÖ `replit.md` - Aggiornato con dettagli body part targeting\n- ‚úÖ `AGGIORNAMENTI_OTTOBRE_2024.md` - Documento riassuntivo per Claude\n\n---\n\n## üîÑ Prossimi Passi\n\n### Da Completare\n1. **Endpoints Stripe**:\n   - `/api/payment/stripe/checkout` - Creazione checkout session per tier specifico\n   - `/api/stripe/webhook` - Gestione eventi Stripe (payment success, subscription created)\n   - Aggiornamento `storage.ts` per metodi subscription\n\n2. **Configurazione Stripe**:\n   - Chiedere all'utente le secret keys: `STRIPE_SECRET_KEY`, `VITE_STRIPE_PUBLIC_KEY`\n   - Creare Price ID su Stripe Dashboard per i 3 tier\n   - Configurare webhook URL su Stripe\n\n3. **Feature AI Correction** (futuro):\n   - Implementare UI per richiedere correzione AI (solo Premium)\n   - Logica backend per analisi esercizi con AI\n   - Rate limiting 1/settimana per Premium, illimitato per Elite\n\n4. **Testing**:\n   - Test end-to-end del flusso di acquisto\n   - Verifica calcolo prezzi dinamici dopo 6 mesi\n   - Test sistema body part targeting con tutti i goal\n\n---\n\n## üìä Statistiche Implementazione\n\n- **Files creati**: 2 (`pricingUtils.ts`, `AGGIORNAMENTI_OTTOBRE_2024.md`)\n- **Files modificati**: 6\n- **Nuove tabelle DB**: 0 (solo aggiornamenti schema)\n- **Nuove features utente**: 2 (Body Part Targeting, Pricing a 3 livelli)\n- **Bug fix**: 1 (Pain areas check su Pull Day)\n- **Miglioramenti UI**: 3 (testi pi√π chiari)\n- **LOC aggiunte**: ~800 linee\n\n---\n\n## üéØ Valore per l'Utente\n\n### Body Part Targeting\n- ‚úÖ Maggiore personalizzazione programmi\n- ‚úÖ Focus su zone specifiche da sviluppare  \n- ‚úÖ Sicurezza garantita con triple filtri\n- ‚úÖ Funziona SOLO con obiettivi Tonificazione e Ipertrofia\n\n### Nuovo Pricing\n- ‚úÖ Opzioni flessibili per ogni budget\n- ‚úÖ Piano Premium con AI per miglioramento tecnica (1 correzione/settimana)\n- ‚úÖ Piano Elite per supporto completo (correzioni illimitate)\n- ‚úÖ Prezzi bloccati primi 6 mesi, poi +‚Ç¨10/mese\n- ‚úÖ NO piani nutrizionali (per ora)\n\n### Miglioramenti UX\n- ‚úÖ Testi pi√π chiari e meno tecnici\n- ‚úÖ Nessun riferimento a formule specifiche\n- ‚úÖ Descrizioni che evitano confusione sul tipo di app\n\n---\n\n## üîß Note Tecniche\n\n### Sistema di Sicurezza Body Part\nTutti gli esercizi aggiunti per body part targeting passano attraverso:\n1. Dedupilicazione (Set-based)\n2. Controllo pregnancy safety ‚Üí sostituzione se unsafe\n3. Controllo disability safety ‚Üí sostituzione se unsafe  \n4. Controllo pain areas ‚Üí skip se incompatibile\n\n### Calcolo Prezzi Dinamici\n```typescript\n// Logica aumento prezzo dopo 6 mesi\nfunction getCurrentPrice(tier, subscriptionStartDate) {\n  const monthsSinceStart = getMonthsSinceStart(subscriptionStartDate);\n  return monthsSinceStart >= 6 ? INCREASED_PRICES[tier] : BASE_PRICES[tier];\n}\n```\n\n### AI Correction Limits\n- **Base**: Nessuna correzione AI\n- **Premium**: 1 correzione/settimana (tracked in DB)\n- **Elite**: Illimitate\n\n---\n\n*Documento generato: Ottobre 2024*  \n*Versione TrainSmart: v2.0*  \n*Ultimo aggiornamento: Rimozione piani nutrizionali, miglioramenti testi UI*\n","size_bytes":9636},"client/src/components/AdaptLocationDialog.tsx":{"content":"import { useState } from \"react\";\nimport { X, Home, Dumbbell, HelpCircle } from \"lucide-react\";\n\ninterface AdaptLocationDialogProps {\n  isOpen: boolean;\n  onClose: () => void;\n  programId: string;\n  dayName: string;\n  currentLocation: string;\n  onAdapt: (exercises: any[], location: string) => void;\n}\n\nexport default function AdaptLocationDialog({\n  isOpen,\n  onClose,\n  programId,\n  dayName,\n  currentLocation,\n  onAdapt,\n}: AdaptLocationDialogProps) {\n  const [selectedLocation, setSelectedLocation] = useState<\"gym\" | \"home\">(\n    currentLocation === \"gym\" ? \"gym\" : \"home\"\n  );\n  const [homeType, setHomeType] = useState<\"with_equipment\" | \"bodyweight\">(\n    \"bodyweight\"\n  );\n  const [equipment, setEquipment] = useState({\n    barbell: false,\n    dumbbellMaxKg: 0,\n    kettlebellKg: [] as number[],\n    bands: false,\n    pullupBar: false,\n    bench: false,\n  });\n  const [isAdapting, setIsAdapting] = useState(false);\n\n  if (!isOpen) return null;\n\n  const handleAdapt = async () => {\n    setIsAdapting(true);\n    try {\n      const payload: any = {\n        location: selectedLocation,\n      };\n\n      // Per casa, distingui tra bodyweight e con attrezzatura\n      if (selectedLocation === \"home\") {\n        if (homeType === \"with_equipment\") {\n          // Invia equipment solo se almeno un campo √® valorizzato\n          const hasEquipment = \n            equipment.barbell ||\n            equipment.bands ||\n            equipment.pullupBar ||\n            equipment.bench ||\n            (equipment.dumbbellMaxKg && equipment.dumbbellMaxKg > 0);\n\n          if (hasEquipment) {\n            payload.equipment = equipment;\n          } else {\n            // Se selezionato \"con attrezzatura\" ma nessuna checkbox spuntata, usa bodyweight\n            payload.equipment = {\n              barbell: false,\n              dumbbellMaxKg: 0,\n              bands: false,\n              pullupBar: false,\n              bench: false,\n            };\n          }\n        } else {\n          // Bodyweight: equipment vuoto\n          payload.equipment = {\n            barbell: false,\n            dumbbellMaxKg: 0,\n            bands: false,\n            pullupBar: false,\n            bench: false,\n          };\n        }\n      }\n\n      const res = await fetch(\n        `/api/program/${programId}/day/${encodeURIComponent(dayName)}/adapt`,\n        {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(payload),\n        }\n      );\n\n      if (!res.ok) {\n        throw new Error(\"Errore adattamento\");\n      }\n\n      const data = await res.json();\n      onAdapt(data.exercises, data.location);\n      onClose();\n    } catch (error) {\n      console.error(\"Errore adattamento:\", error);\n      alert(\"Errore durante l'adattamento. Riprova.\");\n    } finally {\n      setIsAdapting(false);\n    }\n  };\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60\">\n      <div className=\"bg-slate-900 rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto border border-slate-700\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-slate-700\">\n          <div>\n            <h2 className=\"text-2xl font-bold\">‚öôÔ∏è Adatta Workout</h2>\n            <p className=\"text-sm text-slate-400 mt-1\">\n              Modifica dove farai l'allenamento oggi\n            </p>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-slate-800 rounded-lg transition-colors\"\n            data-testid=\"button-close-adapt\"\n          >\n            <X className=\"w-6 h-6\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"p-6 space-y-6\">\n          {/* Location Selection */}\n          <div>\n            <label className=\"block text-sm font-semibold mb-3\">\n              Dove ti alleni oggi?\n            </label>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <button\n                onClick={() => setSelectedLocation(\"gym\")}\n                className={`p-6 rounded-xl border-2 transition-all ${\n                  selectedLocation === \"gym\"\n                    ? \"border-emerald-600 bg-emerald-600/10\"\n                    : \"border-slate-700 hover:border-slate-600\"\n                }`}\n                data-testid=\"button-location-gym\"\n              >\n                <Dumbbell className=\"w-10 h-10 mx-auto mb-3 text-emerald-400\" />\n                <p className=\"font-bold text-lg\">üèãÔ∏è Palestra</p>\n                <p className=\"text-xs text-slate-400 mt-1\">\n                  Attrezzatura completa\n                </p>\n              </button>\n\n              <button\n                onClick={() => setSelectedLocation(\"home\")}\n                className={`p-6 rounded-xl border-2 transition-all ${\n                  selectedLocation === \"home\"\n                    ? \"border-emerald-600 bg-emerald-600/10\"\n                    : \"border-slate-700 hover:border-slate-600\"\n                }`}\n                data-testid=\"button-location-home\"\n              >\n                <Home className=\"w-10 h-10 mx-auto mb-3 text-blue-400\" />\n                <p className=\"font-bold text-lg\">üè† Casa</p>\n                <p className=\"text-xs text-slate-400 mt-1\">\n                  Con o senza attrezzatura\n                </p>\n              </button>\n            </div>\n          </div>\n\n          {/* Home Equipment Selection */}\n          {selectedLocation === \"home\" && (\n            <div className=\"space-y-4 p-4 bg-slate-800 rounded-lg\">\n              <label className=\"block text-sm font-semibold\">\n                Che attrezzatura hai a disposizione?\n              </label>\n\n              <div className=\"grid grid-cols-2 gap-3\">\n                <button\n                  onClick={() => setHomeType(\"bodyweight\")}\n                  className={`p-4 rounded-lg border-2 transition-all ${\n                    homeType === \"bodyweight\"\n                      ? \"border-orange-600 bg-orange-600/10\"\n                      : \"border-slate-600 hover:border-slate-500\"\n                  }`}\n                  data-testid=\"button-home-bodyweight\"\n                >\n                  <p className=\"font-semibold\">ü§∏ Solo Corpo Libero</p>\n                  <p className=\"text-xs text-slate-400 mt-1\">\n                    Nessuna attrezzatura\n                  </p>\n                </button>\n\n                <button\n                  onClick={() => setHomeType(\"with_equipment\")}\n                  className={`p-4 rounded-lg border-2 transition-all ${\n                    homeType === \"with_equipment\"\n                      ? \"border-orange-600 bg-orange-600/10\"\n                      : \"border-slate-600 hover:border-slate-500\"\n                  }`}\n                  data-testid=\"button-home-equipment\"\n                >\n                  <p className=\"font-semibold\">üèãÔ∏è Ho Attrezzatura</p>\n                  <p className=\"text-xs text-slate-400 mt-1\">\n                    Manubri, bande, ecc.\n                  </p>\n                </button>\n              </div>\n\n              {/* Equipment Details */}\n              {homeType === \"with_equipment\" && (\n                <div className=\"space-y-3 mt-4 pt-4 border-t border-slate-700\">\n                  <p className=\"text-sm text-slate-300 font-medium\">\n                    Seleziona cosa hai:\n                  </p>\n\n                  <div className=\"grid grid-cols-2 gap-3\">\n                    <label className=\"flex items-center gap-2 p-3 bg-slate-900 rounded-lg cursor-pointer hover:bg-slate-800\">\n                      <input\n                        type=\"checkbox\"\n                        checked={equipment.barbell}\n                        onChange={(e) =>\n                          setEquipment({ ...equipment, barbell: e.target.checked })\n                        }\n                        className=\"w-4 h-4\"\n                        data-testid=\"checkbox-barbell\"\n                      />\n                      <span className=\"text-sm\">Bilanciere</span>\n                    </label>\n\n                    <label className=\"flex items-center gap-2 p-3 bg-slate-900 rounded-lg cursor-pointer hover:bg-slate-800\">\n                      <input\n                        type=\"checkbox\"\n                        checked={equipment.bands}\n                        onChange={(e) =>\n                          setEquipment({ ...equipment, bands: e.target.checked })\n                        }\n                        className=\"w-4 h-4\"\n                        data-testid=\"checkbox-bands\"\n                      />\n                      <span className=\"text-sm\">Bande Elastiche</span>\n                    </label>\n\n                    <label className=\"flex items-center gap-2 p-3 bg-slate-900 rounded-lg cursor-pointer hover:bg-slate-800\">\n                      <input\n                        type=\"checkbox\"\n                        checked={equipment.pullupBar}\n                        onChange={(e) =>\n                          setEquipment({ ...equipment, pullupBar: e.target.checked })\n                        }\n                        className=\"w-4 h-4\"\n                        data-testid=\"checkbox-pullup\"\n                      />\n                      <span className=\"text-sm\">Sbarra Trazioni</span>\n                    </label>\n\n                    <label className=\"flex items-center gap-2 p-3 bg-slate-900 rounded-lg cursor-pointer hover:bg-slate-800\">\n                      <input\n                        type=\"checkbox\"\n                        checked={equipment.bench}\n                        onChange={(e) =>\n                          setEquipment({ ...equipment, bench: e.target.checked })\n                        }\n                        className=\"w-4 h-4\"\n                        data-testid=\"checkbox-bench\"\n                      />\n                      <span className=\"text-sm\">Panca</span>\n                    </label>\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <label className=\"block text-sm\">\n                      Manubri (kg massimi per mano):\n                    </label>\n                    <input\n                      type=\"number\"\n                      value={equipment.dumbbellMaxKg || \"\"}\n                      onChange={(e) =>\n                        setEquipment({\n                          ...equipment,\n                          dumbbellMaxKg: parseFloat(e.target.value) || 0,\n                        })\n                      }\n                      placeholder=\"Es. 20\"\n                      className=\"w-full bg-slate-900 border border-slate-700 rounded-lg px-4 py-2\"\n                      data-testid=\"input-dumbbell-max\"\n                    />\n                  </div>\n\n                  <div className=\"flex items-start gap-2 p-3 bg-blue-900/20 border border-blue-700/50 rounded-lg\">\n                    <HelpCircle className=\"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5\" />\n                    <p className=\"text-xs text-blue-300\">\n                      AdaptFlow sostituir√† automaticamente gli esercizi con\n                      varianti adatte all'attrezzatura che hai indicato.\n                    </p>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Action Buttons */}\n          <div className=\"flex gap-3 pt-4\">\n            <button\n              onClick={onClose}\n              className=\"flex-1 px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg font-semibold transition-colors\"\n              data-testid=\"button-cancel-adapt\"\n            >\n              Annulla\n            </button>\n            <button\n              onClick={handleAdapt}\n              disabled={isAdapting}\n              className=\"flex-1 px-6 py-3 bg-emerald-600 hover:bg-emerald-700 disabled:opacity-50 rounded-lg font-semibold transition-colors\"\n              data-testid=\"button-confirm-adapt\"\n            >\n              {isAdapting ? \"Adattamento...\" : \"‚úì Adatta Workout\"}\n            </button>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":12051},"client/src/components/LanguageToggle.tsx":{"content":"import { useTranslation } from \"@/lib/i18n\";\nimport { Globe } from \"lucide-react\";\n\nexport default function LanguageToggle() {\n  const { language, setLanguage } = useTranslation();\n\n  return (\n    <button\n      onClick={() => setLanguage(language === \"it\" ? \"en\" : \"it\")}\n      className=\"flex items-center gap-2 px-3 py-2 rounded-lg hover:bg-accent transition-colors\"\n      data-testid=\"button-language-toggle\"\n      title={language === \"it\" ? \"Switch to English\" : \"Passa all'Italiano\"}\n    >\n      <Globe className=\"w-5 h-5\" />\n      <span className=\"font-semibold uppercase\">{language}</span>\n    </button>\n  );\n}\n","size_bytes":618},"client/src/lib/i18n.tsx":{"content":"import { createContext, useContext, useState, useEffect } from \"react\";\n\ntype Language = \"it\" | \"en\";\n\ninterface Translations {\n  [key: string]: {\n    it: string;\n    en: string;\n  };\n}\n\nconst translations: Translations = {\n  // Navigation & Common\n  \"nav.home\": { it: \"Home\", en: \"Home\" },\n  \"nav.program\": { it: \"Programma\", en: \"Program\" },\n  \"nav.progress\": { it: \"Progressi\", en: \"Progress\" },\n  \"nav.pricing\": { it: \"Prezzi\", en: \"Pricing\" },\n  \"common.loading\": { it: \"Caricamento...\", en: \"Loading...\" },\n  \"common.save\": { it: \"Salva\", en: \"Save\" },\n  \"common.cancel\": { it: \"Annulla\", en: \"Cancel\" },\n  \"common.continue\": { it: \"Continua\", en: \"Continue\" },\n  \"common.back\": { it: \"Indietro\", en: \"Back\" },\n  \"common.next\": { it: \"Avanti\", en: \"Next\" },\n  \"common.close\": { it: \"Chiudi\", en: \"Close\" },\n  \n  // Workout Tracker\n  \"workout.complete\": { it: \"Completa\", en: \"Complete\" },\n  \"workout.adapt\": { it: \"Adatta\", en: \"Adapt\" },\n  \"workout.exercise\": { it: \"Esercizio\", en: \"Exercise\" },\n  \"workout.rest\": { it: \"Recupero\", en: \"Rest\" },\n  \"workout.skip_rest\": { it: \"Salta Recupero\", en: \"Skip Rest\" },\n  \"workout.previous\": { it: \"Precedente\", en: \"Previous\" },\n  \"workout.next\": { it: \"Successivo\", en: \"Next\" },\n  \"workout.notes\": { it: \"Note Workout\", en: \"Workout Notes\" },\n  \"workout.notes_placeholder\": { \n    it: \"Come ti sei sentito? Difficolt√†? Note tecniche...\", \n    en: \"How did you feel? Difficulties? Technical notes...\" \n  },\n  \n  // Adapt Location Dialog\n  \"adapt.title\": { it: \"Adatta Workout\", en: \"Adapt Workout\" },\n  \"adapt.subtitle\": { it: \"Modifica dove farai l'allenamento oggi\", en: \"Change where you'll train today\" },\n  \"adapt.location_question\": { it: \"Dove ti alleni oggi?\", en: \"Where are you training today?\" },\n  \"adapt.gym\": { it: \"Palestra\", en: \"Gym\" },\n  \"adapt.gym_description\": { it: \"Attrezzatura completa\", en: \"Full equipment\" },\n  \"adapt.home\": { it: \"Casa\", en: \"Home\" },\n  \"adapt.home_description\": { it: \"Con o senza attrezzatura\", en: \"With or without equipment\" },\n  \"adapt.equipment_question\": { it: \"Che attrezzatura hai a disposizione?\", en: \"What equipment do you have?\" },\n  \"adapt.bodyweight\": { it: \"Solo Corpo Libero\", en: \"Bodyweight Only\" },\n  \"adapt.bodyweight_description\": { it: \"Nessuna attrezzatura\", en: \"No equipment\" },\n  \"adapt.with_equipment\": { it: \"Ho Attrezzatura\", en: \"I Have Equipment\" },\n  \"adapt.with_equipment_description\": { it: \"Manubri, bande, ecc.\", en: \"Dumbbells, bands, etc.\" },\n  \"adapt.select_equipment\": { it: \"Seleziona cosa hai:\", en: \"Select what you have:\" },\n  \"adapt.barbell\": { it: \"Bilanciere\", en: \"Barbell\" },\n  \"adapt.bands\": { it: \"Bande Elastiche\", en: \"Resistance Bands\" },\n  \"adapt.pullup_bar\": { it: \"Sbarra Trazioni\", en: \"Pull-up Bar\" },\n  \"adapt.bench\": { it: \"Panca\", en: \"Bench\" },\n  \"adapt.dumbbell_max\": { it: \"Manubri (kg massimi per mano):\", en: \"Dumbbells (max kg per hand):\" },\n  \"adapt.dumbbell_placeholder\": { it: \"Es. 20\", en: \"E.g. 20\" },\n  \"adapt.help_text\": { \n    it: \"AdaptFlow sostituir√† automaticamente gli esercizi con varianti adatte all'attrezzatura che hai indicato.\", \n    en: \"AdaptFlow will automatically substitute exercises with variants suitable for your indicated equipment.\" \n  },\n  \"adapt.confirm\": { it: \"‚úì Adatta Workout\", en: \"‚úì Adapt Workout\" },\n  \"adapt.adapting\": { it: \"Adattamento...\", en: \"Adapting...\" },\n  \n  // Payment Modal\n  \"payment.title\": { it: \"Abbonamento\", en: \"Subscription\" },\n  \"payment.features\": { it: \"Cosa ottieni\", en: \"What you get\" },\n  \"payment.per_month\": { it: \"/mese\", en: \"/month\" },\n  \"payment.first_6_months\": { it: \"Primi 6 mesi\", en: \"First 6 months\" },\n  \"payment.then\": { it: \"poi\", en: \"then\" },\n  \"payment.credit_card\": { it: \"Carta di Credito/Debito\", en: \"Credit/Debit Card\" },\n  \"payment.stripe_secure\": { it: \"Pagamento sicuro con Stripe\", en: \"Secure payment with Stripe\" },\n  \"payment.paypal\": { it: \"PayPal\", en: \"PayPal\" },\n  \"payment.paypal_fast\": { it: \"Pagamento rapido e sicuro\", en: \"Fast and secure payment\" },\n  \"payment.proceed\": { it: \"Procedi al Pagamento\", en: \"Proceed to Payment\" },\n  \"payment.redirecting\": { it: \"Reindirizzamento...\", en: \"Redirecting...\" },\n  \"payment.security_note\": { \n    it: \"üîí Pagamenti sicuri ‚Ä¢ Nessun dato salvato sui nostri server\", \n    en: \"üîí Secure payments ‚Ä¢ No data saved on our servers\" \n  },\n  \n  // Pricing Plans\n  \"pricing.base\": { it: \"Base\", en: \"Base\" },\n  \"pricing.premium\": { it: \"Premium\", en: \"Premium\" },\n  \"pricing.elite\": { it: \"Elite\", en: \"Elite\" },\n  \"pricing.most_popular\": { it: \"Pi√π Popolare\", en: \"Most Popular\" },\n  \"pricing.current_plan\": { it: \"Piano Attuale\", en: \"Current Plan\" },\n  \"pricing.subscribe\": { it: \"Abbonati\", en: \"Subscribe\" },\n  \n  // Body Parts / Pain Areas\n  \"body.knee\": { it: \"Ginocchia\", en: \"Knees\" },\n  \"body.shoulder\": { it: \"Spalle\", en: \"Shoulders\" },\n  \"body.back\": { it: \"Schiena\", en: \"Back\" },\n  \"body.elbow\": { it: \"Gomiti\", en: \"Elbows\" },\n  \"body.wrist\": { it: \"Polsi\", en: \"Wrists\" },\n  \"body.ankles\": { it: \"Caviglie\", en: \"Ankles\" },\n};\n\ninterface LanguageContextType {\n  language: Language;\n  setLanguage: (lang: Language) => void;\n  t: (key: string) => string;\n}\n\nconst LanguageContext = createContext<LanguageContextType | undefined>(undefined);\n\nexport function LanguageProvider({ children }: { children: React.ReactNode }) {\n  const [language, setLanguageState] = useState<Language>(() => {\n    // Load from localStorage or default to Italian\n    const saved = localStorage.getItem(\"trainsmart_language\");\n    return (saved === \"en\" ? \"en\" : \"it\") as Language;\n  });\n\n  const setLanguage = (lang: Language) => {\n    setLanguageState(lang);\n    localStorage.setItem(\"trainsmart_language\", lang);\n    // TODO: Save to database via API when authenticated\n  };\n\n  const t = (key: string): string => {\n    const translation = translations[key];\n    if (!translation) {\n      console.warn(`Missing translation for key: ${key}`);\n      return key;\n    }\n    return translation[language] || translation.it || key;\n  };\n\n  return (\n    <LanguageContext.Provider value={{ language, setLanguage, t }}>\n      {children}\n    </LanguageContext.Provider>\n  );\n}\n\nexport function useTranslation() {\n  const context = useContext(LanguageContext);\n  if (!context) {\n    throw new Error(\"useTranslation must be used within LanguageProvider\");\n  }\n  return context;\n}\n","size_bytes":6380},"TRAINSMART_PUBLISHED.md":{"content":"# üèãÔ∏è TrainSmart - Intelligent Fitness Training App - PUBLISHED CODE\n\n## üìã Overview\nTrainSmart √® un'applicazione fitness completa che fornisce programmi di allenamento personalizzati basati su principi scientifici. Include autenticazione Replit Auth, gestione workout, tracking progressi e sistema di abbonamenti.\n\n## ‚ö†Ô∏è IMPORTANTE - OAuth Authentication\n**L'autenticazione OAuth ORA FUNZIONA SIA SU DEVELOPMENT CHE PUBLISHED! ‚úÖ**\n\n### üîß Soluzione Implementata:\nIl sistema usa **redirect_uri dinamico** basato sull'hostname della richiesta:\n\n**Development (worf.replit.dev):**\n```\nüîê OAuth redirect_uri: https://4461a510-0131-4259-92e1-488826cde5af-00-23x40pd9t1l4u.worf.replit.dev/api/callback\n```\n\n**Published (trainsmart.replit.app):**\n```\nüîê OAuth redirect_uri: https://trainsmart.replit.app/api/callback\n```\n\n### ‚úÖ Configurazione:\n- ‚úÖ Redirect URI dinamico (si adatta automaticamente a dev/published)\n- ‚úÖ Cookie secure + sameSite=\"none\" per OAuth cross-domain\n- ‚úÖ Error handling in App.tsx\n- ‚ö†Ô∏è SESSION_SECRET: usa fallback in development (OK), configurare per production\n\n### üöÄ Come Testare:\n1. **Published App:** `https://trainsmart.replit.app/`\n2. **Development:** `https://4461a510-0131-4259-92e1-488826cde5af-00-23x40pd9t1l4u.worf.replit.dev/`\n3. Clicca \"Inizia Gratis - Login/Registrati\"\n4. Vieni rediretto a Replit OAuth\n5. Dopo login, torni all'app autenticato\n\n### üêõ Debug:\nSe non funziona:\n- Apri DevTools (F12) ‚Üí Network tab\n- Cerca richiesta a `/api/login`\n- Controlla che venga mostrato il log: \"üîê OAuth redirect_uri dinamico: ...\"\n\n## üöÄ Come Avviare\n```bash\nnpm install\nnpm run dev\n```\nServer su: http://localhost:5000\n\n## üì¶ Tecnologie\n- **Frontend**: React 18, TypeScript, Vite, TanStack Query, Wouter\n- **Backend**: Express.js, TypeScript\n- **Database**: PostgreSQL con Drizzle ORM\n- **Auth**: Replit Auth (Google, GitHub, Email/Password)\n- **UI**: Tailwind CSS, shadcn/ui, Radix UI\n- **Icons**: Lucide React (Zap ‚ö° = logo TrainSmart)\n\n## üéØ Funzionalit√† Chiave\n- ‚úÖ Autenticazione multi-provider (Replit Auth)\n- ‚úÖ Screening iniziale personalizzato\n- ‚úÖ Generazione programmi basati su obiettivi/livello/attrezzatura\n- ‚úÖ Calcolo 1RM (Formula Brzycki)\n- ‚úÖ Workout tracking con pre-workout check\n- ‚úÖ Adattamento dinamico esercizi (gym/home/bodyweight)\n- ‚úÖ Sistema di progressione (Wave, Weekly/Daily Undulation)\n- ‚úÖ Targeting parti del corpo specifiche\n- ‚úÖ Sicurezza per gravidanza/disabilit√†\n- ‚úÖ Sistema abbonamenti a 3 livelli (Base ‚Ç¨19.90, Premium ‚Ç¨29.90, Elite ‚Ç¨39.90)\n- ‚úÖ Dashboard progressi con grafici\n\n## üóÇÔ∏è Struttura Progetto\n```\ntrainsmart/\n‚îú‚îÄ‚îÄ client/src/\n‚îÇ   ‚îú‚îÄ‚îÄ components/     # UI components\n‚îÇ   ‚îú‚îÄ‚îÄ pages/          # Route pages\n‚îÇ   ‚îú‚îÄ‚îÄ lib/            # Utilities\n‚îÇ   ‚îî‚îÄ‚îÄ hooks/          # Custom hooks\n‚îú‚îÄ‚îÄ server/\n‚îÇ   ‚îú‚îÄ‚îÄ index.ts        # Server entry\n‚îÇ   ‚îú‚îÄ‚îÄ routes.ts       # API routes\n‚îÇ   ‚îú‚îÄ‚îÄ replitAuth.ts   # Auth setup\n‚îÇ   ‚îú‚îÄ‚îÄ storage.ts      # Data layer\n‚îÇ   ‚îî‚îÄ‚îÄ programGenerator.ts  # Core logic\n‚îî‚îÄ‚îÄ shared/\n    ‚îî‚îÄ‚îÄ schema.ts       # DB schema (Drizzle)\n```\n\n## üîë Endpoints Chiave\n\n### Authentication\n- `GET /api/login` - Inizia OAuth flow\n- `GET /api/callback` - OAuth callback\n- `GET /api/logout` - Logout\n- `GET /api/auth/user` - Get current user\n\n### Screening & Programs\n- `POST /api/screening` - Save screening data\n- `GET /api/screening` - Get user screening\n- `POST /api/programs` - Generate new program\n- `GET /api/programs` - Get user programs\n- `GET /api/programs/:id` - Get specific program\n\n### Workouts\n- `POST /api/workouts` - Start workout\n- `POST /api/workouts/:id/complete` - Complete workout\n- `POST /api/workouts/:id/sets` - Save workout set\n- `POST /api/program/:programId/day/:dayName/adapt` - Adapt workout location\n\n### Progress\n- `GET /api/progress/weekly` - Weekly progress data\n- `GET /api/progress/personal-records` - Personal records\n\n## üé® Design System\n\n### Logo\n- **Icona**: Zap (fulmine) ‚ö° da Lucide React\n- **Colore**: Primary (blu-violetto)\n- **Font titoli**: Archivo Black\n- **Font corpo**: Inter\n\n### Tema Colori (index.css)\n- Background: Scuro (dark mode first)\n- Primary: Blu-violetto (#8B5CF6)\n- Accents: Verde smeraldo, Blu, Ambra\n\n## üîê Sistema Abbonamenti\n\n### Tiers\n1. **Base** (‚Ç¨19.90/mese)\n   - Programmi personalizzati\n   - Tracking progressi\n   - After 6 months: ‚Ç¨29.90\n\n2. **Premium** (‚Ç¨29.90/mese)\n   - Base features\n   - 1 AI form correction/week\n   - After 6 months: ‚Ç¨39.90\n\n3. **Elite** (‚Ç¨39.90/mese)\n   - Premium features\n   - Unlimited AI form corrections\n   - After 6 months: ‚Ç¨49.90\n\n### Note Implementazione\n- Calcolo prezzo dinamico basato su `subscriptionStartDate`\n- Usa `addMonths()` con day-clamping (es: 31 Ago ‚Üí 28 Feb)\n- File: `shared/pricingUtils.ts`\n\n## üìä Database Tables\n\n### users\n- id, username, email, profilePictureUrl\n- subscriptionTier, subscriptionStartDate, subscriptionId\n- aiCorrectionsUsed, lastAiCorrectionDate\n\n### screenings\n- userId, goal, level, location, equipment, frequency, painAreas\n- specificBodyParts (per toning/muscle_gain)\n\n### programs\n- userId, name, goal, level, location, split, exercises (JSON)\n\n### workouts\n- userId, programId, dayName, status\n- preWorkout data (sleep, energy, pain)\n\n### workoutSets\n- workoutId, exerciseName, setNumber, reps, weight, rpe\n\n### personalRecords\n- userId, exerciseName, weight, reps, oneRepMax, date\n\n## üèóÔ∏è Core Logic Files\n\n### server/programGenerator.ts\nLogica centrale per generazione programmi:\n- Calcolo 1RM (Formula Brzycki)\n- ADAPTFLOW‚Ñ¢ 2.0 (selezione esercizi intelligente)\n- Schemi progressione (Wave, Weekly/Daily Undulation)\n- Sicurezza gravidanza/disabilit√†\n- Body part targeting per toning/ipertrofia\n- Endurance & sport-specific training\n\n### server/storage.ts\nInterface IStorage con implementazioni:\n- MemStorage (in-memory)\n- DbStorage (PostgreSQL)\n\n### server/replitAuth.ts\nSetup Replit Auth:\n- OAuth configuration\n- Session management (PostgreSQL store)\n- Middleware isAuthenticated\n\n## üêõ Known Issues & Solutions\n\n### OAuth non funziona\n**SOLUZIONE**: Aprire app in tab esterno browser (non webview Replit)\n\n### LSP Errors (784 warnings)\n**STATUS**: Non sono errori funzionali, solo TypeScript warnings per @types/react mancanti. L'app funziona correttamente.\n\n### Port 5000\nFrontend DEVE essere su porta 5000 (configurazione Vite gi√† impostata)\n\n## üìù Environment Variables\n- `DATABASE_URL` - PostgreSQL connection (auto da Replit)\n- `SESSION_SECRET` - Auto-generato\n- `ISSUER_URL` - Default: https://replit.com/oidc (ha fallback)\n\n## üß™ Testing\nPer testare features:\n1. Aprire in tab esterno\n2. Login con Replit Auth\n3. Completare screening\n4. Generare programma\n5. Trackare workout\n\n## üö¢ Deployment\nApp pronta per pubblicazione su Replit:\n```bash\n# L'app √® gi√† configurata per deploy\n# Usa il pulsante \"Publish\" in Replit\n```\n\n## üìö File Reference\n\nDi seguito i file principali del progetto.\n\n---\n\n## FILE: shared/schema.ts\n```typescript\nimport { pgTable, serial, text, varchar, integer, boolean, timestamp, json, real, pgEnum } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Enums\nexport const goalEnum = pgEnum(\"goal\", [\n  \"weight_loss\",\n  \"muscle_gain\", \n  \"strength\",\n  \"endurance\",\n  \"toning\",\n  \"general\",\n  \"performance\",\n  \"disability\",\n  \"pregnancy\"\n]);\n\nexport const levelEnum = pgEnum(\"level\", [\"beginner\", \"intermediate\", \"advanced\"]);\nexport const locationEnum = pgEnum(\"location\", [\"gym\", \"home\", \"mixed\"]);\nexport const workoutStatusEnum = pgEnum(\"workout_status\", [\"pending\", \"in_progress\", \"completed\"]);\nexport const subscriptionTierEnum = pgEnum(\"subscription_tier\", [\"none\", \"base\", \"premium\", \"elite\"]);\n\n// Users table\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  username: varchar(\"username\", { length: 100 }).unique().notNull(),\n  email: varchar(\"email\", { length: 255 }).unique().notNull(),\n  profilePictureUrl: text(\"profile_picture_url\"),\n  subscriptionTier: subscriptionTierEnum(\"subscription_tier\").default(\"none\").notNull(),\n  subscriptionStartDate: timestamp(\"subscription_start_date\"),\n  subscriptionId: varchar(\"subscription_id\", { length: 255 }),\n  aiCorrectionsUsed: integer(\"ai_corrections_used\").default(0).notNull(),\n  lastAiCorrectionDate: timestamp(\"last_ai_correction_date\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Screenings table\nexport const screenings = pgTable(\"screenings\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  goal: goalEnum(\"goal\").notNull(),\n  objectiveType: varchar(\"objective_type\", { length: 100 }),\n  sportType: varchar(\"sport_type\", { length: 100 }),\n  specificBodyParts: text(\"specific_body_parts\").array(),\n  bodyWeight: real(\"body_weight\").notNull(),\n  level: levelEnum(\"level\").notNull(),\n  location: locationEnum(\"location\"),\n  hasGym: boolean(\"has_gym\").notNull(),\n  equipment: json(\"equipment\"),\n  frequency: integer(\"frequency\").notNull(),\n  painAreas: text(\"pain_areas\").array().default([]),\n  preferredSplit: varchar(\"preferred_split\", { length: 100 }),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Quiz Results table\nexport const quizResults = pgTable(\"quiz_results\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  score: integer(\"score\").notNull(),\n  totalQuestions: integer(\"total_questions\").notNull(),\n  answers: json(\"answers\").notNull(),\n  difficulty: varchar(\"difficulty\", { length: 50 }).notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Assessments table\nexport const assessments = pgTable(\"assessments\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  exerciseName: varchar(\"exercise_name\", { length: 255 }).notNull(),\n  weight: real(\"weight\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Programs table\nexport const programs = pgTable(\"programs\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  name: varchar(\"name\", { length: 255 }).notNull(),\n  goal: goalEnum(\"goal\").notNull(),\n  level: levelEnum(\"level\").notNull(),\n  location: locationEnum(\"location\").notNull(),\n  split: varchar(\"split\", { length: 100 }).notNull(),\n  exercises: json(\"exercises\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Workouts table\nexport const workouts = pgTable(\"workouts\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  programId: integer(\"program_id\").references(() => programs.id, { onDelete: \"cascade\" }).notNull(),\n  dayName: varchar(\"day_name\", { length: 100 }).notNull(),\n  status: workoutStatusEnum(\"status\").default(\"pending\").notNull(),\n  sleepHours: real(\"sleep_hours\"),\n  energyLevel: integer(\"energy_level\"),\n  painLevel: integer(\"pain_level\"),\n  painLocation: text(\"pain_location\"),\n  preWorkoutNotes: text(\"pre_workout_notes\"),\n  completedAt: timestamp(\"completed_at\"),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Workout Sets table\nexport const workoutSets = pgTable(\"workout_sets\", {\n  id: serial(\"id\").primaryKey(),\n  workoutId: integer(\"workout_id\").references(() => workouts.id, { onDelete: \"cascade\" }).notNull(),\n  exerciseName: varchar(\"exercise_name\", { length: 255 }).notNull(),\n  setNumber: integer(\"set_number\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  weight: real(\"weight\").notNull(),\n  rpe: integer(\"rpe\"),\n  isWarmup: boolean(\"is_warmup\").default(false),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Personal Records table\nexport const personalRecords = pgTable(\"personal_records\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  exerciseName: varchar(\"exercise_name\", { length: 255 }).notNull(),\n  weight: real(\"weight\").notNull(),\n  reps: integer(\"reps\").notNull(),\n  oneRepMax: real(\"one_rep_max\").notNull(),\n  date: timestamp(\"date\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Weekly Progress table\nexport const weeklyProgress = pgTable(\"weekly_progress\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  weekStart: timestamp(\"week_start\").notNull(),\n  totalVolume: real(\"total_volume\").notNull(),\n  totalSets: integer(\"total_sets\").notNull(),\n  averageRpe: real(\"average_rpe\"),\n  workoutsCompleted: integer(\"workouts_completed\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Payments table\nexport const payments = pgTable(\"payments\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  amount: real(\"amount\").notNull(),\n  provider: varchar(\"provider\", { length: 50 }).notNull(),\n  status: varchar(\"status\", { length: 50 }).default(\"pending\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Workout Adaptations table\nexport const workoutAdaptations = pgTable(\"workout_adaptations\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id, { onDelete: \"cascade\" }).notNull(),\n  programId: integer(\"program_id\").references(() => programs.id, { onDelete: \"cascade\" }).notNull(),\n  dayName: varchar(\"day_name\", { length: 100 }).notNull(),\n  adaptedLocation: locationEnum(\"adapted_location\").notNull(),\n  adaptedExercises: json(\"adapted_exercises\").notNull(),\n  equipment: json(\"equipment\"),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\n// Insert schemas\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertScreeningSchema = createInsertSchema(screenings).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertQuizResultSchema = createInsertSchema(quizResults).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertAssessmentSchema = createInsertSchema(assessments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertProgramSchema = createInsertSchema(programs).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWorkoutSchema = createInsertSchema(workouts).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWorkoutSetSchema = createInsertSchema(workoutSets).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPersonalRecordSchema = createInsertSchema(personalRecords).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWeeklyProgressSchema = createInsertSchema(weeklyProgress).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertPaymentSchema = createInsertSchema(payments).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertWorkoutAdaptationSchema = createInsertSchema(workoutAdaptations).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Types\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\n\nexport type Screening = typeof screenings.$inferSelect;\nexport type InsertScreening = z.infer<typeof insertScreeningSchema>;\n\nexport type QuizResult = typeof quizResults.$inferSelect;\nexport type InsertQuizResult = z.infer<typeof insertQuizResultSchema>;\n\nexport type Assessment = typeof assessments.$inferSelect;\nexport type InsertAssessment = z.infer<typeof insertAssessmentSchema>;\n\nexport type Program = typeof programs.$inferSelect;\nexport type InsertProgram = z.infer<typeof insertProgramSchema>;\n\nexport type Workout = typeof workouts.$inferSelect;\nexport type InsertWorkout = z.infer<typeof insertWorkoutSchema>;\n\nexport type WorkoutSet = typeof workoutSets.$inferSelect;\nexport type InsertWorkoutSet = z.infer<typeof insertWorkoutSetSchema>;\n\nexport type PersonalRecord = typeof personalRecords.$inferSelect;\nexport type InsertPersonalRecord = z.infer<typeof insertPersonalRecordSchema>;\n\nexport type WeeklyProgress = typeof weeklyProgress.$inferSelect;\nexport type InsertWeeklyProgress = z.infer<typeof insertWeeklyProgressSchema>;\n\nexport type Payment = typeof payments.$inferSelect;\nexport type InsertPayment = z.infer<typeof insertPaymentSchema>;\n\nexport type WorkoutAdaptation = typeof workoutAdaptations.$inferSelect;\nexport type InsertWorkoutAdaptation = z.infer<typeof insertWorkoutAdaptationSchema>;\n```\n\n---\n\n## FILE: server/replitAuth.ts\n```typescript\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express } from \"express\";\nimport { Issuer, Strategy, type UserinfoResponse } from \"openid-client\";\nimport connectPgSimple from \"connect-pg-simple\";\nimport pg from \"pg\";\n\nconst PgSession = connectPgSimple(session);\n\ninterface ReplitUserinfo extends UserinfoResponse {\n  sub: string;\n  name: string;\n  profile?: string;\n  picture?: string;\n  email: string;\n  email_verified: boolean;\n  aud: string;\n  exp: number;\n  iat: number;\n  iss: string;\n}\n\nexport async function setupAuth(app: Express) {\n  const pool = new pg.Pool({\n    connectionString: process.env.DATABASE_URL,\n  });\n\n  const issuerUrl = process.env.ISSUER_URL || \"https://replit.com/oidc\";\n\n  const replitIssuer = await Issuer.discover(issuerUrl);\n\n  const client = new replitIssuer.Client({\n    client_id: process.env.REPLIT_DEPLOYMENT\n      ? `${process.env.REPL_ID}-${process.env.REPL_OWNER}`\n      : process.env.REPL_ID ?? \"unknown\",\n    token_endpoint_auth_method: \"none\",\n  });\n\n  const strategy = new Strategy(\n    {\n      client,\n      params: {\n        redirect_uri:\n          process.env.NODE_ENV === \"production\"\n            ? `https://${process.env.REPL_SLUG}.${process.env.REPL_OWNER}.repl.co/api/callback`\n            : `http://localhost:5000/api/callback`,\n      },\n    },\n    (tokenSet: any, userinfo: ReplitUserinfo, done: any) => {\n      return done(null, { tokenSet, userinfo });\n    }\n  );\n\n  passport.use(\"oidc\", strategy);\n\n  passport.serializeUser((user: any, done) => {\n    done(null, user);\n  });\n\n  passport.deserializeUser((user: any, done) => {\n    done(null, user);\n  });\n\n  app.use(\n    session({\n      store: new PgSession({\n        pool,\n        tableName: \"user_sessions\",\n        createTableIfMissing: true,\n      }),\n      secret: process.env.SESSION_SECRET || \"trainsmart-secret-key-2024\",\n      resave: false,\n      saveUninitialized: false,\n      cookie: {\n        maxAge: 30 * 24 * 60 * 60 * 1000,\n        httpOnly: true,\n        secure: process.env.NODE_ENV === \"production\",\n        sameSite: process.env.NODE_ENV === \"production\" ? \"none\" : \"lax\",\n      },\n    })\n  );\n\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  app.get(\"/api/login\", (req, res, next) => {\n    passport.authenticate(\"oidc\")(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    passport.authenticate(\"oidc\", {\n      successRedirect: \"/\",\n      failureRedirect: \"/\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\"/\");\n    });\n  });\n\n  app.get(\"/api/auth/user\", (req, res) => {\n    if (req.isAuthenticated()) {\n      res.json(req.user);\n    } else {\n      res.status(401).json({ message: \"Unauthorized\" });\n    }\n  });\n}\n\nexport function isAuthenticated(req: any, res: any, next: any) {\n  if (req.isAuthenticated()) {\n    return next();\n  }\n  res.status(401).json({ message: \"Unauthorized\" });\n}\n```\n\n---\n\n## FILE: client/src/components/Hero.tsx\n```typescript\nimport { Button } from \"@/components/ui/button\";\nimport { Zap } from \"lucide-react\";\n\nexport default function Hero() {\n  return (\n    <div className=\"min-h-screen bg-background flex items-center\">\n      <div className=\"max-w-7xl mx-auto px-4 py-16 w-full\">\n        <div className=\"grid md:grid-cols-2 gap-12 items-center\">\n          <div className=\"space-y-8\">\n            <div className=\"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-primary/10 border border-primary/20\">\n              <Zap className=\"w-4 h-4 text-primary\" />\n              <span className=\"text-sm font-medium text-primary\">Allenamento Basato sulla Scienza</span>\n            </div>\n            \n            <h1 className=\"font-display text-5xl md:text-6xl lg:text-7xl leading-tight text-foreground\">\n              Allenati con <span className=\"text-primary\">Intelligenza</span>\n            </h1>\n            \n            <p className=\"text-lg text-muted-foreground max-w-lg\">\n              Programmi personalizzati basati sui tuoi dati, progressione scientifica e tracciamento dettagliato per raggiungere i tuoi obiettivi fitness.\n            </p>\n            \n            <div className=\"flex flex-wrap gap-4\">\n              <Button \n                size=\"lg\" \n                className=\"text-base\"\n                onClick={() => window.location.href = \"/api/login\"}\n                data-testid=\"button-start-free\"\n              >\n                Inizia Gratis - Login/Registrati\n              </Button>\n              <Button \n                size=\"lg\" \n                variant=\"outline\" \n                className=\"text-base\"\n                onClick={() => document.getElementById('features')?.scrollIntoView({ behavior: 'smooth' })}\n                data-testid=\"button-learn-more\"\n              >\n                Scopri di pi√π\n              </Button>\n            </div>            \n            <div className=\"flex items-center gap-8 pt-4\">\n              <div>\n                <div className=\"text-3xl font-bold text-primary\">500+</div>\n                <div className=\"text-sm text-muted-foreground\">Atleti attivi</div>\n              </div>\n              <div className=\"h-12 w-px bg-border\" />\n              <div>\n                <div className=\"text-3xl font-bold text-primary\">10K+</div>\n                <div className=\"text-sm text-muted-foreground\">Workout completati</div>\n              </div>\n            </div>\n          </div>\n          \n          <div className=\"relative hidden md:block\">\n            <div className=\"absolute inset-0 bg-gradient-to-br from-primary/20 to-chart-2/20 rounded-3xl blur-3xl\" />\n            <div className=\"relative bg-gradient-to-br from-card to-card/50 backdrop-blur-sm rounded-3xl p-12 border border-card-border\">\n              <div className=\"space-y-6\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center\">\n                    <Zap className=\"w-8 h-8 text-primary\" />\n                  </div>\n                  <div>\n                    <div className=\"text-2xl font-bold\">TrainSmart</div>\n                    <div className=\"text-sm text-muted-foreground\">Il tuo coach personale</div>\n                  </div>\n                </div>\n                \n                <div className=\"space-y-3\">\n                  <div className=\"flex items-center justify-between p-4 bg-background/50 rounded-lg border border-border\">\n                    <span className=\"text-sm\">Progressione Forza</span>\n                    <span className=\"text-lg font-bold text-chart-3\">+12%</span>\n                  </div>\n                  <div className=\"flex items-center justify-between p-4 bg-background/50 rounded-lg border border-border\">\n                    <span className=\"text-sm\">Volume Settimanale</span>\n                    <span className=\"text-lg font-bold text-chart-1\">8.5T</span>\n                  </div>\n                  <div className=\"flex items-center justify-between p-4 bg-background/50 rounded-lg border border-border\">\n                    <span className=\"text-sm\">Serie Completate</span>\n                    <span className=\"text-lg font-bold text-chart-4\">156</span>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n```\n\n---\n\n## FILE: client/src/App.tsx\n```typescript\nimport { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useQuery } from \"@tanstack/react-query\";\n\nimport Landing from \"@/pages/Landing\";\nimport Home from \"@/pages/Home\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  const { data: user, isLoading } = useQuery({\n    queryKey: [\"/api/auth/user\"],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">Caricamento...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <Switch>\n      <Route path=\"/\" component={user ? Home : Landing} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Router />\n        <Toaster />\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n```\n\n---\n\n## üéØ SOLUZIONE AL PROBLEMA LOGIN\n\nIl pulsante \"Inizia Gratis - Login/Registrati\" chiama correttamente `/api/login`.\n\n**IL PROBLEMA √à CHE STAI USANDO IL WEBVIEW DI REPLIT** che blocca i redirect OAuth.\n\n### ‚úÖ SOLUZIONE:\n1. Clicca sull'icona \"Apri in una nuova tab\" nel webview Replit\n2. Oppure copia l'URL e aprilo in un tab normale del browser\n3. SOLO COS√å l'autenticazione funzioner√†\n\n### Verifica che funzioni:\n1. Apri l'app in tab esterno\n2. Clicca su \"Inizia Gratis - Login/Registrati\"\n3. Verrai rediretto a Replit OAuth\n4. Scegli Google/GitHub/Email\n5. Dopo login, torni all'app autenticato\n6. Appare la pagina Home con screening\n\n---\n\n## üìÇ Altri File Importanti\n\n### shared/pricingUtils.ts\n```typescript\nimport { addMonths } from \"date-fns\";\n\nexport type SubscriptionTier = \"none\" | \"base\" | \"premium\" | \"elite\";\n\nexport const BASE_PRICES = {\n  base: 19.90,\n  premium: 29.90,\n  elite: 39.90,\n} as const;\n\nexport const PRICE_INCREASE = 10;\n\nexport function getCurrentPrice(tier: SubscriptionTier, startDate: Date | null): number {\n  if (tier === \"none\" || !startDate) return 0;\n  \n  const basePrice = BASE_PRICES[tier as keyof typeof BASE_PRICES];\n  const now = new Date();\n  const sixMonthsLater = addMonths(startDate, 6);\n  \n  return now >= sixMonthsLater ? basePrice + PRICE_INCREASE : basePrice;\n}\n\nexport function canUseAiCorrection(\n  tier: SubscriptionTier,\n  correctionsUsed: number,\n  lastCorrectionDate: Date | null\n): boolean {\n  if (tier === \"elite\") return true;\n  if (tier !== \"premium\") return false;\n  \n  const now = new Date();\n  const oneWeekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n  \n  if (!lastCorrectionDate || lastCorrectionDate < oneWeekAgo) {\n    return true;\n  }\n  \n  return false;\n}\n```\n\n---\n\n## üîç Debug Checklist\n\nSe l'app non funziona:\n\n- [ ] App aperta in **tab esterno** (non webview)\n- [ ] Server running su porta 5000\n- [ ] Database PostgreSQL connesso\n- [ ] Variabile `DATABASE_URL` impostata\n- [ ] Dopo login, controlla console browser per errori\n- [ ] Controlla log server per errori 500\n\n---\n\n## üìû Support\n\nPer problemi:\n1. Verifica che usi tab esterno browser\n2. Controlla log server con `npm run dev`\n3. Controlla browser console (F12)\n4. Verifica che DATABASE_URL esista\n\n---\n\n**L'APP √à PRONTA E FUNZIONANTE!** üöÄ\n\nBasta aprirla in un tab esterno del browser per far funzionare l'autenticazione OAuth.\n","size_bytes":27925},"trainsmart-v2.0.md":{"content":"# TrainSmart v2.0 - Documentazione Completa\n\n## Panoramica del Progetto\n\n**TrainSmart** √® un'applicazione fitness intelligente che fornisce programmi di allenamento personalizzati basati su principi scientifici. L'app offre piani personalizzati per vari obiettivi (perdita peso, ipertrofia, forza, endurance, toning, performance sportiva, disabilit√† motoria, gravidanza), livelli di esperienza, attrezzatura disponibile e condizioni specifiche.\n\n### Caratteristiche Principali\n\n- **Personalizzazione Intelligente**: Programmi generati dinamicamente in base a screening, assessment 1RM e feedback real-time\n- **ADAPTFLOW‚Ñ¢ 2.0**: Sistema di selezione esercizi adattivo con varianti gym/home/bodyweight e fallback intelligenti\n- **Sistema di Sicurezza**: Filtri automatici per gravidanza, disabilit√† e aree di dolore con sostituzioni sicure\n- **Progressione Scientifica**: Wave loading, ondulazione settimanale/giornaliera basata su livello utente\n- **Calcolo 1RM**: Formula di Brzycki per assessment muscolare accurato\n- **Tracking Avanzato**: RPE, volume, statistiche settimanali, record personali, ADAPTFLOW‚Ñ¢ per compensare carichi insufficienti\n- **Sistema di Abbonamento**: 3 tier (Base ‚Ç¨19.90, Premium ‚Ç¨29.90, Elite ‚Ç¨39.90) con aumento automatico dopo 6 mesi\n\n---\n\n## Stack Tecnologico\n\n### Frontend\n- **React 18** + **TypeScript** + **Vite**\n- **Wouter** per routing\n- **TanStack Query v5** per gestione stato server\n- **Tailwind CSS** + **shadcn/ui** per UI/UX\n- **Dark mode** supportato\n- **Recharts** per grafici statistiche\n\n### Backend\n- **Express.js** + **TypeScript**\n- **Replit Auth** (Google, GitHub, Email/Password)\n- **PostgreSQL** (Neon) + **Drizzle ORM**\n- **express-session** con PostgreSQL store\n- **Zod** per validazione dati\n- **Rate limiting** e CORS configurati\n\n### Database (PostgreSQL)\n- **Drizzle ORM** per type-safety\n- Schema completo con relazioni cascade\n- Migrations gestite con `npm run db:push`\n\n---\n\n## Architettura Database\n\n### Tabelle Principali\n\n#### `users`\n```typescript\n- id (varchar, UUID)\n- email (varchar, unique)\n- subscriptionTier (varchar): \"base\" | \"premium\" | \"elite\"\n- subscriptionStatus (varchar): \"active\" | \"inactive\" | \"cancelled\"\n- subscriptionStartDate (timestamp)\n- subscriptionId (varchar) // Stripe subscription ID\n- aiCorrectionsUsed (integer, default 0)\n- lastAiCorrectionDate (timestamp)\n- createdAt, updatedAt\n```\n\n#### `screenings` (Onboarding utente)\n```typescript\n- id (varchar, UUID)\n- userId (FK ‚Üí users.id)\n- goal (varchar): \"weight_loss\" | \"muscle_gain\" | \"strength\" | \"endurance\" | \"toning\" | \"general\" | \"performance\" | \"disability\" | \"pregnancy\"\n- objectiveType (varchar): \"fitness\" | \"rehab\" | \"performance\"\n- sportType, sportRole (varchar): per performance\n- specificBodyParts (jsonb): array per toning/muscle_gain\n- disabilityType (varchar): tipo disabilit√† motoria\n- pregnancyWeek (integer 1-40): settimana gestazione\n- pregnancyTrimester (integer 1-3): trimestre calcolato\n- hasDoctorClearance (boolean): autorizzazione medica\n- pregnancyComplications (jsonb): array complicazioni\n- bodyWeight (decimal)\n- level (varchar): \"beginner\" | \"intermediate\" | \"advanced\"\n- location (varchar): \"gym\" | \"home\" | \"mixed\"\n- hasGym (boolean)\n- equipment (jsonb): { barbell, dumbbellMaxKg, kettlebellKg[], bands, pullupBar, bench }\n- frequency (integer): giorni/settimana (2-6)\n- painAreas (jsonb): array aree dolore\n- preferredSplit (varchar): \"full_body\" | \"upper_lower\" | \"ppl\"\n- createdAt\n```\n\n#### `programs` (Programmi generati)\n```typescript\n- id (varchar, UUID)\n- userId (FK ‚Üí users.id)\n- name, description (varchar/text)\n- split (varchar): \"full_body\" | \"upper_lower\" | \"ppl\"\n- daysPerWeek (integer)\n- weeklySchedule (jsonb): array giorni allenamento\n- progression (varchar): \"wave_loading\" | \"ondulata_settimanale\" | \"ondulata_giornaliera\"\n- includesDeload (boolean): se include deload\n- deloadFrequency (integer): ogni quante settimane (es. 4)\n- totalWeeks (integer): durata programma\n- requiresEndCycleTest (boolean): se richiede test finale\n- isActive (boolean)\n- createdAt, updatedAt\n```\n\n#### `assessments` (Test 1RM)\n```typescript\n- id (varchar, UUID)\n- userId (FK ‚Üí users.id)\n- exerciseName (varchar)\n- weight (varchar): peso decimale\n- reps (integer)\n- oneRepMax (varchar): calcolato con Brzycki\n- notes (text)\n- createdAt\n```\n\n#### `workouts` (Sessioni allenamento)\n```typescript\n- id (varchar, UUID)\n- userId (FK ‚Üí users.id)\n- programId (FK ‚Üí programs.id)\n- dayName (varchar)\n- status (varchar): \"in_progress\" | \"completed\" | \"skipped\"\n- startedAt, completedAt (timestamp)\n- duration (integer): minuti\n- totalVolume (decimal): kg totali\n- sleepHours (varchar)\n- energyLevel (integer 1-10)\n- painLevel (integer 0-10)\n- painLocation (varchar)\n- preWorkoutNotes, postWorkoutNotes (text)\n```\n\n#### `workoutSets` (Serie eseguite)\n```typescript\n- id (varchar, UUID)\n- workoutId (FK ‚Üí workouts.id)\n- exerciseName (varchar)\n- setNumber (integer)\n- reps (integer)\n- weight (varchar)\n- rpe (integer 1-10): Rate of Perceived Exertion\n- isWarmup (boolean)\n- notes (text)\n- createdAt\n```\n\n#### `workoutAdaptations` (Adattamenti temporanei)\n```typescript\n- id (varchar, UUID)\n- userId (FK ‚Üí users.id)\n- programId (FK ‚Üí programs.id)\n- dayName (varchar)\n- adaptedLocation (varchar): \"home\" | \"homeBodyweight\"\n- adaptedEquipment (jsonb)\n- adaptedExercises (jsonb): esercizi sostituiti\n- expiresAt (timestamp): 24h dalla creazione\n- usedAt (timestamp)\n- createdAt\n```\n\n---\n\n## Logica di Generazione Programmi\n\n### File Chiave: `server/programGenerator.ts`\n\n#### 1. **Calcolo 1RM (Formula Brzycki)**\n```typescript\nexport function calculateOneRepMax(weight: number, reps: number): number {\n  if (reps === 1) return weight;\n  return weight * (36 / (37 - reps)); // Brzycki formula\n}\n```\n\n#### 2. **Determinazione Split**\n```typescript\nif (frequency <= 3) ‚Üí \"full_body\"\nif (frequency === 4) ‚Üí \"upper_lower\"\nif (frequency >= 5) ‚Üí \"ppl\" (Push/Pull/Legs)\n```\n\n#### 3. **Progressione per Livello**\n```typescript\n\"beginner\" ‚Üí \"wave_loading\" (2-3-4 serie)\n\"intermediate\" ‚Üí \"ondulata_settimanale\"\n\"advanced\" ‚Üí \"ondulata_giornaliera\"\n```\n\n#### 4. **Deload e Durata Programmi**\n```typescript\n// Deload ogni 4 settimane per intermediate/advanced\nincludesDeload = level === \"intermediate\" || level === \"advanced\"\ndeloadFrequency = 4\n\n// Durata per goal\ntotalWeeks:\n  - strength: 8 settimane (con test finale)\n  - muscle_gain: 12 settimane (con test finale)\n  - performance: 8 settimane (con test finale)\n  - pregnancy: 4 settimane (cicli brevi per monitoraggio)\n  - disability: 6 settimane\n  - altri: 4 settimane\n\nrequiresEndCycleTest = goal in [\"strength\", \"muscle_gain\", \"performance\"]\n```\n\n#### 5. **Sistema ADAPTFLOW‚Ñ¢ 2.0**\n\n**Selezione Esercizi con Fallback**:\n```typescript\n// Priorit√†: gym ‚Üí home con attrezzi ‚Üí bodyweight\nfunction createExercise(name, location, hasGym, equipment, baseLoad, level, goal, type) {\n  1. Controlla safety (pregnancy/disability/pain)\n  2. Se gym: esercizio standard\n  3. Se home: cerca variante home con attrezzi disponibili\n  4. Se mancano attrezzi: variante bodyweight\n  5. Calcola sets/reps per livello\n  6. Applica load con ADAPTFLOW‚Ñ¢ se insufficiente\n}\n```\n\n**ADAPTFLOW‚Ñ¢ Compensation**:\n```typescript\n// Se peso disponibile < peso richiesto\nif (availableWeight < targetWeight) {\n  compensation = {\n    type: \"tempo\" | \"pause\" | \"dropset\" | \"cluster\"\n    value: calculatedIntensity\n  }\n}\n```\n\n#### 6. **Esercizi Sicuri per Gravidanza (Per Trimestre)**\n\n```typescript\nconst PREGNANCY_SAFE_EXERCISES_BY_TRIMESTER = {\n  1: { // Trimestre 1 (settimane 1-13)\n    safe: [\"Goblet Squat\", \"Incline Press\", \"Row\", \"Hip Thrust\", \"Lat Pulldown\"],\n    loadMultiplier: 0.55, // 50-60% 1RM\n    avoid: [\"Salti\", \"Esercizi ad alto impatto\"]\n  },\n  2: { // Trimestre 2 (settimane 14-27)\n    safe: [\"Squat\", \"Standing Press\", \"Row\", \"Hip Thrust\", \"Leg Press\"],\n    loadMultiplier: 0.45, // 40-50% 1RM\n    avoid: [\"Esercizi supini\", \"Core compression\", \"Torsioni\"]\n  },\n  3: { // Trimestre 3 (settimane 28-40)\n    safe: [\"Box Squat\", \"Standing Cable Press\", \"Supported Row\", \"Pelvic Floor\", \"Mobilit√†\"],\n    loadMultiplier: 0.35, // 30-40% 1RM\n    avoid: [\"Esercizi supini\", \"Carichi pesanti\", \"Posizioni prone\"]\n  }\n}\n\nfunction isExerciseSafeForPregnancy(exerciseName, trimester) {\n  // Controlla supine (vietato da T2)\n  if (trimester >= 2 && isSupinePosition(exerciseName)) return false;\n  // Verifica se esercizio in lista safe per trimestre\n  return PREGNANCY_SAFE_EXERCISES_BY_TRIMESTER[trimester].safe.includes(exerciseName);\n}\n```\n\n#### 7. **Esercizi Sicuri per Disabilit√†**\n\n```typescript\nconst DISABILITY_SAFE_EXERCISES = {\n  \"paraplegia\": [\"Bench Press\", \"Row Seduto\", \"Shoulder Press Seduto\", \"Cable Exercises\"],\n  \"emiplegia\": [\"Single-Arm\", \"Esercizi assistiti\", \"Cable unilaterali\"],\n  \"amputazione_arto_inferiore\": [\"Upper body\", \"Core\", \"Leg Press unilaterale\"],\n  // ... altri\n}\n\nfunction isExerciseSafeForDisability(exerciseName, disabilityType) {\n  return DISABILITY_SAFE_EXERCISES[disabilityType]?.includes(exerciseName);\n}\n```\n\n---\n\n## API Endpoints Principali\n\n### Autenticazione\n- `GET /api/auth/login` - Redirect a Replit Auth\n- `GET /api/auth/callback` - Callback OAuth\n- `GET /api/auth/user` - Ottieni user corrente\n- `POST /api/auth/logout` - Logout\n\n### Screening & Onboarding\n- `POST /api/screening` - Salva screening (validazione Zod con campi pregnancy)\n- `GET /api/screening/latest` - Ultimo screening utente\n- `POST /api/quiz` - Salva quiz biomeccanico\n- `POST /api/assessment` - Salva assessment 1RM\n- `GET /api/assessments/latest` - Ultimi assessments\n\n### Programmi\n- `POST /api/program/generate` - Genera programma da screening/assessments\n- `GET /api/program/active` - Programma attivo\n- `GET /api/programs` - Tutti i programmi utente\n- `POST /api/program/:programId/day/:dayName/adapt` - Adatta workout per location\n- `POST /api/program/recalibrate` - Ricalibra dopo pausa (detraining factor)\n\n### Workout\n- `POST /api/workout/start` - Inizia workout\n- `GET /api/workout/active` - Workout in corso\n- `POST /api/workout/:id/set` - Salva serie\n- `POST /api/workout/:id/complete` - Completa workout\n- `POST /api/workout/:id/skip` - Salta workout\n\n### Stats & Progress\n- `GET /api/stats/weekly?weeks=12` - Progresso settimanale\n- `GET /api/stats/records` - Record personali\n\n### Payments\n- `POST /api/payment/create` - Crea payment intent (Stripe/PayPal)\n- `POST /api/payment/confirm` - Conferma pagamento\n- `GET /api/subscription/status` - Stato abbonamento\n\n---\n\n## Flusso Utente Completo\n\n### 1. Landing & Pricing\n- Utente vede landing page con features\n- 3 card prezzi: Base, Premium (con badge), Elite\n- Click \"Inizia Ora\" ‚Üí Login con Replit Auth\n\n### 2. Onboarding (ScreeningFlow)\n\n**Step 1: Goal**\n- Selezione obiettivo: weight_loss, muscle_gain, strength, endurance, toning, performance, disability, pregnancy\n\n**Step 2: Obiettivi Specifici** (se toning/muscle_gain)\n- Multi-select parti corpo: upper_chest, arms, shoulders, back_width, back_thickness, legs, glutes, abs, calves\n\n**Step 3: Info Sport** (se performance)\n- Tipo sport, ruolo specifico\n\n**Step 4: Info Disabilit√†** (se disability)\n- Tipo disabilit√† motoria\n\n**Step 5: Info Gravidanza** (se pregnancy)\n- Slider settimana gestazione (1-40) ‚Üí auto-calcola trimestre\n- Checkbox autorizzazione medica (required)\n- Multi-select complicazioni (optional)\n\n**Step 6: Dati Fisici**\n- Peso corporeo, livello esperienza\n\n**Step 7: Location & Equipment**\n- Palestra/casa, attrezzatura disponibile\n\n**Step 8: Frequenza**\n- Giorni/settimana (2-6)\n\n**Step 9: Pain Areas**\n- Aree dolore/infortuni (optional)\n\n### 3. Quiz Biomeccanico\n- Domande su biomeccanica/tecnica\n- Difficolt√† basata su livello screening\n\n### 4. Assessment (10RM Test)\n- 4 esercizi base: Squat, Panca, Stacco, Trazioni\n- Input peso e reps eseguite\n- Calcolo 1RM con Brzycki\n\n### 5. Generazione Programma\n- Backend chiama `generateProgram()` con tutti i parametri\n- Determina split, progressione, deload, durata\n- Filtra esercizi per safety (pregnancy/disability/pain)\n- Aggiunge esercizi specifici per body parts\n- Salva programma con metadata completo\n\n### 6. Dashboard & Workout\n- Visualizza programma settimanale\n- Click giorno ‚Üí Pre-workout check (sonno, energia, dolore)\n- Esegui workout con tracking serie/RPE\n- ADAPTFLOW‚Ñ¢ se carico insufficiente\n- \"Adatta\" button per cambiare location al volo\n- Post-workout notes e completamento\n\n### 7. Statistiche & Progress\n- Grafici volume settimanale (Recharts)\n- Record personali per esercizio\n- Trend progressione\n\n---\n\n## Caratteristiche Avanzate\n\n### Sistema Prezzi Dinamici\n```typescript\n// shared/pricingUtils.ts\nexport function getPriceForDate(tier: string, startDate: Date): number {\n  const monthsActive = calculateMonthsActive(startDate);\n  const basePrice = BASE_PRICES[tier];\n  return monthsActive >= 6 ? basePrice + 10 : basePrice;\n}\n```\n\n### Detraining & Recalibrazione\n```typescript\nexport function calculateDetrainingFactor(workouts: any[]) {\n  const daysSinceLastWorkout = calculateDays(lastWorkout);\n  if (daysSinceLastWorkout < 7) return 1.0;\n  if (daysSinceLastWorkout < 14) return 0.95; // -5%\n  if (daysSinceLastWorkout < 21) return 0.9;  // -10%\n  if (daysSinceLastWorkout < 30) return 0.85; // -15%\n  return 0.7; // -30%\n}\n```\n\n### Adaptation System\n```typescript\n// POST /api/program/:programId/day/:dayName/adapt\n{\n  adaptedLocation: \"home\" | \"homeBodyweight\",\n  adaptedEquipment: { ... }\n}\n// Rigenera esercizi per location/equipment specificati\n// Salva in workoutAdaptations con expiry 24h\n```\n\n---\n\n## Validazione Dati (Zod Schemas)\n\n### screeningSchema (server/routes.ts)\n```typescript\nconst screeningSchema = z.object({\n  goal: z.enum([\"weight_loss\", \"muscle_gain\", ...]),\n  pregnancyWeek: z.number().int().min(1).max(40).optional(),\n  pregnancyTrimester: z.number().int().min(1).max(3).optional(),\n  hasDoctorClearance: z.boolean().optional(),\n  pregnancyComplications: z.array(z.string()).optional(),\n  bodyWeight: z.number().positive().max(300),\n  level: z.enum([\"beginner\", \"intermediate\", \"advanced\"]),\n  frequency: z.number().int().min(2).max(6),\n  // ... altri campi\n});\n```\n\n### assessmentSchema\n```typescript\nconst assessmentSchema = z.object({\n  exerciseName: z.string().min(1),\n  weight: z.string().or(z.number()).transform(parseFloat),\n  reps: z.number().int().positive().max(50),\n  notes: z.string().optional(),\n});\n```\n\n---\n\n## Componenti Frontend Chiave\n\n### `client/src/components/ScreeningFlow.tsx`\n- Multi-step form con validazione\n- Rendering condizionale per goal-specific steps\n- Calcolo automatico trimestre da settimana gravidanza\n- Integrazione con shadcn/ui Form\n\n### `client/src/components/WorkoutTracker.tsx`\n- Tracking real-time serie/reps/RPE\n- Pre-workout check (sonno, energia, dolore)\n- Post-workout notes\n- Bottone \"Adatta\" per workout adaptation\n- ADAPTFLOW‚Ñ¢ visualization\n\n### `client/src/components/Dashboard.tsx`\n- Overview programma attivo\n- Calendario settimanale\n- Quick stats\n- CTA per workout\n\n### `client/src/pages/Pricing.tsx`\n- 3-tier cards con prezzi dinamici\n- Feature comparison\n- FAQ section\n- Stripe/PayPal integration ready\n\n---\n\n## Deployment & Environment\n\n### Environment Variables\n```bash\n# Database\nDATABASE_URL=postgresql://...\n\n# Auth (Replit)\nREPLIT_DEPLOYMENT=production\nREPLIT_DOMAINS=app.replit.dev\n\n# Payments (Optional)\nSTRIPE_SECRET_KEY=sk_...\nVITE_STRIPE_PUBLIC_KEY=pk_...\nPAYPAL_CLIENT_ID=...\nPAYPAL_CLIENT_SECRET=...\n\n# Testing (Optional)\nTESTING_STRIPE_SECRET_KEY=sk_test_...\nTESTING_VITE_STRIPE_PUBLIC_KEY=pk_test_...\n```\n\n### Scripts\n```bash\nnpm run dev          # Dev mode (Express + Vite)\nnpm run build        # Build frontend\nnpm run db:push      # Push schema changes\nnpm run db:push --force  # Force push (data loss warning)\n```\n\n### Workflow\n- Nome: \"Start application\"\n- Comando: `npm run dev`\n- Bind: `0.0.0.0:5000`\n- Auto-restart su file changes\n\n---\n\n## Prossimi Sviluppi Suggeriti\n\n1. **End-Cycle Testing UI**\n   - Interfaccia per test 1RM a fine programma\n   - Confronto con assessment iniziale\n   - Trigger automatico per requiresEndCycleTest\n\n2. **Deload Week Implementation**\n   - Logica per settimane deload (volume -40-50%)\n   - UI per indicare settimana deload\n   - Tracking adherence deload\n\n3. **AI Form Corrections**\n   - Video upload per Premium/Elite\n   - Analisi forma con AI\n   - Feedback correttivo\n   - Rate limiting per tier\n\n4. **Notifiche Workout**\n   - Reminder programmati\n   - Push notifications\n   - Email summaries settimanali\n\n5. **Social Features**\n   - Condivisione record\n   - Leaderboard\n   - Coach access (Elite tier)\n\n---\n\n## File Struttura Progetto\n\n```\ntrainsmart/\n‚îú‚îÄ‚îÄ client/\n‚îÇ   ‚îú‚îÄ‚îÄ src/\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ScreeningFlow.tsx      # Onboarding multi-step\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AssessmentFlow.tsx     # 1RM testing\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WorkoutTracker.tsx     # Tracking allenamento\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Dashboard.tsx          # Overview programma\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AdaptLocationDialog.tsx # Adattamento workout\n‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/                    # shadcn components\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pages/\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Landing.tsx            # Homepage\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Pricing.tsx            # Prezzi e abbonamenti\n‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Onboarding.tsx         # Flusso onboarding\n‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...\n‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ lib/\n‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ queryClient.ts         # TanStack Query setup\n‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ App.tsx                    # Router principale\n‚îÇ   ‚îî‚îÄ‚îÄ index.html\n‚îú‚îÄ‚îÄ server/\n‚îÇ   ‚îú‚îÄ‚îÄ routes.ts                      # API endpoints\n‚îÇ   ‚îú‚îÄ‚îÄ programGenerator.ts            # Logica generazione programmi\n‚îÇ   ‚îú‚îÄ‚îÄ storage.ts                     # Interface database\n‚îÇ   ‚îú‚îÄ‚îÄ replitAuth.ts                  # Autenticazione setup\n‚îÇ   ‚îî‚îÄ‚îÄ index.ts                       # Express server\n‚îú‚îÄ‚îÄ shared/\n‚îÇ   ‚îú‚îÄ‚îÄ schema.ts                      # Drizzle schema completo\n‚îÇ   ‚îî‚îÄ‚îÄ pricingUtils.ts                # Logica prezzi\n‚îú‚îÄ‚îÄ package.json\n‚îú‚îÄ‚îÄ drizzle.config.ts\n‚îú‚îÄ‚îÄ vite.config.ts\n‚îî‚îÄ‚îÄ tsconfig.json\n```\n\n---\n\n## Note Tecniche Importanti\n\n### Database Migrations\n- **Mai modificare tipo ID columns** (serial ‚Üî varchar causa data loss)\n- Usare sempre `npm run db:push` per schema sync\n- Se warning data loss: `npm run db:push --force`\n\n### Zod Validation Critical\n- **Tutti i campi del form devono essere nello schema Zod**, altrimenti Zod li rimuove!\n- Esempio: pregnancy fields aggiunti a `screeningSchema` in routes.ts per evitare data loss\n\n### TanStack Query v5\n- Solo object form: `useQuery({ queryKey: [...] })`\n- Invalidate cache dopo mutations: `queryClient.invalidateQueries({ queryKey: [...] })`\n\n### ADAPTFLOW‚Ñ¢\n- Sempre verificare peso disponibile vs richiesto\n- Compensation types: tempo, pause, dropset, cluster\n- Fallback: gym ‚Üí home ‚Üí bodyweight\n\n### Safety First\n- Pregnancy: no supine da T2, load ridotti progressivamente\n- Disability: esercizi specifici per tipo\n- Pain areas: skip esercizi che coinvolgono area\n\n---\n\n## Crediti & Licenza\n\n**TrainSmart v2.0**\nSviluppato con React, Express, PostgreSQL, Drizzle ORM\nPowered by Replit\n\n---\n\n*Questo documento √® aggiornato a Ottobre 2025 e include tutte le feature implementate fino alla v2.0, inclusi sistema gravidanza, deload cycles, e end-cycle testing.*\n","size_bytes":19480},"IMPLEMENTATION_STATUS.md":{"content":"# TrainSmart - Implementation Status (Audit Reale Codice)\n\n**Ultimo aggiornamento**: 15 Ottobre 2025  \n**Filosofia**: Trasparenza totale su cosa funziona, cosa √® in test, cosa manca.\n\n---\n\n## ‚úÖ LIVE - Funzionante e Testato\n\n### Core Features\n- ‚úÖ **Screening Completo**: Goal, location, equipment, pain areas, bodyweight, availability\n- ‚úÖ **Quiz Tecnico Esercizi**: Determinazione livello (beginner/intermediate/advanced)\n- ‚úÖ **Programma Base**: Generazione schede personalizzate per goal standard (weight_loss, muscle_gain, strength, general, endurance)\n- ‚úÖ **1RM Calculation**: Formula Brzycki implementata e funzionante\n- ‚úÖ **Workout Tracking**: Registrazione set, reps, peso con pre-workout pain check\n- ‚úÖ **Body Part Targeting**: Isolamento muscoli specifici per toning/ipertrofia (upper_chest, arms, shoulders, back, legs, glutes, abs, calves)\n- ‚úÖ **Pain Area Management**: Filtro esercizi basato su zone doloranti (knee, shoulder, back, elbow, wrist, hip, ankle)\n- ‚úÖ **Exercise Substitution**: Sostituzione esercizi per location (gym/home) e equipment disponibile\n- ‚úÖ **Workout Adaptation**: Adattamento on-the-fly workout da gym a home (con/senza equipment)\n- ‚úÖ **Weekly Progress**: Tracking progressi settimanali con volume totale\n- ‚úÖ **Optional Steps UI**: Badge \"Opzionale\" per step skippabili nello screening (specific_goals, equipment, injuries)\n\n### Subscription System\n- ‚úÖ **3-Tier Pricing**: Base (‚Ç¨19.90), Premium (‚Ç¨29.90), Elite (‚Ç¨39.90)\n- ‚úÖ **Dynamic Price Escalation**: +‚Ç¨10 automatico dopo 6 mesi (con addMonths day-clamping corretto)\n- ‚úÖ **Subscription Tiers**: Schema database completo (subscriptionTier, subscriptionStartDate, subscriptionId)\n\n### Authentication\n- ‚úÖ **Replit Auth**: Google, GitHub, Email/Password login funzionante\n- ‚úÖ **Session Management**: PostgreSQL session store con express-session\n\n---\n\n## ‚ö†Ô∏è BETA - Implementato ma Richiede Testing Estensivo\n\n### Pregnancy Support (BETA)\n**Status**: Schema completo + safety rules implementate + legal disclaimers aggiunti, MA necessita validazione medica professionale\n\n**Cosa funziona**:\n- ‚úÖ Schema DB: pregnancyWeek, pregnancyTrimester, hasDoctorClearance, pregnancyComplications\n- ‚úÖ **Legal Disclaimers IMPLEMENTATI**: Alert rossi obbligatori con checkbox liability acceptance (hasReadPregnancyDisclaimer, hasDoctorClearance)\n- ‚úÖ **Validation Enforcement**: Submit bloccato se disclaimers non checked (verificato in isStepValid() riga 278)\n- ‚úÖ PREGNANCY_SAFE_EXERCISES_BY_TRIMESTER: Mapping esercizi per trimestre con load reduction\n- ‚úÖ Trimester-specific safety: NO supine post-1st trimester, loads 30-60% 1RM by trimester\n\n**Cosa manca**:\n- ‚ùå Validazione medica professionale (disclaimer legale presente ma non sostituisce consulenza)\n- ‚ùå Testing estensivo con utenti reali in gravidanza\n- ‚ùå Integrazione con professionisti sanitari\n\n### Disability Support (BETA)\n**Status**: Schema + disability types implementati + legal disclaimers aggiunti, MA necessita validazione fisioterapica\n\n**Cosa funziona**:\n- ‚úÖ Schema DB: disabilityType field\n- ‚úÖ **Legal Disclaimers IMPLEMENTATI**: Alert rossi obbligatori con checkbox acceptance (hasReadDisabilityDisclaimer)\n- ‚úÖ **Validation Enforcement**: Submit bloccato se disclaimer non checked (verificato in isStepValid() riga 276)\n- ‚úÖ Disability Types: Paraplegic, hemiplegic, amputation, cerebral_palsy, muscular_dystrophy, spinal_injury\n- ‚úÖ Basic Exercise Adaptations: Filtro esercizi per tipo disabilit√†\n\n**Cosa manca**:\n- ‚ùå Validazione fisioterapica professionale (disclaimer presente ma non sostituisce team medico)\n- ‚ùå DISABILITY_SAFE_EXERCISES mapping completo (solo basic filtering implementato)\n- ‚ùå Testing con utenti con disabilit√† motorie\n\n### Deload Cycles (SCHEMA ONLY)\n**Status**: Flags database settati MA nessuna generazione effettiva settimane ridotte\n\n**Cosa funziona**:\n- ‚úÖ Schema DB: includesDeload, deloadFrequency, totalWeeks flags\n- ‚úÖ Logic: intermediate/advanced programs flagged con deload ogni 4 settimane\n- ‚úÖ UI Display: Descrizione programma mostra \"(con deload ogni 4 settimane)\"\n\n**Cosa NON funziona**:\n- ‚ùå **CRITICAL**: Nessun codice che genera workout con volume/intensity ridotti nelle settimane deload\n- ‚ùå Nessun `isDeloadWeek` o `deloadWeek` check nel programGenerator\n- ‚ùå User riceve stesse settimane per tutto il ciclo (nessuna riduzione effettiva)\n\n**Action Required**: Implementare logica riduzione 40-50% volume nelle settimane 4, 8, 12\n\n---\n\n## ‚ùå NON IMPLEMENTATO - Solo Schema o Mancante\n\n### Payments (BROKEN)\n**Status**: Schema presente MA endpoint mismatch blocca tutto\n\n**Problema**:\n- ‚ùå Frontend chiama: `/api/payment/stripe/checkout`, `/api/payment/paypal/create`\n- ‚ùå Backend implementa: `/api/payment/create`, `/api/payment/:id/confirm`\n- ‚ùå Route mismatch = pagamenti NON funzionano\n- ‚úÖ Schema DB: payments table con provider, amount, status esiste\n\n**Action Required**: \n1. Implementare endpoint Stripe/PayPal corretti con API keys\n2. O aggiornare frontend per usare endpoint esistenti (payment generic)\n\n### AI Form Corrections (PLANNED)\n**Status**: Funzione canUseAiCorrection() esiste MA nessuna AI integrata\n\n**Cosa esiste**:\n- ‚úÖ `canUseAiCorrection()` in pricingUtils.ts (Premium 1/week, Elite unlimited)\n- ‚úÖ Schema DB: aiCorrectionsUsed, lastAiCorrectionDate\n- ‚ùå Nessun endpoint `/api/ai/form-correction`\n- ‚ùå Nessuna integrazione OpenAI/video analysis\n- ‚ùå UI non espone la feature (corretto - non funziona)\n\n**Roadmap**: Q2 2026 (richiede video upload, AI model integration, feedback system)\n\n### End-Cycle Testing (FLAG ONLY)\n**Status**: Flag requiresEndCycleTest settato MA nessun test generato\n\n**Cosa esiste**:\n- ‚úÖ requiresEndCycleTest flag per strength/muscle_gain/performance goals\n- ‚ùå Nessun workout di test 1RM generato al termine ciclo\n- ‚ùå Nessuna UI per condurre test finale\n\n**Action Required**: Generare workout test 1RM alla fine del ciclo con retest formula\n\n### Features Mai Implementate\n- ‚ùå **Video Library**: Nessun tutorial video (solo nomi esercizi)\n- ‚ùå **Community Hub**: Nessuna feature social/competizioni\n- ‚ùå **Advanced Analytics**: Solo basic progress tracking (no predictive insights)\n- ‚ùå **Sport-Specific Training**: Schema sport/role esiste ma nessuna logica training specifica\n- ‚ùå **Endurance Integration**: Menzionato in docs ma nessun workout endurance generato\n\n---\n\n## üîç ADAPTFLOW Status\n\n**Status attuale**: Exercise substitution funzionante, \"2.0\" branding rimosso da roadmap\n\n**Cosa funziona**:\n- ‚úÖ exerciseDatabase.ts: Database esercizi con variants (gym/homeWithEquipment/homeBodyweight)\n- ‚úÖ exerciseSubstitutions.ts: Mapping sostituzioni esercizi\n- ‚úÖ Location adaptation: Regenera esercizi per gym/home switch\n- ‚úÖ Equipment fallback: Suggerisce compensazioni se peso insufficiente\n\n**\"2.0\" Branding**:\n- ‚ö†Ô∏è File commentati con \"ADAPTFLOW 2.0\" ma nessuna v1.0 documentata\n- ‚ö†Ô∏è Nessun changelog 1.0 ‚Üí 2.0 nel codice\n- ‚ö†Ô∏è Marketing claim non supportato da versioning reale\n\n**Recommendation**: Chiamarlo \"ADAPTFLOW\" o \"Exercise Adaptation System\" senza versioning\n\n---\n\n## üö® Critical Issues da Risolvere\n\n### P0 - Blockers\n1. **Payment Broken**: Mismatch endpoint frontend/backend impedisce acquisto subscription\n2. **Deload Non Generato**: Users promessi deload ma ricevono sempre stesso volume\n\n### P1 - High Priority\n3. **End-Cycle Testing Missing**: Flag set ma nessun test 1RM generato\n4. **ADAPTFLOW 2.0 Branding**: Claim non supportato, rimuovere versioning falso\n\n### P2 - Medium Priority\n5. **Sport-Specific Logic**: Schema presente ma nessun training specifico per sport/role\n6. **AI Corrections Stub**: canUseAiCorrection() esiste ma √® dead code (OK se in roadmap)\n\n---\n\n## ‚úÖ Legal Disclaimers - VERIFIED IMPLEMENTATION\n\n### Pregnancy Validation ‚úÖ\n```typescript\n// ScreeningFlow.tsx riga 278\ncase \"pregnancy_info\":\n  return data.hasReadPregnancyDisclaimer && data.hasDoctorClearance && data.pregnancyWeek >= 1 && data.pregnancyWeek <= 40;\n```\n**VERIFIED**: \n- ‚úÖ `hasReadPregnancyDisclaimer` richiesto in validation\n- ‚úÖ `hasDoctorClearance` richiesto\n- ‚úÖ Submit bloccato se checkbox non checked\n- ‚úÖ Alert rosso con warning medical clearance requirement\n- ‚úÖ Liability acceptance checkbox obbligatorio\n\n### Disability Validation ‚úÖ\n```typescript\n// ScreeningFlow.tsx riga 276\ncase \"disability_type\":\n  return data.disabilityType !== \"\" && data.hasReadDisabilityDisclaimer;\n```\n**VERIFIED**: \n- ‚úÖ `hasReadDisabilityDisclaimer` richiesto in validation\n- ‚úÖ Submit bloccato se checkbox non checked\n- ‚úÖ Alert rosso con warning medical consultation requirement\n- ‚úÖ Liability acceptance checkbox obbligatorio\n\n**Compliance Status**: ‚úÖ Legal disclaimers fully implemented and enforced\n\n---\n\n## üìä Summary Stats\n\n- **Features Live**: 11/25 (44%)\n- **Features Beta**: 3/25 (12%) - Pregnancy, Disability, (Deload schema only)\n- **Features Broken**: 1/25 (4%) - Payments\n- **Features Planned**: 10/25 (40%)\n\n**Overall Readiness**: ~44% production-ready, 12% needs testing, 44% not implemented\n\n---\n\n## üó∫Ô∏è Honest Roadmap Status\n\n### ‚úÖ Live Now\n- Screening + Quiz completo\n- Program generation (base goals)\n- Workout tracking + progress\n- Body part targeting\n- Exercise adaptation (ADAPTFLOW)\n- Legal disclaimers pregnancy/disability\n\n### ‚ö†Ô∏è Beta (Needs Testing)\n- Pregnancy programs (safety rules + disclaimers OK, needs medical validation)\n- Disability programs (basic adaptations + disclaimers OK, needs physio validation)\n\n### ‚ùå Coming Q2 2026\n- AI form corrections (video analysis + OpenAI integration)\n- Deload week generation (schema exists, logic missing)\n- End-cycle testing (flag exists, UI missing)\n- Video library\n- Community features\n- Advanced analytics\n- Stripe/PayPal payments (fix endpoint mismatch first)\n\n**Transparency Note**: Features marcate \"Beta\" non dovrebbero essere promesse come \"Live\" in marketing. Deload dovrebbe essere \"Coming Soon\" non \"Beta\" perch√© non genera effettivamente settimane ridotte.\n","size_bytes":10041},"client/src/components/Roadmap.tsx":{"content":"import { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Check, Construction, Rocket } from \"lucide-react\";\n\ninterface RoadmapItem {\n  title: string;\n  description: string;\n  status: 'live' | 'beta' | 'coming';\n}\n\nconst roadmapItems: RoadmapItem[] = [\n  // LIVE FEATURES\n  {\n    title: \"Screening Avanzato\",\n    description: \"Valutazione completa con quiz tecnico esercizi\",\n    status: \"live\"\n  },\n  {\n    title: \"Programmi Personalizzati\",\n    description: \"Piani allenamento basati su 1RM e progressione scientifica\",\n    status: \"live\"\n  },\n  {\n    title: \"ADAPTFLOW‚Ñ¢\",\n    description: \"Adattamento automatico esercizi per location e attrezzatura\",\n    status: \"live\"\n  },\n  {\n    title: \"Tracking Completo\",\n    description: \"Registrazione workout con gestione zone doloranti\",\n    status: \"live\"\n  },\n  {\n    title: \"Body Part Targeting\",\n    description: \"Isolamento muscoli specifici per toning/ipertrofia\",\n    status: \"live\"\n  },\n  \n  // BETA FEATURES\n  {\n    title: \"Supporto Gravidanza\",\n    description: \"Programmi trimestre-specifici con safety rules (richiede validazione medica)\",\n    status: \"beta\"\n  },\n  {\n    title: \"Supporto Disabilit√†\",\n    description: \"Adattamenti esercizi per condizioni motorie (richiede validazione fisioterapica)\",\n    status: \"beta\"\n  },\n  \n  // COMING SOON\n  {\n    title: \"Deload Cycles\",\n    description: \"Settimane scarico automatico con riduzione volume/intensit√†\",\n    status: \"coming\"\n  },\n  {\n    title: \"End-Cycle Testing\",\n    description: \"Retest 1RM al termine ciclo con auto-recalibrazione\",\n    status: \"coming\"\n  },\n  {\n    title: \"AI Form Corrections\",\n    description: \"Analisi video tecnica esercizi con feedback AI\",\n    status: \"coming\"\n  },\n  {\n    title: \"Stripe/PayPal Payments\",\n    description: \"Sistema pagamento completo per subscription\",\n    status: \"coming\"\n  },\n  {\n    title: \"Video Library\",\n    description: \"Tutorial video per ogni esercizio\",\n    status: \"coming\"\n  },\n  {\n    title: \"Community Hub\",\n    description: \"Condivisione progressi e competizioni amichevoli\",\n    status: \"coming\"\n  },\n  {\n    title: \"Advanced Analytics\",\n    description: \"Dashboard analytics con insights predittivi\",\n    status: \"coming\"\n  },\n];\n\nconst statusConfig = {\n  live: {\n    label: \"Live\",\n    icon: Check,\n    color: \"bg-emerald-600\",\n    textColor: \"text-emerald-600\"\n  },\n  beta: {\n    label: \"Beta\",\n    icon: Construction,\n    color: \"bg-amber-600\",\n    textColor: \"text-amber-600\"\n  },\n  coming: {\n    label: \"In Arrivo\",\n    icon: Rocket,\n    color: \"bg-blue-600\",\n    textColor: \"text-blue-600\"\n  }\n};\n\nexport default function Roadmap() {\n  const liveItems = roadmapItems.filter(item => item.status === 'live');\n  const betaItems = roadmapItems.filter(item => item.status === 'beta');\n  const comingItems = roadmapItems.filter(item => item.status === 'coming');\n\n  return (\n    <div className=\"py-24 bg-background\">\n      <div className=\"max-w-7xl mx-auto px-4\">\n        <div className=\"text-center mb-16\">\n          <h2 className=\"font-display text-4xl md:text-5xl mb-4 text-foreground\">\n            Roadmap <span className=\"text-primary\">TrainSmart</span>\n          </h2>\n          <p className=\"text-lg text-muted-foreground\">\n            Trasparenza totale su cosa √® live, in test e in arrivo\n          </p>\n        </div>\n\n        <div className=\"grid md:grid-cols-3 gap-8\">\n          {/* LIVE */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-3 mb-6\">\n              <div className=\"w-10 h-10 rounded-lg bg-emerald-600/20 flex items-center justify-center\">\n                <Check className=\"w-5 h-5 text-emerald-600\" />\n              </div>\n              <div>\n                <h3 className=\"font-bold text-xl\">Live</h3>\n                <p className=\"text-sm text-muted-foreground\">Disponibile ora</p>\n              </div>\n            </div>\n            {liveItems.map((item, idx) => (\n              <Card key={idx} className=\"border-emerald-600/30\" data-testid={`card-roadmap-live-${idx}`}>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-base flex items-start gap-2 justify-between\">\n                    <span>{item.title}</span>\n                    <Badge className=\"bg-emerald-600 text-xs shrink-0\">Live</Badge>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <CardDescription className=\"text-sm\">{item.description}</CardDescription>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          {/* BETA */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-3 mb-6\">\n              <div className=\"w-10 h-10 rounded-lg bg-amber-600/20 flex items-center justify-center\">\n                <Construction className=\"w-5 h-5 text-amber-600\" />\n              </div>\n              <div>\n                <h3 className=\"font-bold text-xl\">Beta</h3>\n                <p className=\"text-sm text-muted-foreground\">In fase test</p>\n              </div>\n            </div>\n            {betaItems.map((item, idx) => (\n              <Card key={idx} className=\"border-amber-600/30\" data-testid={`card-roadmap-beta-${idx}`}>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-base flex items-start gap-2 justify-between\">\n                    <span>{item.title}</span>\n                    <Badge className=\"bg-amber-600 text-xs shrink-0\">Beta</Badge>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <CardDescription className=\"text-sm\">{item.description}</CardDescription>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n\n          {/* COMING SOON */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-3 mb-6\">\n              <div className=\"w-10 h-10 rounded-lg bg-blue-600/20 flex items-center justify-center\">\n                <Rocket className=\"w-5 h-5 text-blue-600\" />\n              </div>\n              <div>\n                <h3 className=\"font-bold text-xl\">In Arrivo</h3>\n                <p className=\"text-sm text-muted-foreground\">Prossimamente</p>\n              </div>\n            </div>\n            {comingItems.map((item, idx) => (\n              <Card key={idx} className=\"border-blue-600/30\" data-testid={`card-roadmap-coming-${idx}`}>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"text-base flex items-start gap-2 justify-between\">\n                    <span>{item.title}</span>\n                    <Badge className=\"bg-blue-600 text-xs shrink-0\">Q2 2026</Badge>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <CardDescription className=\"text-sm\">{item.description}</CardDescription>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n\n        <div className=\"mt-12 text-center\">\n          <p className=\"text-sm text-muted-foreground\">\n            üí° La roadmap viene aggiornata mensilmente in base al feedback della community\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":7320}},"version":2}